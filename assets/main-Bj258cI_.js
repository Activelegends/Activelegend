var za=Object.defineProperty;var qa=(r,e,t)=>e in r?za(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var st=(r,e,t)=>qa(r,typeof e!="symbol"?e+"":e,t);import{j as i,q as ze,a as Va,A as tr,m as z,u as Ha,b as Wa,c as Ga}from"./ui-BQjX9tA5.js";import{b as Ka,g as Ja,c as ss,a as b,R as K,L as ge,u as Ya,d as Nt,f as $i,B as Xa,h as Qa,i as Me}from"./vendor-dzqBxhp5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();var Pr={},Sn;function Za(){if(Sn)return Pr;Sn=1;var r=Ka();return Pr.createRoot=r.createRoot,Pr.hydrateRoot=r.hydrateRoot,Pr}var eo=Za();const to="modulepreload",ro=function(r){return"/"+r},Nn={},Sr=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){let o=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=o(t.map(d=>{if(d=ro(d),d in Nn)return;Nn[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":to,u||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((m,x)=>{f.addEventListener("load",m),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},so=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Sr(async()=>{const{default:s}=await Promise.resolve().then(()=>rr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class nn extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class no extends nn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class io extends nn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ao extends nn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Us;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Us||(Us={}));var oo=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class lo{constructor(e,{headers:t={},customFetch:s,region:n=Us.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=so(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return oo(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:o}=t;let l={},{region:c}=t;c||(c=this.region),c&&c!=="any"&&(l["x-region"]=c);let d;o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const u=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:d}).catch(x=>{throw new no(x)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new io(u);if(!u.ok)throw new ao(u);let f=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),m;return f==="application/json"?m=yield u.json():f==="application/octet-stream"?m=yield u.blob():f==="text/event-stream"?m=u:f==="multipart/form-data"?m=yield u.formData():m=yield u.text(),{data:m,error:null}}catch(n){return{data:null,error:n}}})}}var we={},Mt={},$t={},Ft={},Ut={},Bt={},co=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},er=co();const uo=er.fetch,Fi=er.fetch.bind(er),Ui=er.Headers,ho=er.Request,fo=er.Response,rr=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ui,Request:ho,Response:fo,default:Fi,fetch:uo},Symbol.toStringTag,{value:"Module"})),mo=Ja(rr);var Dr={},Tn;function Bi(){if(Tn)return Dr;Tn=1,Object.defineProperty(Dr,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Dr.default=r,Dr}var Cn;function zi(){if(Cn)return Bt;Cn=1;var r=Bt&&Bt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Bt,"__esModule",{value:!0});const e=r(mo),t=r(Bi());class s{constructor(a){this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=a.headers,this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=a.shouldThrowOnError,this.signal=a.signal,this.isMaybeSingle=a.isMaybeSingle,a.fetch?this.fetch=a.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,o){return this.headers=Object.assign({},this.headers),this.headers[a]=o,this}then(a,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const l=this.fetch;let c=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var u,h,f;let m=null,x=null,y=null,_=d.status,F=d.statusText;if(d.ok){if(this.method!=="HEAD"){const I=await d.text();I===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?x=I:x=JSON.parse(I))}const j=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),R=(h=d.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");j&&R&&R.length>1&&(y=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(m={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,y=null,_=406,F="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const j=await d.text();try{m=JSON.parse(j),Array.isArray(m)&&d.status===404&&(x=[],m=null,_=200,F="OK")}catch{d.status===404&&j===""?(_=204,F="No Content"):m={message:j}}if(m&&this.isMaybeSingle&&(!((f=m==null?void 0:m.details)===null||f===void 0)&&f.includes("0 rows"))&&(m=null,_=200,F="OK"),m&&this.shouldThrowOnError)throw new t.default(m)}return{error:m,data:x,count:y,status:_,statusText:F}});return this.shouldThrowOnError||(c=c.catch(d=>{var u,h,f;return{error:{message:`${(u=d==null?void 0:d.name)!==null&&u!==void 0?u:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(h=d==null?void 0:d.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=d==null?void 0:d.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),c.then(a,o)}returns(){return this}overrideTypes(){return this}}return Bt.default=s,Bt}var On;function qi(){if(On)return Ut;On=1;var r=Ut&&Ut.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ut,"__esModule",{value:!0});const e=r(zi());class t extends e.default{select(n){let a=!1;const o=(n??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${n}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(d,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const h=[n?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${f}"; options=${h};`,d==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ut.default=t,Ut}var In;function an(){if(In)return Ft;In=1;var r=Ft&&Ft.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ft,"__esModule",{value:!0});const e=r(qi());class t extends e.default{eq(n,a){return this.url.searchParams.append(n,`eq.${a}`),this}neq(n,a){return this.url.searchParams.append(n,`neq.${a}`),this}gt(n,a){return this.url.searchParams.append(n,`gt.${a}`),this}gte(n,a){return this.url.searchParams.append(n,`gte.${a}`),this}lt(n,a){return this.url.searchParams.append(n,`lt.${a}`),this}lte(n,a){return this.url.searchParams.append(n,`lte.${a}`),this}like(n,a){return this.url.searchParams.append(n,`like.${a}`),this}likeAllOf(n,a){return this.url.searchParams.append(n,`like(all).{${a.join(",")}}`),this}likeAnyOf(n,a){return this.url.searchParams.append(n,`like(any).{${a.join(",")}}`),this}ilike(n,a){return this.url.searchParams.append(n,`ilike.${a}`),this}ilikeAllOf(n,a){return this.url.searchParams.append(n,`ilike(all).{${a.join(",")}}`),this}ilikeAnyOf(n,a){return this.url.searchParams.append(n,`ilike(any).{${a.join(",")}}`),this}is(n,a){return this.url.searchParams.append(n,`is.${a}`),this}in(n,a){const o=Array.from(new Set(a)).map(l=>typeof l=="string"&&new RegExp("[,()]").test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(n,`in.(${o})`),this}contains(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cs.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cs.{${a.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(a)}`),this}containedBy(n,a){return typeof a=="string"?this.url.searchParams.append(n,`cd.${a}`):Array.isArray(a)?this.url.searchParams.append(n,`cd.{${a.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(a)}`),this}rangeGt(n,a){return this.url.searchParams.append(n,`sr.${a}`),this}rangeGte(n,a){return this.url.searchParams.append(n,`nxl.${a}`),this}rangeLt(n,a){return this.url.searchParams.append(n,`sl.${a}`),this}rangeLte(n,a){return this.url.searchParams.append(n,`nxr.${a}`),this}rangeAdjacent(n,a){return this.url.searchParams.append(n,`adj.${a}`),this}overlaps(n,a){return typeof a=="string"?this.url.searchParams.append(n,`ov.${a}`):this.url.searchParams.append(n,`ov.{${a.join(",")}}`),this}textSearch(n,a,{config:o,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const d=o===void 0?"":`(${o})`;return this.url.searchParams.append(n,`${c}fts${d}.${a}`),this}match(n){return Object.entries(n).forEach(([a,o])=>{this.url.searchParams.append(a,`eq.${o}`)}),this}not(n,a,o){return this.url.searchParams.append(n,`not.${a}.${o}`),this}or(n,{foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.or`:"or";return this.url.searchParams.append(l,`(${n})`),this}filter(n,a,o){return this.url.searchParams.append(n,`${a}.${o}`),this}}return Ft.default=t,Ft}var Rn;function Vi(){if(Rn)return $t;Rn=1;var r=$t&&$t.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty($t,"__esModule",{value:!0});const e=r(an());class t{constructor(n,{headers:a={},schema:o,fetch:l}){this.url=n,this.headers=a,this.schema=o,this.fetch=l}select(n,{head:a=!1,count:o}={}){const l=a?"HEAD":"GET";let c=!1;const d=(n??"*").split("").map(u=>/\s/.test(u)&&!c?"":(u==='"'&&(c=!c),u)).join("");return this.url.searchParams.set("select",d),o&&(this.headers.Prefer=`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:a,defaultToNull:o=!0}={}){const l="POST",c=[];if(this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),o||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(n)){const d=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(d.length>0){const u=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){const d="POST",u=[`resolution=${o?"ignore":"merge"}-duplicates`];if(a!==void 0&&this.url.searchParams.set("on_conflict",a),this.headers.Prefer&&u.push(this.headers.Prefer),l&&u.push(`count=${l}`),c||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(h.length>0){const f=[...new Set(h)].map(m=>`"${m}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:a}={}){const o="PATCH",l=[];return this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),this.headers.Prefer=l.join(","),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const a="DELETE",o=[];return n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return $t.default=t,$t}var cr={},dr={},Ln;function go(){return Ln||(Ln=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.version=void 0,dr.version="0.0.0-automated"),dr}var Pn;function po(){if(Pn)return cr;Pn=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.DEFAULT_HEADERS=void 0;const r=go();return cr.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},cr}var Dn;function yo(){if(Dn)return Mt;Dn=1;var r=Mt&&Mt.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Mt,"__esModule",{value:!0});const e=r(Vi()),t=r(an()),s=po();class n{constructor(o,{headers:l={},schema:c,fetch:d}={}){this.url=o,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),l),this.schemaName=c,this.fetch=d}from(o){const l=new URL(`${this.url}/${o}`);return new e.default(l,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,l={},{head:c=!1,get:d=!1,count:u}={}){let h;const f=new URL(`${this.url}/rpc/${o}`);let m;c||d?(h=c?"HEAD":"GET",Object.entries(l).filter(([y,_])=>_!==void 0).map(([y,_])=>[y,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([y,_])=>{f.searchParams.append(y,_)})):(h="POST",m=l);const x=Object.assign({},this.headers);return u&&(x.Prefer=`count=${u}`),new t.default({method:h,url:f,headers:x,schema:this.schemaName,body:m,fetch:this.fetch,allowEmpty:!1})}}return Mt.default=n,Mt}var Mn;function xo(){if(Mn)return we;Mn=1;var r=we&&we.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(we,"__esModule",{value:!0}),we.PostgrestError=we.PostgrestBuilder=we.PostgrestTransformBuilder=we.PostgrestFilterBuilder=we.PostgrestQueryBuilder=we.PostgrestClient=void 0;const e=r(yo());we.PostgrestClient=e.default;const t=r(Vi());we.PostgrestQueryBuilder=t.default;const s=r(an());we.PostgrestFilterBuilder=s.default;const n=r(qi());we.PostgrestTransformBuilder=n.default;const a=r(zi());we.PostgrestBuilder=a.default;const o=r(Bi());return we.PostgrestError=o.default,we.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:a.default,PostgrestError:o.default},we}var vo=xo();const bo=ss(vo),{PostgrestClient:wo,PostgrestQueryBuilder:dh,PostgrestFilterBuilder:uh,PostgrestTransformBuilder:hh,PostgrestBuilder:fh,PostgrestError:mh}=bo;let Bs;typeof window>"u"?Bs=require("ws"):Bs=window.WebSocket;const _o="2.11.10",jo={"X-Client-Info":`realtime-js/${_o}`},ko="1.0.0",Hi=1e4,Ao=1e3;var Yt;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Yt||(Yt={}));var Ne;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Ne||(Ne={}));var He;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(He||(He={}));var zs;(function(r){r.websocket="websocket"})(zs||(zs={}));var At;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(At||(At={}));class Eo{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+n));o=o+n;const c=s.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Wi{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var le;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(le||(le={}));const $n=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((a,o)=>(a[o]=So(o,r,e,n),a),{})},So=(r,e,t,s)=>{const n=e.find(l=>l.name===r),a=n==null?void 0:n.type,o=t[r];return a&&!s.includes(a)?Gi(a,o):qs(o)},Gi=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Oo(e,t)}switch(r){case le.bool:return No(e);case le.float4:case le.float8:case le.int2:case le.int4:case le.int8:case le.numeric:case le.oid:return To(e);case le.json:case le.jsonb:return Co(e);case le.timestamp:return Io(e);case le.abstime:case le.date:case le.daterange:case le.int4range:case le.int8range:case le.money:case le.reltime:case le.text:case le.time:case le.timestamptz:case le.timetz:case le.tsrange:case le.tstzrange:return qs(e);default:return qs(e)}},qs=r=>r,No=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},To=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Co=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Oo=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let a;const o=r.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Gi(e,l))}return r},Io=r=>typeof r=="string"?r.replace(" ","T"):r,Ki=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ls{constructor(e,t,s={},n=Hi){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Fn;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Fn||(Fn={}));class jr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jr.syncState(this.state,n,a,o),this.pendingDiffs.forEach(c=>{this.state=jr.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=jr.syncDiff(this.state,n,a,o),l())}),this.onJoin((n,a,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:o})}),this.onLeave((n,a,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=a[d];if(h){const f=u.map(_=>_.presence_ref),m=h.map(_=>_.presence_ref),x=u.filter(_=>m.indexOf(_.presence_ref)<0),y=h.filter(_=>f.indexOf(_.presence_ref)<0);x.length>0&&(l[d]=x),y.length>0&&(c[d]=y)}else l[d]=u}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(e,t,s,n){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(m=>m.presence_ref),f=u.filter(m=>h.indexOf(m.presence_ref)<0);e[l].unshift(...f)}s(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Un;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(Un||(Un={}));var Bn;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(Bn||(Bn={}));var ot;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(ot||(ot={}));class on{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Ne.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new ls(this,He.join,this.params,this.timeout),this.rejoinTimer=new Wi(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ne.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ne.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Ne.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ne.errored,this.rejoinTimer.scheduleTimeout())}),this._on(He.reply,{},(n,a)=>{this._trigger(this._replyEventName(a),n)}),this.presence=new jr(this),this.broadcastEndpointURL=Ki(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:o,private:l}}=this.params;this._onError(u=>e==null?void 0:e(ot.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(ot.CLOSED));const c={},d={broadcast:a,presence:o,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(ot.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,m=(h=f==null?void 0:f.length)!==null&&h!==void 0?h:0,x=[];for(let y=0;y<m;y++){const _=f[y],{filter:{event:F,schema:T,table:j,filter:R}}=_,I=u&&u[y];if(I&&I.event===F&&I.schema===T&&I.table===j&&I.filter===R)x.push(Object.assign(Object.assign({},_),{id:I.id}));else{this.unsubscribe(),this.state=Ne.errored,e==null||e(ot.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(ot.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ne.errored,e==null||e(ot.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ot.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ne.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(He.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(s=>{const n=new ls(this,He.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new ls(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=He;if(s&&[l,c,d,u].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,t,s);if(t&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(m=>{var x,y,_;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((_=(y=m.filter)===null||y===void 0?void 0:y.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(m=>m.callback(f,s)):(a=this.bindings[o])===null||a===void 0||a.filter(m=>{var x,y,_,F,T,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const R=m.id,I=(x=m.filter)===null||x===void 0?void 0:x.event;return R&&((y=t.ids)===null||y===void 0?void 0:y.includes(R))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const R=(T=(F=m==null?void 0:m.filter)===null||F===void 0?void 0:F.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return R==="*"||R===((j=t==null?void 0:t.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof f=="object"&&"ids"in f){const x=f.data,{schema:y,table:_,commit_timestamp:F,type:T,errors:j}=x;f=Object.assign(Object.assign({},{schema:y,table:_,commit_timestamp:F,eventType:T,new:{},old:{},errors:j}),this._getPayloadRecords(x))}m.callback(f,s)})}_isClosed(){return this.state===Ne.closed}_isJoined(){return this.state===Ne.joined}_isJoining(){return this.state===Ne.joining}_isLeaving(){return this.state===Ne.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&on.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(He.close,{},e)}_onError(e){this._on(He.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ne.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=$n(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=$n(e.columns,e.old_record)),t}}const zn=()=>{},Ro=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Lo{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=jo,this.params={},this.timeout=Hi,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=zn,this.ref=0,this.logger=zn,this.conn=null,this.sendBuffer=[],this.serializer=new Eo,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=a=>{let o;return a?o=a:typeof fetch>"u"?o=(...l)=>Sr(async()=>{const{default:c}=await Promise.resolve().then(()=>rr);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${zs.websocket}`,this.httpEndpoint=Ki(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:a=>[1e3,2e3,5e3,1e4][a-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(a,o)=>o(JSON.stringify(a)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Wi(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Bs),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new Po(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ko}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter(s=>s._joinRef!==e._joinRef),this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Yt.connecting:return At.Connecting;case Yt.open:return At.Open;case Yt.closing:return At.Closing;default:return At.Closed}}isConnected(){return this.connectionState()===At.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new on(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:s,payload:n,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${a})`,n),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{t&&s.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),s.joinedOnce&&s._isJoined()&&s._push(He.access_token,{access_token:t})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(Ao,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:a,ref:o}=t;s==="phoenix"&&n==="phx_reply"&&this.heartbeatCallback(t.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${a.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,a),Array.from(this.channels).filter(l=>l._isMember(s)).forEach(l=>l._trigger(n,a,o)),this.stateChangeCallbacks.message.forEach(l=>l(t))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(He.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Ro],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Po{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Yt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class ln extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function _e(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Do extends ln{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Vs extends ln{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Mo=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const Ji=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Sr(async()=>{const{default:s}=await Promise.resolve().then(()=>rr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},$o=()=>Mo(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Sr(()=>Promise.resolve().then(()=>rr),void 0)).Response:Response}),Hs=r=>{if(Array.isArray(r))return r.map(t=>Hs(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=Hs(s)}),e};var Tt=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const cs=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Fo=(r,e,t)=>Tt(void 0,void 0,void 0,function*(){const s=yield $o();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{e(new Do(cs(n),r.status||500))}).catch(n=>{e(new Vs(cs(n),n))}):e(new Vs(cs(r),r))}),Uo=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function Nr(r,e,t,s,n,a){return Tt(this,void 0,void 0,function*(){return new Promise((o,l)=>{r(t,Uo(e,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Fo(c,l,s))})})}function Jr(r,e,t,s){return Tt(this,void 0,void 0,function*(){return Nr(r,"GET",e,t,s)})}function mt(r,e,t,s,n){return Tt(this,void 0,void 0,function*(){return Nr(r,"POST",e,s,n,t)})}function Bo(r,e,t,s,n){return Tt(this,void 0,void 0,function*(){return Nr(r,"PUT",e,s,n,t)})}function zo(r,e,t,s){return Tt(this,void 0,void 0,function*(){return Nr(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Yi(r,e,t,s,n){return Tt(this,void 0,void 0,function*(){return Nr(r,"DELETE",e,s,n,t)})}var Le=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const qo={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Vo{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Ji(n)}uploadOrUpdate(e,t,s,n){return Le(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},qn),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:a,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),f=yield h.json();return h.ok?{data:{path:d,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(a){if(_e(a))return{data:null,error:a};throw a}})}upload(e,t,s){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return Le(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:qn.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:u}),f=yield h.json();return h.ok?{data:{path:a,fullPath:f.Key},error:null}:{data:null,error:f}}catch(c){if(_e(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return Le(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const a=yield mt(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new ln("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(_e(s))return{data:null,error:s};throw s}})}update(e,t,s){return Le(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Le(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}})}copy(e,t,s){return Le(this,void 0,void 0,function*(){try{return{data:{path:(yield mt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return Le(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield mt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return Le(this,void 0,void 0,function*(){try{const n=yield mt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}})}download(e,t){return Le(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Jr(this.fetch,`${this.url}/${n}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(_e(l))return{data:null,error:l};throw l}})}info(e){return Le(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield Jr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Hs(s),error:null}}catch(s){if(_e(s))return{data:null,error:s};throw s}})}exists(e){return Le(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zo(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(_e(s)&&s instanceof Vs){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return Le(this,void 0,void 0,function*(){try{return{data:yield Yi(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}})}list(e,t,s){return Le(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},qo),t),{prefix:e||""});return{data:yield mt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(_e(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Ho="2.7.1",Wo={"X-Client-Info":`storage-js/${Ho}`};var zt=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class Go{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Wo),t),this.fetch=Ji(s)}listBuckets(){return zt(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(_e(e))return{data:null,error:e};throw e}})}getBucket(e){return zt(this,void 0,void 0,function*(){try{return{data:yield Jr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return zt(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(_e(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return zt(this,void 0,void 0,function*(){try{return{data:yield Bo(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(_e(s))return{data:null,error:s};throw s}})}emptyBucket(e){return zt(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}})}deleteBucket(e){return zt(this,void 0,void 0,function*(){try{return{data:yield Yi(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(_e(t))return{data:null,error:t};throw t}})}}class Ko extends Go{constructor(e,t={},s){super(e,t,s)}from(e){return new Vo(this.url,this.headers,e,this.fetch)}}const Jo="2.50.0";let wr="";typeof Deno<"u"?wr="deno":typeof document<"u"?wr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?wr="react-native":wr="node";const Yo={"X-Client-Info":`supabase-js-${wr}/${Jo}`},Xo={headers:Yo},Qo={schema:"public"},Zo={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},el={};var tl=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};const rl=r=>{let e;return r?e=r:typeof fetch>"u"?e=Fi:e=fetch,(...t)=>e(...t)},sl=()=>typeof Headers>"u"?Ui:Headers,nl=(r,e,t)=>{const s=rl(t),n=sl();return(a,o)=>tl(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:r;let d=new n(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",r),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},o),{headers:d}))})};var il=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};function al(r){return r.endsWith("/")?r:r+"/"}function ol(r,e){var t,s;const{db:n,auth:a,realtime:o,global:l}=r,{db:c,auth:d,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(t=h==null?void 0:h.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>il(this,void 0,void 0,function*(){return""})};return r.accessToken?f.accessToken=r.accessToken:delete f.accessToken,f}const Xi="2.70.0",Kt=30*1e3,Ws=3,ds=Ws*Kt,ll="http://localhost:9999",cl="supabase.auth.token",dl={"X-Client-Info":`gotrue-js/${Xi}`},Gs="X-Supabase-Api-Version",Qi={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ul=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,hl=6e5;class cn extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Z(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class fl extends cn{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function ml(r){return Z(r)&&r.name==="AuthApiError"}class Zi extends cn{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class yt extends cn{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class ft extends yt{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function gl(r){return Z(r)&&r.name==="AuthSessionMissingError"}class Mr extends yt{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class $r extends yt{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Fr extends yt{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function pl(r){return Z(r)&&r.name==="AuthImplicitGrantRedirectError"}class Vn extends yt{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ks extends yt{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function us(r){return Z(r)&&r.name==="AuthRetryableFetchError"}class Hn extends yt{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class kr extends yt{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Yr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Wn=` 	
\r=`.split(""),yl=(()=>{const r=new Array(128);for(let e=0;e<r.length;e+=1)r[e]=-1;for(let e=0;e<Wn.length;e+=1)r[Wn[e].charCodeAt(0)]=-2;for(let e=0;e<Yr.length;e+=1)r[Yr[e].charCodeAt(0)]=e;return r})();function Gn(r,e,t){if(r!==null)for(e.queue=e.queue<<8|r,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Yr[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(Yr[s]),e.queuedBits-=6}}function ea(r,e,t){const s=yl[r];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(r)}"`)}}function Kn(r){const e=[],t=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=o=>{bl(o,s,t)};for(let o=0;o<r.length;o+=1)ea(r.charCodeAt(o),n,a);return e.join("")}function xl(r,e){if(r<=127){e(r);return}else if(r<=2047){e(192|r>>6),e(128|r&63);return}else if(r<=65535){e(224|r>>12),e(128|r>>6&63),e(128|r&63);return}else if(r<=1114111){e(240|r>>18),e(128|r>>12&63),e(128|r>>6&63),e(128|r&63);return}throw new Error(`Unrecognized Unicode codepoint: ${r.toString(16)}`)}function vl(r,e){for(let t=0;t<r.length;t+=1){let s=r.charCodeAt(t);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(r.charCodeAt(t+1)-56320&65535|n)+65536,t+=1}xl(s,e)}}function bl(r,e,t){if(e.utf8seq===0){if(r<=127){t(r);return}for(let s=1;s<6;s+=1)if((r>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=r&31;else if(e.utf8seq===3)e.codepoint=r&15;else if(e.utf8seq===4)e.codepoint=r&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(r<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|r&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function wl(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<r.length;n+=1)ea(r.charCodeAt(n),t,s);return new Uint8Array(e)}function _l(r){const e=[];return vl(r,t=>e.push(t)),new Uint8Array(e)}function jl(r){const e=[],t={queue:0,queuedBits:0},s=n=>{e.push(n)};return r.forEach(n=>Gn(n,t,s)),Gn(null,t,s),e.join("")}function kl(r){return Math.round(Date.now()/1e3)+r}function Al(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const qe=()=>typeof window<"u"&&typeof document<"u",jt={tested:!1,writable:!1},Ar=()=>{if(!qe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(jt.tested)return jt.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),jt.tested=!0,jt.writable=!0}catch{jt.tested=!0,jt.writable=!1}return jt.writable};function El(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const ta=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>Sr(async()=>{const{default:s}=await Promise.resolve().then(()=>rr);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Sl=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",ra=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ur=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Br=async(r,e)=>{await r.removeItem(e)};class ns{constructor(){this.promise=new ns.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ns.promiseConstructor=Promise;function hs(r){const e=r.split(".");if(e.length!==3)throw new kr("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!ul.test(e[s]))throw new kr("JWT not in base64url format");return{header:JSON.parse(Kn(e[0])),payload:JSON.parse(Kn(e[1])),signature:wl(e[2]),raw:{header:e[0],payload:e[1]}}}async function Nl(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Tl(r,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await r(a);if(!e(a,null,o)){s(o);return}}catch(o){if(!e(a,o)){n(o);return}}})()})}function Cl(r){return("0"+r.toString(16)).substr(-2)}function Ol(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let a=0;a<56;a++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Cl).join("")}async function Il(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Rl(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await Il(r);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function qt(r,e,t=!1){const s=Ol();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await ra(r,`${e}-code-verifier`,n);const a=await Rl(s);return[a,s===a?"plain":"s256"]}const Ll=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Pl(r){const e=r.headers.get(Gs);if(!e||!e.match(Ll))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Dl(r){if(!r)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(r<=e)throw new Error("JWT has expired")}function Ml(r){switch(r){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $l=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Vt(r){if(!$l.test(r))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Fl=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const kt=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Ul=[502,503,504];async function Jn(r){var e;if(!Sl(r))throw new Ks(kt(r),0);if(Ul.includes(r.status))throw new Ks(kt(r),r.status);let t;try{t=await r.json()}catch(a){throw new Zi(kt(a),a)}let s;const n=Pl(r);if(n&&n.getTime()>=Qi["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Hn(kt(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ft}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Hn(kt(t),r.status,t.weak_password.reasons);throw new fl(kt(t),r.status||500,s)}const Bl=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function te(r,e,t,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[Gs]||(a[Gs]=Qi["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const o=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await zl(r,e,t+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function zl(r,e,t,s,n,a){const o=Bl(e,s,n,a);let l;try{l=await r(t,Object.assign({},o))}catch(c){throw console.error(c),new Ks(kt(c),0)}if(l.ok||await Jn(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Jn(c)}}function it(r){var e;let t=null;Wl(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=kl(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Yn(r){const e=it(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function gt(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function ql(r){return{data:r,error:null}}function Vl(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a}=r,o=Fl(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Hl(r){return r}function Wl(r){return r.access_token&&r.refresh_token&&r.expires_in}const fs=["global","local","others"];var Gl=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Kl{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=ta(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=fs[0]){if(fs.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${fs.join(", ")}`);try{return await te(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await te(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:gt})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Gl(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await te(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Vl,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Z(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await te(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:gt})}catch(t){if(Z(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await te(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Hl});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const y=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(x.split(";")[1].split("=")[1]);d[`${_}Page`]=y}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(Z(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Vt(e);try{return await te(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:gt})}catch(t){if(Z(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Vt(e);try{return await te(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:gt})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Vt(e);try{return await te(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:gt})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Vt(e.userId);try{const{data:t,error:s}=await te(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(Z(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Vt(e.userId),Vt(e.id);try{return{data:await te(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}}}const Jl={getItem:r=>Ar()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{Ar()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{Ar()&&globalThis.localStorage.removeItem(r)}};function Xn(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Yl(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ht={debug:!!(globalThis&&Ar()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sa extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Xl extends sa{}async function Ql(r,e,t){Ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ht.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{Ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw Ht.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Xl(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(Ht.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Yl();const Zl={url:ll,storageKey:cl,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:dl,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Qn(r,e,t){return await t()}class Er{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Er.nextInstanceID,Er.nextInstanceID+=1,this.instanceID>0&&qe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Zl),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Kl({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=ta(n.fetch),this.lock=n.lock||Qn,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:qe()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Ql:this.lock=Qn,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:Ar()?this.storage=Jl:(this.memoryStorage={},this.storage=Xn(this.memoryStorage)):(this.memoryStorage={},this.storage=Xn(this.memoryStorage)),qe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Xi}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=El(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),qe()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),pl(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Z(t)?{error:t}:{error:new Zi("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const a=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:it}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Z(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,n;try{let a;if("email"in e){const{email:u,password:h,options:f}=e;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await qt(this.storage,this.storageKey)),a=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(t=f==null?void 0:f.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:x},xform:it})}else if("phone"in e){const{phone:u,password:h,options:f}=e;a=await te(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:it})}else throw new $r("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Z(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yn})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await te(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yn})}else throw new $r("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Mr}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(Z(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if(t==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,s,n,a,o,l,c,d,u,h,f,m;let x,y;if("message"in e)x=e.message,y=e.signature;else{const{chain:_,wallet:F,statement:T,options:j}=e;let R;if(qe())if(typeof F=="object")R=F;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))R=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof F!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=F}const I=new URL((t=j==null?void 0:j.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in R&&R.signIn){const w=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j==null?void 0:j.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),T?{statement:T}:null));let E;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")E=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)E=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in E&&"signature"in E&&(typeof E.signedMessage=="string"||E.signedMessage instanceof Uint8Array)&&E.signature instanceof Uint8Array)x=typeof E.signedMessage=="string"?E.signedMessage:new TextDecoder().decode(E.signedMessage),y=E.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${I.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...T?["",T,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(n=(s=j==null?void 0:j.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=j==null?void 0:j.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((o=j==null?void 0:j.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((l=j==null?void 0:j.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((c=j==null?void 0:j.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((d=j==null?void 0:j.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((h=(u=j==null?void 0:j.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...j.signInWithSolana.resources.map(E=>`- ${E}`)]:[]].join(`
`);const w=await R.signMessage(new TextEncoder().encode(x),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=w}}try{const{data:_,error:F}=await te(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:jl(y)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:it});if(F)throw F;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Mr}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:F})}catch(_){if(Z(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await Ur(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:a,error:o}=await te(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:it});if(await Br(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Mr}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:o})}catch(a){if(Z(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:a,nonce:o}=e,l=await te(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:it}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Mr}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(t){if(Z(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await qt(this.storage,this.storageKey));const{error:h}=await te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await te(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new $r("You must provide either an email or phone number.")}catch(l){if(Z(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,s;try{let n,a;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await te(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:it});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(Z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await qt(this.storage,this.storageKey)),await te(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:ql})}catch(a){if(Z(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new ft;const{error:n}=await te(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(Z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:o}=await te(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:o,error:l}=await te(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new $r("You must provide either an email or phone number and a type")}catch(t){if(Z(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ur(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ds:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:gt}):await this._useSession(async t=>{var s,n,a;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ft}:await te(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:gt})})}catch(t){if(Z(t))return gl(t)&&(await this._removeSession(),await Br(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new ft;const o=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await qt(this.storage,this.storageKey));const{data:d,error:u}=await te(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:gt});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(Z(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ft;const t=Date.now()/1e3;let s=t,n=!0,a=null;const{payload:o}=hs(e.access_token);if(o.exp&&(s=o.exp,n=s<=t),n){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Z(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ft;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Z(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!qe())throw new Fr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Fr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Vn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Fr("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Vn("No code detected.");const{data:T,error:j}=await this._exchangeCodeForSession(e.code);if(j)throw j;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:T.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new Fr("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c));const m=f-u;m*1e3<=Kt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const x=f-h;u-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,f,u):u-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,f,u);const{data:y,error:_}=await this._getUser(a);if(_)throw _;const F={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:o,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:F,redirectType:e.type},error:null}}catch(s){if(Z(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ur(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{error:a};const o=(s=n.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(ml(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Br(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Al(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:a},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await qt(this.storage,this.storageKey,!0));try{return await te(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Z(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Z(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async a=>{var o,l,c,d,u;const{data:h,error:f}=a;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await te(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return qe()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(Z(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:o}=t;if(o)throw o;return await te(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(Z(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Tl(async n=>(n>0&&await Nl(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await te(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:it})),(n,a)=>{const o=200*Math.pow(2,n);return a&&us(a)&&Date.now()+o-s<Kt})}catch(s){if(this._debug(t,"error",s),Z(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),qe()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ur(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<ds;if(this._debug(t,`session has${n?"":" not"} expired with margin of ${ds}s`),n){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),us(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new ft;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new ns;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ft;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),Z(a)){const o={session:null,error:a};return us(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ra(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Br(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Kt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Kt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Kt}ms, refresh threshold is ${Ws} ticks`),n<=Ws&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof sa)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,o]=await qt(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await te(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Z(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:a,error:o}=t;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await te(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(t){if(Z(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:o,error:l}=await te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(Z(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:a}=t;return a?{data:null,error:a}:await te(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Z(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=hs(n.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(o=>o.kid===e);if(s||(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+hl>Date.now()))return s;const{data:n,error:a}=await te(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;if(!n.keys||n.keys.length===0)throw new kr("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),s=n.keys.find(o=>o.kid===e),!s)throw new kr("No matching signing key found in JWKS");return s}async getClaims(e,t={keys:[]}){try{let s=e;if(!s){const{data:m,error:x}=await this.getSession();if(x||!m.session)return{data:null,error:x};s=m.session.access_token}const{header:n,payload:a,signature:o,raw:{header:l,payload:c}}=hs(s);if(Dl(a.exp),!n.kid||n.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:a,header:n,signature:o},error:null}}const d=Ml(n.alg),u=await this.fetchJwk(n.kid,t),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,_l(`${l}.${c}`)))throw new kr("Invalid JWT signature");return{data:{claims:a,header:n,signature:o},error:null}}catch(s){if(Z(s))return{data:null,error:s};throw s}}}Er.nextInstanceID=0;const ec=Er;class tc extends ec{constructor(e){super(e)}}var rc=function(r,e,t,s){function n(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(r,e||[])).next())})};class sc{constructor(e,t,s){var n,a,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const l=al(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:Qo,realtime:el,auth:Object.assign(Object.assign({},Zo),{storageKey:d}),global:Xo},h=ol(s??{},u);this.storageKey=(n=h.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=nl(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new wo(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new lo(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ko(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return rc(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:a,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tc({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Lo(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const na=(r,e,t)=>new sc(r,e,t),nc="https://elspfjgtbjfcirxcynut.supabase.co",ic="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVsc3Bmamd0YmpmY2lyeGN5bnV0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NzIyNTEsImV4cCI6MjA2NDA0ODI1MX0.xS9T9SJWWlFIWgrLkQ09x2IErPDt7CuzAB83qdHKvgA";let ms=null;const ie=(ms||(ms=na(nc,ic,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce"}})),ms),ia=b.createContext(void 0),ac=({children:r})=>{const[e,t]=b.useState(null),[s,n]=b.useState(null),[a,o]=b.useState(!0);b.useEffect(()=>{ie.auth.getSession().then(({data:{session:x}})=>{n(x),t((x==null?void 0:x.user)??null),o(!1)});const{data:{subscription:m}}=ie.auth.onAuthStateChange((x,y)=>{n(y),t((y==null?void 0:y.user)??null),o(!1)});return()=>m.unsubscribe()},[]);const l=m=>{throw console.error("Auth error:",m),m.message.includes("Invalid login credentials")?new Error("     ."):m.message.includes("Email not confirmed")?new Error("     ."):m.message.includes("User already registered")?new Error("     ."):new Error("  .    .")},f={user:e,session:s,loading:a,signIn:async(m,x)=>{try{const{error:y}=await ie.auth.signInWithPassword({email:m,password:x});y&&l(y)}catch(y){throw console.error("Error signing in:",y),y}},signUp:async(m,x)=>{try{const{error:y}=await ie.auth.signUp({email:m,password:x,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});y&&l(y)}catch(y){throw console.error("Error signing up:",y),y}},signOut:async()=>{try{const{error:m}=await ie.auth.signOut();if(m)throw m}catch(m){throw console.error("Error signing out:",m),m}},signInWithGoogle:async m=>{try{const{error:x}=await ie.auth.signInWithOAuth({provider:"google",options:m==null?void 0:m.options});return x&&l(x),{error:x}}catch(x){throw console.error("Error signing in with Google:",x),x}}};return i.jsx(ia.Provider,{value:f,children:!a&&r})},Ke=()=>{const r=b.useContext(ia);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r};var aa={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Zn=K.createContext&&K.createContext(aa),oc=["attr","size","title"];function lc(r,e){if(r==null)return{};var t=cc(r,e),s,n;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(n=0;n<a.length;n++)s=a[n],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(t[s]=r[s])}return t}function cc(r,e){if(r==null)return{};var t={};for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){if(e.indexOf(s)>=0)continue;t[s]=r[s]}return t}function Xr(){return Xr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},Xr.apply(this,arguments)}function ei(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,s)}return t}function Qr(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ei(Object(t),!0).forEach(function(s){dc(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):ei(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}function dc(r,e,t){return e=uc(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function uc(r){var e=hc(r,"string");return typeof e=="symbol"?e:e+""}function hc(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function oa(r){return r&&r.map((e,t)=>K.createElement(e.tag,Qr({key:t},e.attr),oa(e.child)))}function me(r){return e=>K.createElement(fc,Xr({attr:Qr({},r.attr)},e),oa(r.child))}function fc(r){var e=t=>{var{attr:s,size:n,title:a}=r,o=lc(r,oc),l=n||t.size||"1em",c;return t.className&&(c=t.className),r.className&&(c=(c?c+" ":"")+r.className),K.createElement("svg",Xr({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,o,{className:c,style:Qr(Qr({color:r.color||t.color},t.style),r.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&K.createElement("title",null,a),r.children)};return Zn!==void 0?K.createElement(Zn.Consumer,null,t=>e(t)):e(aa)}function mc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(r)}function ti(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"},child:[]}]})(r)}function gc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"},child:[]}]})(r)}function pc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z",clipRule:"evenodd"},child:[]}]})(r)}function yc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"},child:[]}]})(r)}function xc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"},child:[]}]})(r)}function vc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"},child:[]}]})(r)}function bc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"},child:[]}]})(r)}function wc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"},child:[]}]})(r)}function _c(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"},child:[]}]})(r)}function jc(r){return me({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(r)}function ri(){var s;const{user:r,signOut:e}=Ke(),t=(r==null?void 0:r.email)==="active.legendss@gmail.com";return r?i.jsxs(ze,{as:"div",className:"relative inline-block text-right",children:[i.jsx(ze.Button,{className:"inline-flex items-center justify-center rounded-full w-10 h-10 bg-white/10 text-white hover:bg-white/20 transition-colors",children:(s=r.user_metadata)!=null&&s.avatar_url?i.jsx("img",{src:r.user_metadata.avatar_url,alt:"User avatar",className:"w-full h-full rounded-full object-cover"}):i.jsx(_c,{className:"w-5 h-5"})}),i.jsx(Va,{as:b.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:i.jsx(ze.Items,{className:"absolute left-0 mt-2 w-56 origin-top-left rounded-md bg-black border border-white/10 shadow-lg focus:outline-none",children:i.jsxs("div",{className:"p-2",children:[i.jsxs("div",{className:"px-3 py-2 text-sm text-gray-300",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:[r.email,t&&i.jsx("span",{className:"mr-2 text-xs bg-primary/20 text-primary px-2 py-0.5 rounded",children:""})]}),t&&i.jsxs(i.Fragment,{children:[i.jsx(ze.Item,{children:({active:n})=>i.jsxs(ge,{to:"/admin/download-links",className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(pc,{className:"w-5 h-5"}),"  "]})}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs(ge,{to:"/team-admin",className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(ti,{className:"w-5 h-5"}),"  "]})}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs(ge,{to:"/admin/terms",className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(ti,{className:"w-5 h-5"}),"   "]})}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs("button",{className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(wc,{className:"w-5 h-5"})," "]})}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs("button",{className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(vc,{className:"w-5 h-5"})," "]})}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs("button",{className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(bc,{className:"w-5 h-5"})," "]})}),i.jsx("div",{className:"my-1 border-t border-white/10"})]}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs(ge,{to:"/my-games",className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(gc,{className:"w-5 h-5"})," "]})}),i.jsx(ze.Item,{children:({active:n})=>i.jsxs("button",{onClick:()=>e(),className:`${n?"bg-white/10":""} group flex w-full items-center rounded-md px-3 py-2 text-sm text-white gap-2`,children:[i.jsx(yc,{className:"w-5 h-5"}),""]})})]})})})]}):null}const la=({isOpen:r,onClose:e,initialMode:t="login"})=>{const[s,n]=b.useState(t==="login"),[a,o]=b.useState(""),[l,c]=b.useState(""),[d,u]=b.useState(null),[h,f]=b.useState(!1),[m,x]=b.useState(s),{signIn:y,signUp:_,signInWithGoogle:F}=Ke();b.useEffect(()=>{n(t==="login"),x(t==="login")},[t]);const T=()=>!a||!l?(u("     ."),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?l.length<6?(u("      ."),!1):m?!0:(u("     ."),!1):(u("     ."),!1),j=async I=>{if(I.preventDefault(),u(null),!!T()){f(!0);try{s?await y(a,l):await _(a,l),e()}catch(w){u(w.message||"  .    .")}finally{f(!1)}}},R=async()=>{u(null),f(!0);try{const{error:I}=await F({options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(I)throw I}catch(I){u(I.message||"      .    ."),f(!1)}};return r?i.jsx(tr,{children:i.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e,children:i.jsx(z.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-md overflow-hidden",onClick:I=>I.stopPropagation(),children:i.jsxs("div",{className:"p-6 sm:p-8",children:[i.jsxs("div",{className:"text-center mb-6",children:[i.jsx("img",{src:"/AE logo.svg",alt:"Active Legend",className:"w-16 h-16 mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-white",children:s?" Active Legend  ":"   "})]}),i.jsxs("form",{onSubmit:j,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("input",{type:"email",id:"email",value:a,onChange:I=>o(I.target.value),className:"w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"example@email.com",required:!0,dir:"ltr"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-1",children:" "}),i.jsx("input",{type:"password",id:"password",value:l,onChange:I=>c(I.target.value),className:"w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"",required:!0,minLength:6,dir:"ltr"})]}),i.jsxs("div",{className:"flex items-center gap-2 mt-2 mb-1",children:[i.jsx("input",{id:"accept-terms",type:"checkbox",checked:m,onChange:I=>x(I.target.checked),className:"form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500 border-gray-300",style:{accentColor:"#2563eb"}}),i.jsx("label",{htmlFor:"accept-terms",className:"text-[11px] text-gray-400 select-none cursor-pointer",children:i.jsx("a",{href:"https://activelegend.ir/terms",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-blue-400 transition",children:"        "})})]}),d&&i.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-3 text-red-500 text-sm",children:d}),i.jsx("button",{type:"submit",disabled:!m||h,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"  ..."]}):s?"":" "})]}),i.jsxs("div",{className:"relative my-6",children:[i.jsx("div",{className:"absolute inset-0 flex items-center",children:i.jsx("div",{className:"w-full border-t border-gray-700"})}),i.jsx("div",{className:"relative flex justify-center text-sm",children:i.jsx("span",{className:"px-2 bg-gray-900 text-gray-400",children:""})})]}),i.jsxs("button",{onClick:R,disabled:!m||h,className:"w-full bg-white text-gray-900 py-3 rounded-lg font-medium hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all duration-300 flex items-center justify-center gap-3 shadow-md hover:shadow-lg",children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[i.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),i.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),i.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),i.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),i.jsx("span",{children:"  "})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsx("button",{onClick:()=>n(!s),className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:s?"     ":"     "})})]})})})}):null},kc="https://elspfjgtbjfcirxcynut.supabase.co",Ac="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVsc3Bmamd0YmpmY2lyeGN5bnV0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NzIyNTEsImV4cCI6MjA2NDA0ODI1MX0.xS9T9SJWWlFIWgrLkQ09x2IErPDt7CuzAB83qdHKvgA",oe=na(kc,Ac),si="https://www.aparat.com/api/video/video/list/videohash",Ec={async getVideos(r=1,e=12){const t=await fetch(`${si}?page=${r}&perPage=${e}`);if(!t.ok)throw new Error("Failed to fetch videos from Aparat");return t.json()},async searchVideos(r,e=1,t=12){const s=await fetch(`${si}?search=${encodeURIComponent(r)}&page=${e}&perPage=${t}`);if(!s.ok)throw new Error("Failed to search videos on Aparat");return s.json()}};function Sc(){const[r,e]=b.useState(!1),[t,s]=b.useState(!1),[n,a]=b.useState("login"),{user:o}=Ke(),l=Ya(),c=Nt(),[d,u]=b.useState(""),[h,f]=b.useState([]),[m,x]=b.useState(!1),[y,_]=b.useState(null),[F,T]=b.useState(!1),j=b.useRef(null),[R,I]=b.useState(!1);b.useEffect(()=>{const N=()=>{e(window.scrollY>50)};return window.addEventListener("scroll",N),()=>window.removeEventListener("scroll",N)},[]);const w=N=>{a(N),s(!0)},E=N=>{var Y;if((Y=N.preventDefault)==null||Y.call(N),l.pathname!=="/")c("/"),setTimeout(()=>{const q=document.getElementById("gallery");if(q){const W=q.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:W,behavior:"smooth"})}},100);else{const q=document.getElementById("gallery");if(q){const W=q.getBoundingClientRect().top+window.pageYOffset-80;window.scrollTo({top:W,behavior:"smooth"})}}},U=async N=>{if(!N.trim()){f([]),T(!1);return}x(!0),_(null),T(!0);try{const{data:Y,error:q}=await oe.from("games").select("*").or(`title.ilike.%${N}%,description.ilike.%${N}%`).eq("is_visible",!0).limit(20);if(q)throw q;const{data:A,error:D}=await oe.from("games").select("*").eq("is_visible",!0);if(D)throw D;const W=N.toLowerCase(),de=(A||[]).filter($=>Array.isArray($.content_blocks)&&$.content_blocks.some(X=>X.content&&X.content.toLowerCase().includes(W)||X.caption&&X.caption.toLowerCase().includes(W))),ne=[...Y||[]];de.forEach($=>{ne.find(X=>X.id===$.id)||ne.push($)});const S=ne.slice(0,10);let P=[];try{const $=await Ec.searchVideos(N,1,5);Array.isArray($)?P=$:Array.isArray($==null?void 0:$.included)?P=$.included:Array.isArray($==null?void 0:$.data)?P=$.data:P=[]}catch{}f([{type:"games",items:S},{type:"videos",items:P}])}catch{_("  .")}finally{x(!1)}},J=N=>{u(N.target.value),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{U(N.target.value)},500)},ce=N=>{N.preventDefault(),j.current&&clearTimeout(j.current),U(d)},Q=()=>l.pathname==="/"?i.jsxs(i.Fragment,{children:[i.jsx(ge,{to:"/about",className:"nav-link",children:" "}),i.jsx(ge,{to:"/games",className:"nav-link",children:""}),o&&i.jsx(ge,{to:"/my-games",className:"nav-link",children:" "}),i.jsx("span",{role:"button",tabIndex:0,onClick:N=>{R&&I(!1),setTimeout(()=>E(N),100)},onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&(R&&I(!1),setTimeout(()=>E(N),100))},className:"nav-link cursor-pointer",children:""}),i.jsx(ge,{to:"/contact",className:"nav-link",children:""})]}):l.pathname.startsWith("/games")?i.jsxs(i.Fragment,{children:[i.jsx(ge,{to:"/",className:"nav-link",children:" "}),i.jsx(ge,{to:"/games",className:"nav-link",children:""}),o&&i.jsx(ge,{to:"/my-games",className:"nav-link",children:" "}),i.jsx("span",{role:"button",tabIndex:0,onClick:E,onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&E(N)},className:"nav-link cursor-pointer",children:""}),i.jsx(ge,{to:"/contact",className:"nav-link",children:""})]}):i.jsxs(i.Fragment,{children:[i.jsx(ge,{to:"/",className:"nav-link",children:" "}),i.jsx(ge,{to:"/games",className:"nav-link",children:""}),o&&i.jsx(ge,{to:"/my-games",className:"nav-link",children:" "}),i.jsx("span",{role:"button",tabIndex:0,onClick:E,onKeyDown:N=>{(N.key==="Enter"||N.key===" ")&&E(N)},className:"nav-link cursor-pointer",children:""}),i.jsx(ge,{to:"/contact",className:"nav-link",children:""})]});return i.jsxs(i.Fragment,{children:[i.jsxs(z.nav,{initial:{y:-100},animate:{y:0},className:`fixed top-0 right-0 left-0 z-50 transition-all duration-300 ${r?"backdrop-blur-md bg-black/50 py-4":"py-6"}`,style:{willChange:"transform",transform:"translateZ(0)",backfaceVisibility:"hidden",perspective:"1000px"},children:[i.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between gap-4",children:[i.jsx(ge,{to:"/",children:i.jsx(z.img,{src:"/AE logo.svg",alt:"Active Legend",className:"h-8 w-auto",whileHover:{scale:1.05}})}),i.jsxs("form",{onSubmit:ce,className:"relative flex-1 max-w-md mx-4 hidden lg:block",children:[i.jsx("input",{type:"text",className:"w-full bg-black/60 border border-white/10 rounded-xl py-2.5 px-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary transition-all",placeholder:"  ...",value:d,onChange:J,onFocus:()=>d&&T(!0),onBlur:()=>setTimeout(()=>T(!1),200),dir:"rtl"}),i.jsx("button",{type:"submit",className:"absolute left-2 top-1/2 -translate-y-1/2 text-primary hover:text-white transition-colors",children:i.jsx("svg",{width:"22",height:"22",fill:"none",viewBox:"0 0 24 24",children:i.jsx("path",{stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.35-4.35m1.35-5.15a7 7 0 11-14 0 7 7 0 0114 0z"})})}),F&&i.jsxs("div",{className:"absolute right-0 left-0 mt-2 bg-black/95 border border-white/10 rounded-xl shadow-lg z-50 max-h-80 overflow-y-auto",children:[m&&i.jsx("div",{className:"p-4 text-center text-gray-400",children:"  ..."}),y&&i.jsx("div",{className:"p-4 text-center text-red-400",children:y}),!m&&!y&&h.length===0&&i.jsx("div",{className:"p-4 text-center text-gray-400",children:"  ."}),!m&&!y&&h.map((N,Y)=>i.jsxs("div",{className:"border-b border-white/5 last:border-b-0",children:[i.jsx("div",{className:"px-4 py-2 text-xs text-primary font-bold",children:N.type==="games"?"":N.type==="videos"?"":""}),N.items.length===0?i.jsx("div",{className:"px-4 py-2 text-gray-500 text-xs",children:"  ."}):N.items.map(q=>{var A,D;return i.jsx(ge,{to:N.type==="games"?`/games/${q.slug}`:q.url||q.link||"#",target:N.type==="videos"?"_blank":void 0,className:"block px-4 py-2 hover:bg-primary/10 text-sm text-white transition-colors rounded-lg",onClick:()=>T(!1),children:N.type==="games"?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold",children:q.title}),i.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:[(A=q.description)==null?void 0:A.slice(0,40),"..."]})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold",children:q.title||q.name}),i.jsx("span",{className:"text-xs text-gray-400 ml-2",children:((D=q.description)==null?void 0:D.slice(0,40))||""})]})},q.id||q.uid||q.slug)})]},N.type))]})]}),i.jsxs("div",{className:"flex items-center gap-2 lg:hidden",children:[i.jsx("button",{className:"flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-primary order-2",onClick:()=>I(!0),"aria-label":"  ",type:"button",children:i.jsx(xc,{className:"w-8 h-8"})}),o&&i.jsx("div",{className:"order-1",children:i.jsx(ri,{})})]}),i.jsxs("div",{className:"hidden lg:flex items-center gap-8",children:[Q(),o?i.jsx(ri,{}):i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(z.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"btn-secondary",onClick:()=>w("login"),children:""}),i.jsx(z.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"btn-primary",onClick:()=>w("signup"),children:""})]})]})]}),R&&i.jsxs("div",{className:"fixed inset-0 z-[999] bg-black flex flex-col lg:hidden",children:[i.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-white/10",children:[i.jsx(ge,{to:"/",onClick:()=>I(!1),children:i.jsx("img",{src:"/AE logo.svg",alt:"Active Legends",className:"h-8 w-auto"})}),i.jsx("button",{className:"p-2 rounded-md text-white hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-primary",onClick:()=>I(!1),"aria-label":" ",type:"button",children:i.jsx(jc,{className:"w-8 h-8"})})]}),i.jsxs("form",{onSubmit:ce,className:"relative p-4 border-b border-white/10",children:[i.jsx("input",{type:"text",className:"w-full bg-black/60 border border-white/10 rounded-xl py-3 px-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary transition-all",placeholder:"  ...",value:d,onChange:J,onFocus:()=>d&&T(!0),onBlur:()=>setTimeout(()=>T(!1),200),dir:"rtl"}),i.jsx("button",{type:"submit",className:"absolute left-6 top-1/2 -translate-y-1/2 text-primary hover:text-white transition-colors",children:i.jsx("svg",{width:"22",height:"22",fill:"none",viewBox:"0 0 24 24",children:i.jsx("path",{stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-4.35-4.35m1.35-5.15a7 7 0 11-14 0 7 7 0 0114 0z"})})}),F&&i.jsxs("div",{className:"absolute right-0 left-0 mt-2 bg-black/95 border border-white/10 rounded-xl shadow-lg z-50 max-h-80 overflow-y-auto",children:[m&&i.jsx("div",{className:"p-4 text-center text-gray-400",children:"  ..."}),y&&i.jsx("div",{className:"p-4 text-center text-red-400",children:y}),!m&&!y&&h.length===0&&i.jsx("div",{className:"p-4 text-center text-gray-400",children:"  ."}),!m&&!y&&h.map((N,Y)=>i.jsxs("div",{className:"border-b border-white/5 last:border-b-0",children:[i.jsx("div",{className:"px-4 py-2 text-xs text-primary font-bold",children:N.type==="games"?"":N.type==="videos"?"":""}),N.items.length===0?i.jsx("div",{className:"px-4 py-2 text-gray-500 text-xs",children:"  ."}):N.items.map(q=>{var A,D;return i.jsx(ge,{to:N.type==="games"?`/games/${q.slug}`:q.url||q.link||"#",target:N.type==="videos"?"_blank":void 0,className:"block px-4 py-2 hover:bg-primary/10 text-sm text-white transition-colors rounded-lg bg-black",onClick:()=>I(!1),children:N.type==="games"?i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold",children:q.title}),i.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:[(A=q.description)==null?void 0:A.slice(0,40),"..."]})]}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-bold",children:q.title||q.name}),i.jsx("span",{className:"text-xs text-gray-400 ml-2",children:((D=q.description)==null?void 0:D.slice(0,40))||""})]})},q.id||q.uid||q.slug)})]},N.type))]})]}),i.jsxs("div",{className:"mx-4 my-6 rounded-2xl bg-black/80 p-2 flex flex-col gap-1",children:[i.jsx("nav",{className:"flex flex-col gap-1",children:Q()&&K.Children.map(Q().props.children,N=>N&&K.cloneElement(N,{className:(N.props.className||"")+" rounded-lg px-3 py-2 hover:bg-white/10 transition-colors",onClick:()=>I(!1)}))}),i.jsx("div",{className:"flex flex-col gap-1 mt-2",children:o?null:i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"btn-secondary w-full rounded-lg mb-1",onClick:()=>{I(!1),w("login")},children:""}),i.jsx("button",{className:"btn-primary w-full rounded-lg",onClick:()=>{I(!1),w("signup")},children:""})]})})]})]})]}),i.jsx(la,{isOpen:t,onClose:()=>s(!1),initialMode:n})]})}function Nc(){return i.jsx(z.div,{className:"absolute bottom-8 left-1/2 -translate-x-1/2 text-white/80",initial:{opacity:0,y:-10},animate:{opacity:[.5,1,.5],y:[0,10,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:i.jsx(mc,{className:"w-8 h-8"})})}function Tc(){const[r,e]=b.useState(!1),[t,s]=b.useState("login"),{user:n}=Ke(),a=c=>{s(c),e(!0)},o=window.innerWidth<640,l={initial:{opacity:0,y:o?10:20},animate:{opacity:1,y:0},transition:{duration:o?.5:.8}};return i.jsxs("header",{className:"relative min-h-screen flex items-center justify-center overflow-hidden scroll-container",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/50 via-black/80 to-black/95"}),i.jsxs(z.div,{...l,className:"relative z-10 text-center max-w-4xl mx-auto px-4",style:{willChange:"transform",transform:"translateZ(0)",backfaceVisibility:"hidden",perspective:"1000px"},children:[i.jsx(z.img,{src:"/AE logo.svg",alt:"Active Legends",className:"w-40 h-40 sm:w-64 sm:h-64 md:w-80 md:h-80 mx-auto mb-8",initial:{scale:o?.8:0},animate:{scale:1},transition:{type:o?"tween":"spring",duration:o?.5:1}}),i.jsx(z.h1,{className:"text-5xl md:text-6xl font-bold mb-4 text-white bg-clip-text",...l,transition:{...l.transition,delay:o?.1:.3},children:"     "}),i.jsx(z.p,{className:"text-xl md:text-2xl mb-8 text-gray-300",...l,transition:{...l.transition,delay:o?.2:.5},children:"    "}),i.jsxs(z.div,{className:"space-x-4 space-x-reverse",...l,transition:{...l.transition,delay:o?.3:.7},children:[i.jsx(ge,{to:"/games",children:i.jsx(z.button,{className:"btn-primary",whileHover:{scale:o?1.02:1.05},whileTap:{scale:o?.98:.95},children:" "})}),!n&&i.jsxs(i.Fragment,{children:[i.jsx(z.button,{className:"btn-secondary",whileHover:{scale:o?1.02:1.05},whileTap:{scale:o?.98:.95},onClick:()=>a("signup"),children:""}),i.jsx(z.button,{className:"btn-secondary",whileHover:{scale:o?1.02:1.05},whileTap:{scale:o?.98:.95},onClick:()=>a("login"),children:""})]})]})]}),i.jsx(Nc,{}),i.jsx(la,{isOpen:r,onClose:()=>e(!1),initialMode:t})]})}const ni=["#FACC15","#FBBF24","#F59E0B","#D97706","#B45309"];function Cc(){return typeof window>"u"?!1:window.innerWidth<640}function Oc(r,e){return Array.from({length:r}).map(()=>({id:crypto.randomUUID(),size:e?120+Math.random()*100:200+Math.random()*250,x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,color:ni[Math.floor(Math.random()*ni.length)],parallax:e?1:15+Math.random()*20,rotation:Math.random()*360,scale:1+Math.random()*.5}))}function Ic(){const r=Cc(),e=r?2:5,[t,s]=b.useState(()=>Oc(e,r));b.useRef({x:window.innerWidth/2,y:window.innerHeight/2});const[n,a]=b.useState(t.map(()=>({x:0,y:0})));return b.useEffect(()=>{if(r)return;const o=l=>{const c=l.clientX,d=l.clientY,u=t.map(h=>{const f=(c-window.innerWidth/2)/h.parallax,m=(d-window.innerHeight/2)/h.parallax;return{x:-f,y:-m}});a(u)};return window.addEventListener("mousemove",o),()=>window.removeEventListener("mousemove",o)},[t,r]),b.useEffect(()=>{const o=setInterval(()=>{s(l=>l.map(c=>({...c,rotation:(c.rotation+(r?.5:2))%360,scale:1+Math.sin(Date.now()/(r?1200:500)+c.id.charCodeAt(0))*(r?.12:.3)})))},r?80:30);return()=>clearInterval(o)},[r]),i.jsxs("div",{className:"fixed inset-0 z-0 overflow-hidden bg-gradient-to-br from-amber-950 via-orange-950 to-amber-950 pointer-events-none",children:[t.map((o,l)=>{var c,d;return i.jsx(z.div,{className:"absolute rounded-full pointer-events-none",style:{width:o.size,height:o.size,backgroundColor:o.color,top:0,left:0,opacity:r?.25:.5,filter:r?"blur(10px)":"blur(25px)",mixBlendMode:"screen"},animate:{x:o.x+(((c=n[l])==null?void 0:c.x)||0),y:o.y+(((d=n[l])==null?void 0:d.y)||0),rotate:o.rotation,scale:o.scale},transition:{duration:r?.4:.2,ease:"linear"}},o.id)}),i.jsx("div",{className:r?"absolute inset-0 bg-gradient-to-br from-transparent via-amber-500/10 to-transparent":"absolute inset-0 bg-gradient-to-br from-transparent via-amber-500/20 to-transparent animate-pulse"})]})}function Rc(r){return me({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(r)}function Lc(r){return me({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(r)}function Pc(r){return me({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(r)}function Dc(r){return me({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(r)}function Mc(r){return me({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"},child:[]}]})(r)}function ii(r){return me({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(r)}function $c(r){return me({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(r)}function Fc(r){return me({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M8.309 189.836L184.313 37.851C199.719 24.546 224 35.347 224 56.015v80.053c160.629 1.839 288 34.032 288 186.258 0 61.441-39.581 122.309-83.333 154.132-13.653 9.931-33.111-2.533-28.077-18.631 45.344-145.012-21.507-183.51-176.59-185.742V360c0 20.7-24.3 31.453-39.687 18.164l-176.004-152c-11.071-9.562-11.086-26.753 0-36.328z"},child:[]}]})(r)}function Uc(r){return me({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M104 224H24c-13.255 0-24 10.745-24 24v240c0 13.255 10.745 24 24 24h80c13.255 0 24-10.745 24-24V248c0-13.255-10.745-24-24-24zM64 472c-13.255 0-24-10.745-24-24s10.745-24 24-24 24 10.745 24 24-10.745 24-24 24zM384 81.452c0 42.416-25.97 66.208-33.277 94.548h101.723c33.397 0 59.397 27.746 59.553 58.098.084 17.938-7.546 37.249-19.439 49.197l-.11.11c9.836 23.337 8.237 56.037-9.308 79.469 8.681 25.895-.069 57.704-16.382 74.757 4.298 17.598 2.244 32.575-6.148 44.632C440.202 511.587 389.616 512 346.839 512l-2.845-.001c-48.287-.017-87.806-17.598-119.56-31.725-15.957-7.099-36.821-15.887-52.651-16.178-6.54-.12-11.783-5.457-11.783-11.998v-213.77c0-3.2 1.282-6.271 3.558-8.521 39.614-39.144 56.648-80.587 89.117-113.111 14.804-14.832 20.188-37.236 25.393-58.902C282.515 39.293 291.817 0 312 0c24 0 72 8 72 81.452z"},child:[]}]})(r)}function Bc(r){return me({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M298.028 214.267L285.793 96H328c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24H56C42.745 0 32 10.745 32 24v48c0 13.255 10.745 24 24 24h42.207L85.972 214.267C37.465 236.82 0 277.261 0 328c0 13.255 10.745 24 24 24h136v104.007c0 1.242.289 2.467.845 3.578l24 48c2.941 5.882 11.364 5.893 14.311 0l24-48a8.008 8.008 0 0 0 .845-3.578V352h136c13.255 0 24-10.745 24-24-.001-51.183-37.983-91.42-85.973-113.733z"},child:[]}]})(r)}function zc(r){return me({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(r)}function qc(r){return me({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(r)}const{createClient:Vc}=window.supabase,Hc="https://elspfjgtbjfcirxcynut.supabase.co",Wc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVsc3Bmamd0YmpmY2lyeGN5bnV0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0NzIyNTEsImV4cCI6MjA2NDA0ODI1MX0.xS9T9SJWWlFIWgrLkQ09x2IErPDt7CuzAB83qdHKvgA",ur=Vc(Hc,Wc);K.memo(({onSubmit:r,onClose:e,initialData:t,isEditing:s})=>{const[n,a]=b.useState(t||{type:"image",url:"",title:"",description:""}),o=l=>{l.preventDefault(),r(n)};return i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md w-full shadow-2xl border border-gray-700",children:[i.jsx("h3",{className:"text-2xl font-bold mb-6 text-white text-center",children:s?" ":"  "}),i.jsxs("form",{onSubmit:o,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-2 text-right",children:" "}),i.jsxs("select",{value:n.type,onChange:l=>a(c=>({...c,type:l.target.value})),className:"w-full bg-gray-800 text-white rounded p-3 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200",children:[i.jsx("option",{value:"image",children:""}),i.jsx("option",{value:"video",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-2 text-right",children:""}),i.jsx("input",{type:"text",value:n.url,onChange:l=>a(c=>({...c,url:l.target.value})),className:"w-full bg-gray-800 text-white rounded p-3 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200",placeholder:n.type==="image"?" ":"  (YouTube  Vimeo)",dir:"ltr",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-2 text-right",children:""}),i.jsx("input",{type:"text",value:n.title,onChange:l=>a(c=>({...c,title:l.target.value})),className:"w-full bg-gray-800 text-white rounded p-3 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200",placeholder:"  ",dir:"rtl",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-2 text-right",children:""}),i.jsx("textarea",{value:n.description,onChange:l=>a(c=>({...c,description:l.target.value})),className:"w-full bg-gray-800 text-white rounded p-3 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200 resize-none",rows:3,placeholder:"  ",dir:"rtl",required:!0})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[i.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200",children:""}),i.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors duration-200",children:s?"":""})]})]})]})})});function Gc(){const{user:r}=Ke(),[e,t]=b.useState([]),[s,n]=b.useState(!1),[a,o]=b.useState(null),[l,c]=b.useState(null),[d,u]=b.useState(new Set),[h,f]=b.useState({}),m=Ha(),x=b.useRef({}),y=b.useRef(null),_=Wa(y,{once:!0,margin:"-100px"}),[F,T]=b.useState({type:"image",url:"",title:"",description:""}),j=(r==null?void 0:r.email)==="active.legendss@gmail.com",R=async S=>{var P;try{const $=(P=S.split("/").pop())==null?void 0:P.split("?")[0];if(!$)return null;const je=await(await fetch(`https://www.aparat.com/etc/api/video/videohash/${$}`)).json();return je.video?{uid:je.video.uid,title:je.video.title,small_poster:je.video.small_poster,big_poster:je.video.big_poster}:null}catch($){return console.error("Error fetching Aparat video info:",$),null}};b.useEffect(()=>{I()},[]);const I=async()=>{try{const{data:S,error:P}=await ur.from("media_gallery").select("*").order("created_at",{ascending:!1});if(P)throw P;S&&(console.log("Fetched media items:",S),t(S),S.forEach(async $=>{if($.type==="video"&&$.url.includes("aparat.com")){const X=await R($.url);X&&f(je=>({...je,[$.id]:X}))}}))}catch(S){console.error("Error fetching media items:",S),alert("   .     .")}};b.useEffect(()=>{_&&m.start("visible")},[_,m]);const w=S=>{const P=x.current[S];P&&(d.has(S)?(P.pause(),u($=>{const X=new Set($);return X.delete(S),X})):(d.forEach($=>{const X=x.current[$];X&&X.pause()}),u(new Set([S])),P.play().catch($=>{console.error("Error playing video:",$)})))},E=()=>{T({type:"image",url:"",title:"",description:""}),o(null),n(!0)},U=()=>{n(!1),o(null),T({type:"image",url:"",title:"",description:""})},J=S=>{T({type:S.type,url:S.url,title:S.title,description:S.description}),o(S),n(!0)},ce=async S=>{S.preventDefault(),console.log("Form submitted:",F);try{if(a){console.log("Updating item:",a.id);const{data:P,error:$}=await ur.from("media_gallery").update({type:F.type,url:F.url,title:F.title,description:F.description,updated_at:new Date().toISOString()}).eq("id",a.id).select();if($)throw console.error("Update error:",$),$;console.log("Update successful:",P)}else{console.log("Inserting new item");const{data:P,error:$}=await ur.from("media_gallery").insert([{type:F.type,url:F.url,title:F.title,description:F.description,is_visible:!0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select();if($)throw console.error("Insert error:",$),$;console.log("Insert successful:",P)}U(),await I()}catch(P){console.error("Error saving media item:",P),alert("   .    .")}},Q=(S,P)=>{T($=>({...$,[S]:P}))},N=async S=>{if(confirm("      "))try{console.log("Deleting media with ID:",S);const{data:P,error:$}=await ur.from("media_gallery").delete().eq("id",S).select();if($)throw console.error("Supabase delete error:",$),$;console.log("Delete response:",P),await I()}catch(P){console.error("Error in handleDelete:",P),alert("   .    .")}},Y=async(S,P)=>{if(!S){console.error("Media ID is undefined");return}try{console.log("Toggling visibility for ID:",S,"Current visibility:",P);const{data:$,error:X}=await ur.from("media_gallery").update({is_visible:!P}).eq("id",S).select();if(X)throw console.error("Supabase update error:",X),X;console.log("Update response:",$),await I()}catch($){console.error("Error in handleToggleVisibility:",$),alert("    .    .")}},q=S=>{var P;try{if(S.includes("youtube.com")||S.includes("youtu.be"))return`https://www.youtube.com/embed/${S.includes("youtu.be")?S.split("/").pop():new URL(S).searchParams.get("v")}`;if(S.includes("vimeo.com"))return`https://player.vimeo.com/video/${S.split("/").pop()}`;if(S.includes("aparat.com")){const $=(P=S.split("/").pop())==null?void 0:P.split("?")[0];if($)return`https://www.aparat.com/video/video/embed/videohash/${$}/vt/frame`}return S}catch($){return console.error("Error parsing video URL:",$),S}},A=S=>{try{if(S.includes("onedrive.live.com")||S.includes("1drv.ms")){const P=S.replace("redir?","download?");return P.includes("?")?`${P}&download=1`:`${P}?download=1`}if(S.includes("drive.google.com")){let P="";if(S.includes("/d/"))P=S.split("/d/")[1].split("/")[0];else if(S.includes("id="))P=S.split("id=")[1].split("&")[0];else{const $=S.match(/[-\w]{25,}/);$&&(P=$[0])}if(P)return`https://drive.google.com/thumbnail?id=${P}&sz=w1000`}return S}catch(P){return console.error("Error parsing image URL:",P),S}},D=S=>{var X;const P=S.target,$=P.src;if($.includes("drive.google.com")){const je=(X=$.split("id=")[1])==null?void 0:X.split("&")[0];if(je){P.src=`https://drive.google.com/uc?export=view&id=${je}`;return}}if($.includes("onedrive.live.com")||$.includes("1drv.ms")){const je=$.replace("download?","redir?");P.src=je;return}P.src="/AE logo.svg"},W=j?e:e.filter(S=>S.is_visible),de={hidden:{opacity:0,y:100},visible:{opacity:1,y:0,transition:{duration:.8,ease:"easeOut",staggerChildren:.2}}},ne={hidden:{opacity:0,y:50},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}};return i.jsxs("section",{ref:y,id:"gallery",className:"py-12 sm:py-16 md:py-20 px-4 md:px-8 lg:px-12 bg-gray-950 relative overflow-hidden min-h-screen scroll-container",children:[i.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/50 via-black/80 to-black/95"}),i.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-blue-500/10 via-transparent to-transparent animate-pulse"}),i.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-purple-500/10 via-transparent to-transparent animate-pulse",style:{animationDelay:"1s"}}),i.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-pink-500/10 via-transparent to-transparent animate-pulse",style:{animationDelay:"2s"}})]}),i.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[i.jsx(z.h2,{variants:ne,className:"text-4xl sm:text-5xl md:text-6xl font-bold text-white mb-10 sm:mb-14 text-center",children:""}),j&&i.jsx(z.div,{variants:ne,className:"flex justify-end mb-8 sm:mb-10",children:i.jsxs(z.button,{whileHover:{scale:1.05,boxShadow:"0 0 20px rgba(59, 130, 246, 0.5)"},whileTap:{scale:.95},onClick:E,className:"flex items-center gap-3 px-6 sm:px-8 py-3 sm:py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-all duration-200 text-base sm:text-lg",children:[i.jsx($c,{className:"text-lg sm:text-xl"}),"   "]})}),W.length===0?i.jsx(z.div,{variants:ne,className:"text-center text-gray-400 py-12 text-xl sm:text-2xl",children:j?"   ":"        "}):i.jsx(z.div,{variants:de,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 lg:gap-10 scroll-container",style:{willChange:"transform",transform:"translateZ(0)",backfaceVisibility:"hidden",perspective:"1000px"},children:i.jsx(tr,{mode:"sync",children:W.map(S=>i.jsxs(z.div,{variants:ne,initial:"hidden",animate:"visible",exit:"hidden",whileHover:{scale:1.02,boxShadow:"0 0 30px rgba(59, 130, 246, 0.2)"},onHoverStart:()=>c(S.id),onHoverEnd:()=>c(null),className:"bg-gray-800/50 backdrop-blur-sm rounded-xl overflow-hidden shadow-lg transform transition-all duration-300 border border-gray-700/50 hover:border-blue-500/50",children:[i.jsx("div",{className:"relative aspect-video group",children:S.type==="image"?i.jsx(z.img,{src:A(S.url),alt:S.title,className:"w-full h-full object-cover",whileHover:{scale:1.1},transition:{duration:.3},onError:D,loading:"lazy"}):i.jsx("div",{className:"relative w-full h-full",children:S.url.includes("youtube.com")||S.url.includes("youtu.be")||S.url.includes("vimeo.com")||S.url.includes("aparat.com")?i.jsx(i.Fragment,{children:S.url.includes("aparat.com")&&h[S.id]?i.jsxs("div",{className:"relative w-full h-full",children:[i.jsx("img",{src:h[S.id].big_poster,alt:h[S.id].title,className:"w-full h-full object-cover"}),i.jsx(z.button,{initial:{opacity:0},animate:{opacity:l===S.id?1:0},onClick:()=>window.open(S.url,"_blank"),className:"absolute inset-0 flex items-center justify-center bg-black/50 text-white text-5xl hover:bg-black/60 transition-colors duration-200 backdrop-blur-sm",children:i.jsx(ii,{className:"transform hover:scale-110 transition-transform duration-200"})})]}):i.jsx("iframe",{src:q(S.url),className:"w-full h-full",allowFullScreen:!0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",frameBorder:"0",loading:"lazy"})}):i.jsxs(i.Fragment,{children:[i.jsx("video",{ref:P=>x.current[S.id]=P,src:S.url,className:"w-full h-full object-cover",loop:!0,muted:!0,playsInline:!0,onLoadedData:()=>{const P=x.current[S.id];P&&(P.currentTime=0)}}),i.jsx(z.button,{initial:{opacity:0},animate:{opacity:l===S.id?1:0},onClick:()=>w(S.id),className:"absolute inset-0 flex items-center justify-center bg-black/50 text-white text-5xl hover:bg-black/60 transition-colors duration-200 backdrop-blur-sm",children:d.has(S.id)?i.jsx(Mc,{className:"transform hover:scale-110 transition-transform duration-200"}):i.jsx(ii,{className:"transform hover:scale-110 transition-transform duration-200"})})]})})}),i.jsxs("div",{className:"p-6 sm:p-8",children:[i.jsx(z.h3,{initial:{opacity:0},animate:{opacity:1},className:"text-2xl sm:text-3xl font-bold text-white mb-3 sm:mb-4",children:S.title}),i.jsx(z.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-gray-300 leading-relaxed text-base sm:text-lg",children:S.description})]}),j&&i.jsxs(z.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 sm:p-6 border-t border-gray-700/50 flex justify-end gap-3 sm:gap-4 bg-gray-900/50 backdrop-blur-sm",children:[i.jsx(z.button,{whileHover:{scale:1.1,color:"#60A5FA"},whileTap:{scale:.9},onClick:()=>J(S),className:"p-2 sm:p-3 text-blue-400 hover:text-blue-300 transition-colors duration-200",children:i.jsx(Lc,{className:"text-xl sm:text-2xl"})}),i.jsx(z.button,{whileHover:{scale:1.1,color:"#FCD34D"},whileTap:{scale:.9},onClick:()=>Y(S.id,S.is_visible),className:"p-2 sm:p-3 text-yellow-400 hover:text-yellow-300 transition-colors duration-200",children:S.is_visible?i.jsx(Pc,{className:"text-xl sm:text-2xl"}):i.jsx(Dc,{className:"text-xl sm:text-2xl"})}),i.jsx(z.button,{whileHover:{scale:1.1,color:"#F87171"},whileTap:{scale:.9},onClick:()=>N(S.id),className:"p-2 sm:p-3 text-red-400 hover:text-red-300 transition-colors duration-200",children:i.jsx(qc,{className:"text-xl sm:text-2xl"})})]})]},S.id))})})]}),s&&i.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:i.jsxs(z.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-gray-900 rounded-xl p-6 sm:p-8 max-w-lg w-full shadow-2xl border border-gray-700",children:[i.jsx("h3",{className:"text-2xl sm:text-3xl font-bold mb-8 text-white text-center",children:a?" ":"  "}),i.jsxs("form",{onSubmit:ce,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-3 text-right text-base sm:text-lg",children:" "}),i.jsxs("select",{value:F.type,onChange:S=>Q("type",S.target.value),className:"w-full bg-gray-800 text-white rounded-lg p-3 sm:p-4 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200 text-base sm:text-lg",children:[i.jsx("option",{value:"image",children:""}),i.jsx("option",{value:"video",children:""})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-3 text-right text-base sm:text-lg",children:""}),i.jsx("input",{type:"text",value:F.url,onChange:S=>Q("url",S.target.value),className:"w-full bg-gray-800 text-white rounded-lg p-3 sm:p-4 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200 text-base sm:text-lg",placeholder:F.type==="image"?" ":"  (YouTube  Vimeo)",dir:"ltr",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-3 text-right text-base sm:text-lg",children:""}),i.jsx("input",{type:"text",value:F.title,onChange:S=>Q("title",S.target.value),className:"w-full bg-gray-800 text-white rounded-lg p-3 sm:p-4 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200 text-base sm:text-lg",placeholder:"  ",dir:"rtl",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-3 text-right text-base sm:text-lg",children:""}),i.jsx("textarea",{value:F.description,onChange:S=>Q("description",S.target.value),className:"w-full bg-gray-800 text-white rounded-lg p-3 sm:p-4 border border-gray-700 focus:border-blue-500 focus:ring-2 focus:ring-blue-500 transition-all duration-200 resize-none text-base sm:text-lg",rows:4,placeholder:"  ",dir:"rtl",required:!0})]}),i.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[i.jsx("button",{type:"button",onClick:U,className:"px-6 sm:px-8 py-3 sm:py-4 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 text-base sm:text-lg",children:""}),i.jsx("button",{type:"submit",className:"px-6 sm:px-8 py-3 sm:py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-500 transition-colors duration-200 text-base sm:text-lg",children:a?"":""})]})]})]})})]})}const Kc=({status:r})=>{const e=n=>{switch(n){case"in_progress":return{text:"  ",bgColor:"bg-yellow-500"};case"released":return{text:" ",bgColor:"bg-green-500"};case"coming_soon":return{text:" ",bgColor:"bg-blue-500"};default:return{text:"",bgColor:""}}},{text:t,bgColor:s}=e(r);return t?i.jsx("span",{className:`absolute top-4 left-4 ${s} text-xs font-bold text-white px-2 py-1 rounded-full`,children:t}):null},ca=({game:r})=>i.jsxs("div",{className:"relative",children:[i.jsx(Kc,{status:r.status}),i.jsx(z.div,{whileHover:{scale:1.03,boxShadow:"0 10px 20px rgba(0,0,0,0.3)"},transition:{type:"spring",stiffness:300},children:i.jsx(ge,{to:`/games/${r.slug}`,children:i.jsx("img",{src:r.image_icon,alt:r.title,className:"rounded-2xl w-full h-auto object-cover"})})})]});var Tr=r=>r.type==="checkbox",Et=r=>r instanceof Date,Ce=r=>r==null;const da=r=>typeof r=="object";var ye=r=>!Ce(r)&&!Array.isArray(r)&&da(r)&&!Et(r),Jc=r=>ye(r)&&r.target?Tr(r.target)?r.target.checked:r.target.value:r,Yc=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,Xc=(r,e)=>r.has(Yc(e)),Qc=r=>{const e=r.constructor&&r.constructor.prototype;return ye(e)&&e.hasOwnProperty("isPrototypeOf")},dn=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function pe(r){let e;const t=Array.isArray(r),s=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)e=new Date(r);else if(r instanceof Set)e=new Set(r);else if(!(dn&&(r instanceof Blob||s))&&(t||ye(r)))if(e=t?[]:{},!t&&!Qc(r))e=r;else for(const n in r)r.hasOwnProperty(n)&&(e[n]=pe(r[n]));else return r;return e}var Cr=r=>Array.isArray(r)?r.filter(Boolean):[],fe=r=>r===void 0,B=(r,e,t)=>{if(!e||!ye(r))return t;const s=Cr(e.split(/[,[\].]+?/)).reduce((n,a)=>Ce(n)?n:n[a],r);return fe(s)||s===r?fe(r[e])?t:r[e]:s},Qe=r=>typeof r=="boolean",un=r=>/^\w*$/.test(r),ua=r=>Cr(r.replace(/["|']|\]/g,"").split(/\.|\[/)),ae=(r,e,t)=>{let s=-1;const n=un(e)?[e]:ua(e),a=n.length,o=a-1;for(;++s<a;){const l=n[s];let c=t;if(s!==o){const d=r[l];c=ye(d)||Array.isArray(d)?d:isNaN(+n[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;r[l]=c,r=r[l]}};const ai={BLUR:"blur",FOCUS_OUT:"focusout"},Fe={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},nt={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Zc=K.createContext(null),ed=()=>K.useContext(Zc);var td=(r,e,t,s=!0)=>{const n={defaultValues:e._defaultValues};for(const a in r)Object.defineProperty(n,a,{get:()=>{const o=a;return e._proxyFormState[o]!==Fe.all&&(e._proxyFormState[o]=!s||Fe.all),r[o]}});return n};const rd=typeof window<"u"?b.useLayoutEffect:b.useEffect;var Ze=r=>typeof r=="string",sd=(r,e,t,s,n)=>Ze(r)?(s&&e.watch.add(r),B(t,r,n)):Array.isArray(r)?r.map(a=>(s&&e.watch.add(a),B(t,a))):(s&&(e.watchAll=!0),t),nd=(r,e,t,s,n)=>e?{...t[r],types:{...t[r]&&t[r].types?t[r].types:{},[s]:n||!0}}:{},Pe=r=>Array.isArray(r)?r:[r],oi=()=>{let r=[];return{get observers(){return r},next:n=>{for(const a of r)a.next&&a.next(n)},subscribe:n=>(r.push(n),{unsubscribe:()=>{r=r.filter(a=>a!==n)}}),unsubscribe:()=>{r=[]}}},Js=r=>Ce(r)||!da(r);function pt(r,e){if(Js(r)||Js(e))return r===e;if(Et(r)&&Et(e))return r.getTime()===e.getTime();const t=Object.keys(r),s=Object.keys(e);if(t.length!==s.length)return!1;for(const n of t){const a=r[n];if(!s.includes(n))return!1;if(n!=="ref"){const o=e[n];if(Et(a)&&Et(o)||ye(a)&&ye(o)||Array.isArray(a)&&Array.isArray(o)?!pt(a,o):a!==o)return!1}}return!0}var Te=r=>ye(r)&&!Object.keys(r).length,hn=r=>r.type==="file",We=r=>typeof r=="function",Zr=r=>{if(!dn)return!1;const e=r?r.ownerDocument:0;return r instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},ha=r=>r.type==="select-multiple",fn=r=>r.type==="radio",id=r=>fn(r)||Tr(r),gs=r=>Zr(r)&&r.isConnected;function ad(r,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)r=fe(r)?s++:r[e[s++]];return r}function od(r){for(const e in r)if(r.hasOwnProperty(e)&&!fe(r[e]))return!1;return!0}function xe(r,e){const t=Array.isArray(e)?e:un(e)?[e]:ua(e),s=t.length===1?r:ad(r,t),n=t.length-1,a=t[n];return s&&delete s[a],n!==0&&(ye(s)&&Te(s)||Array.isArray(s)&&od(s))&&xe(r,t.slice(0,-1)),r}var fa=r=>{for(const e in r)if(We(r[e]))return!0;return!1};function es(r,e={}){const t=Array.isArray(r);if(ye(r)||t)for(const s in r)Array.isArray(r[s])||ye(r[s])&&!fa(r[s])?(e[s]=Array.isArray(r[s])?[]:{},es(r[s],e[s])):Ce(r[s])||(e[s]=!0);return e}function ma(r,e,t){const s=Array.isArray(r);if(ye(r)||s)for(const n in r)Array.isArray(r[n])||ye(r[n])&&!fa(r[n])?fe(e)||Js(t[n])?t[n]=Array.isArray(r[n])?es(r[n],[]):{...es(r[n])}:ma(r[n],Ce(e)?{}:e[n],t[n]):t[n]=!pt(r[n],e[n]);return t}var hr=(r,e)=>ma(r,e,es(e));const li={value:!1,isValid:!1},ci={value:!0,isValid:!0};var ga=r=>{if(Array.isArray(r)){if(r.length>1){const e=r.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!fe(r[0].attributes.value)?fe(r[0].value)||r[0].value===""?ci:{value:r[0].value,isValid:!0}:ci:li}return li},pa=(r,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>fe(r)?r:e?r===""?NaN:r&&+r:t&&Ze(r)?new Date(r):s?s(r):r;const di={isValid:!1,value:null};var ya=r=>Array.isArray(r)?r.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,di):di;function ui(r){const e=r.ref;return hn(e)?e.files:fn(e)?ya(r.refs).value:ha(e)?[...e.selectedOptions].map(({value:t})=>t):Tr(e)?ga(r.refs).value:pa(fe(e.value)?r.ref.value:e.value,r)}var ld=(r,e,t,s)=>{const n={};for(const a of r){const o=B(e,a);o&&ae(n,a,o._f)}return{criteriaMode:t,names:[...r],fields:n,shouldUseNativeValidation:s}},ts=r=>r instanceof RegExp,fr=r=>fe(r)?r:ts(r)?r.source:ye(r)?ts(r.value)?r.value.source:r.value:r,Jt=r=>({isOnSubmit:!r||r===Fe.onSubmit,isOnBlur:r===Fe.onBlur,isOnChange:r===Fe.onChange,isOnAll:r===Fe.all,isOnTouch:r===Fe.onTouched});const hi="AsyncFunction";var cd=r=>!!r&&!!r.validate&&!!(We(r.validate)&&r.validate.constructor.name===hi||ye(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===hi)),dd=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),Ys=(r,e,t)=>!t&&(e.watchAll||e.watch.has(r)||[...e.watch].some(s=>r.startsWith(s)&&/^\.\w+/.test(r.slice(s.length))));const Xt=(r,e,t,s)=>{for(const n of t||Object.keys(r)){const a=B(r,n);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],n)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(Xt(l,e))break}else if(ye(l)&&Xt(l,e))break}}};function fi(r,e,t){const s=B(r,t);if(s||un(t))return{error:s,name:t};const n=t.split(".");for(;n.length;){const a=n.join("."),o=B(e,a),l=B(r,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};n.pop()}return{name:t}}var ud=(r,e,t,s)=>{t(r);const{name:n,...a}=r;return Te(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!s||Fe.all))},hd=(r,e,t)=>!r||!e||r===e||Pe(r).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),fd=(r,e,t,s,n)=>n.isOnAll?!1:!t&&n.isOnTouch?!(e||r):(t?s.isOnBlur:n.isOnBlur)?!r:(t?s.isOnChange:n.isOnChange)?r:!0,md=(r,e)=>!Cr(B(r,e)).length&&xe(r,e),xa=(r,e,t)=>{const s=Pe(B(r,t));return ae(s,"root",e[t]),ae(r,t,s),r},Wr=r=>Ze(r);function mi(r,e,t="validate"){if(Wr(r)||Array.isArray(r)&&r.every(Wr)||Qe(r)&&!r)return{type:t,message:Wr(r)?r:"",ref:e}}var Wt=r=>ye(r)&&!ts(r)?r:{value:r,message:""},Xs=async(r,e,t,s,n,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:u,min:h,max:f,pattern:m,validate:x,name:y,valueAsNumber:_,mount:F}=r._f,T=B(t,y);if(!F||e.has(y))return{};const j=l?l[0]:o,R=N=>{n&&j.reportValidity&&(j.setCustomValidity(Qe(N)?"":N||""),j.reportValidity())},I={},w=fn(o),E=Tr(o),U=w||E,J=(_||hn(o))&&fe(o.value)&&fe(T)||Zr(o)&&o.value===""||T===""||Array.isArray(T)&&!T.length,ce=nd.bind(null,y,s,I),Q=(N,Y,q,A=nt.maxLength,D=nt.minLength)=>{const W=N?Y:q;I[y]={type:N?A:D,message:W,ref:o,...ce(N?A:D,W)}};if(a?!Array.isArray(T)||!T.length:c&&(!U&&(J||Ce(T))||Qe(T)&&!T||E&&!ga(l).isValid||w&&!ya(l).isValid)){const{value:N,message:Y}=Wr(c)?{value:!!c,message:c}:Wt(c);if(N&&(I[y]={type:nt.required,message:Y,ref:j,...ce(nt.required,Y)},!s))return R(Y),I}if(!J&&(!Ce(h)||!Ce(f))){let N,Y;const q=Wt(f),A=Wt(h);if(!Ce(T)&&!isNaN(T)){const D=o.valueAsNumber||T&&+T;Ce(q.value)||(N=D>q.value),Ce(A.value)||(Y=D<A.value)}else{const D=o.valueAsDate||new Date(T),W=S=>new Date(new Date().toDateString()+" "+S),de=o.type=="time",ne=o.type=="week";Ze(q.value)&&T&&(N=de?W(T)>W(q.value):ne?T>q.value:D>new Date(q.value)),Ze(A.value)&&T&&(Y=de?W(T)<W(A.value):ne?T<A.value:D<new Date(A.value))}if((N||Y)&&(Q(!!N,q.message,A.message,nt.max,nt.min),!s))return R(I[y].message),I}if((d||u)&&!J&&(Ze(T)||a&&Array.isArray(T))){const N=Wt(d),Y=Wt(u),q=!Ce(N.value)&&T.length>+N.value,A=!Ce(Y.value)&&T.length<+Y.value;if((q||A)&&(Q(q,N.message,Y.message),!s))return R(I[y].message),I}if(m&&!J&&Ze(T)){const{value:N,message:Y}=Wt(m);if(ts(N)&&!T.match(N)&&(I[y]={type:nt.pattern,message:Y,ref:o,...ce(nt.pattern,Y)},!s))return R(Y),I}if(x){if(We(x)){const N=await x(T,t),Y=mi(N,j);if(Y&&(I[y]={...Y,...ce(nt.validate,Y.message)},!s))return R(Y.message),I}else if(ye(x)){let N={};for(const Y in x){if(!Te(N)&&!s)break;const q=mi(await x[Y](T,t),j,Y);q&&(N={...q,...ce(Y,q.message)},R(q.message),s&&(I[y]=N))}if(!Te(N)&&(I[y]={ref:j,...N},!s))return I}}return R(!0),I};const gd={mode:Fe.onSubmit,reValidateMode:Fe.onChange,shouldFocusError:!0};function pd(r={}){let e={...gd,...r},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:We(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const s={};let n=ye(e.defaultValues)||ye(e.values)?pe(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:pe(n),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...u};const f={array:oi(),state:oi()},m=e.criteriaMode===Fe.all,x=g=>v=>{clearTimeout(d),d=setTimeout(g,v)},y=async g=>{if(!e.disabled&&(u.isValid||h.isValid||g)){const v=e.resolver?Te((await E()).errors):await J(s,!0);v!==t.isValid&&f.state.next({isValid:v})}},_=(g,v)=>{!e.disabled&&(u.isValidating||u.validatingFields||h.isValidating||h.validatingFields)&&((g||Array.from(l.mount)).forEach(k=>{k&&(v?ae(t.validatingFields,k,v):xe(t.validatingFields,k))}),f.state.next({validatingFields:t.validatingFields,isValidating:!Te(t.validatingFields)}))},F=(g,v=[],k,M,L=!0,C=!0)=>{if(M&&k&&!e.disabled){if(o.action=!0,C&&Array.isArray(B(s,g))){const V=k(B(s,g),M.argA,M.argB);L&&ae(s,g,V)}if(C&&Array.isArray(B(t.errors,g))){const V=k(B(t.errors,g),M.argA,M.argB);L&&ae(t.errors,g,V),md(t.errors,g)}if((u.touchedFields||h.touchedFields)&&C&&Array.isArray(B(t.touchedFields,g))){const V=k(B(t.touchedFields,g),M.argA,M.argB);L&&ae(t.touchedFields,g,V)}(u.dirtyFields||h.dirtyFields)&&(t.dirtyFields=hr(n,a)),f.state.next({name:g,isDirty:Q(g,v),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ae(a,g,v)},T=(g,v)=>{ae(t.errors,g,v),f.state.next({errors:t.errors})},j=g=>{t.errors=g,f.state.next({errors:t.errors,isValid:!1})},R=(g,v,k,M)=>{const L=B(s,g);if(L){const C=B(a,g,fe(k)?B(n,g):k);fe(C)||M&&M.defaultChecked||v?ae(a,g,v?C:ui(L._f)):q(g,C),o.mount&&y()}},I=(g,v,k,M,L)=>{let C=!1,V=!1;const re={name:g};if(!e.disabled){if(!k||M){(u.isDirty||h.isDirty)&&(V=t.isDirty,t.isDirty=re.isDirty=Q(),C=V!==re.isDirty);const se=pt(B(n,g),v);V=!!B(t.dirtyFields,g),se?xe(t.dirtyFields,g):ae(t.dirtyFields,g,!0),re.dirtyFields=t.dirtyFields,C=C||(u.dirtyFields||h.dirtyFields)&&V!==!se}if(k){const se=B(t.touchedFields,g);se||(ae(t.touchedFields,g,k),re.touchedFields=t.touchedFields,C=C||(u.touchedFields||h.touchedFields)&&se!==k)}C&&L&&f.state.next(re)}return C?re:{}},w=(g,v,k,M)=>{const L=B(t.errors,g),C=(u.isValid||h.isValid)&&Qe(v)&&t.isValid!==v;if(e.delayError&&k?(c=x(()=>T(g,k)),c(e.delayError)):(clearTimeout(d),c=null,k?ae(t.errors,g,k):xe(t.errors,g)),(k?!pt(L,k):L)||!Te(M)||C){const V={...M,...C&&Qe(v)?{isValid:v}:{},errors:t.errors,name:g};t={...t,...V},f.state.next(V)}},E=async g=>{_(g,!0);const v=await e.resolver(a,e.context,ld(g||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return _(g),v},U=async g=>{const{errors:v}=await E(g);if(g)for(const k of g){const M=B(v,k);M?ae(t.errors,k,M):xe(t.errors,k)}else t.errors=v;return v},J=async(g,v,k={valid:!0})=>{for(const M in g){const L=g[M];if(L){const{_f:C,...V}=L;if(C){const re=l.array.has(C.name),se=L._f&&cd(L._f);se&&u.validatingFields&&_([M],!0);const Ee=await Xs(L,l.disabled,a,m,e.shouldUseNativeValidation&&!v,re);if(se&&u.validatingFields&&_([M]),Ee[C.name]&&(k.valid=!1,v))break;!v&&(B(Ee,C.name)?re?xa(t.errors,Ee,C.name):ae(t.errors,C.name,Ee[C.name]):xe(t.errors,C.name))}!Te(V)&&await J(V,v,k)}}return k.valid},ce=()=>{for(const g of l.unMount){const v=B(s,g);v&&(v._f.refs?v._f.refs.every(k=>!gs(k)):!gs(v._f.ref))&&bt(g)}l.unMount=new Set},Q=(g,v)=>!e.disabled&&(g&&v&&ae(a,g,v),!pt(S(),n)),N=(g,v,k)=>sd(g,l,{...o.mount?a:fe(v)?n:Ze(g)?{[g]:v}:v},k,v),Y=g=>Cr(B(o.mount?a:n,g,e.shouldUnregister?B(n,g,[]):[])),q=(g,v,k={})=>{const M=B(s,g);let L=v;if(M){const C=M._f;C&&(!C.disabled&&ae(a,g,pa(v,C)),L=Zr(C.ref)&&Ce(v)?"":v,ha(C.ref)?[...C.ref.options].forEach(V=>V.selected=L.includes(V.value)):C.refs?Tr(C.ref)?C.refs.forEach(V=>{(!V.defaultChecked||!V.disabled)&&(Array.isArray(L)?V.checked=!!L.find(re=>re===V.value):V.checked=L===V.value||!!L)}):C.refs.forEach(V=>V.checked=V.value===L):hn(C.ref)?C.ref.value="":(C.ref.value=L,C.ref.type||f.state.next({name:g,values:pe(a)})))}(k.shouldDirty||k.shouldTouch)&&I(g,L,k.shouldTouch,k.shouldDirty,!0),k.shouldValidate&&ne(g)},A=(g,v,k)=>{for(const M in v){if(!v.hasOwnProperty(M))return;const L=v[M],C=g+"."+M,V=B(s,C);(l.array.has(g)||ye(L)||V&&!V._f)&&!Et(L)?A(C,L,k):q(C,L,k)}},D=(g,v,k={})=>{const M=B(s,g),L=l.array.has(g),C=pe(v);ae(a,g,C),L?(f.array.next({name:g,values:pe(a)}),(u.isDirty||u.dirtyFields||h.isDirty||h.dirtyFields)&&k.shouldDirty&&f.state.next({name:g,dirtyFields:hr(n,a),isDirty:Q(g,C)})):M&&!M._f&&!Ce(C)?A(g,C,k):q(g,C,k),Ys(g,l)&&f.state.next({...t}),f.state.next({name:o.mount?g:void 0,values:pe(a)})},W=async g=>{o.mount=!0;const v=g.target;let k=v.name,M=!0;const L=B(s,k),C=se=>{M=Number.isNaN(se)||Et(se)&&isNaN(se.getTime())||pt(se,B(a,k,se))},V=Jt(e.mode),re=Jt(e.reValidateMode);if(L){let se,Ee;const ct=v.type?ui(L._f):Jc(g),Be=g.type===ai.BLUR||g.type===ai.FOCUS_OUT,Rt=!dd(L._f)&&!e.resolver&&!B(t.errors,k)&&!L._f.deps||fd(Be,B(t.touchedFields,k),t.isSubmitted,re,V),dt=Ys(k,l,Be);ae(a,k,ct),Be?(L._f.onBlur&&L._f.onBlur(g),c&&c(0)):L._f.onChange&&L._f.onChange(g);const De=I(k,ct,Be),ut=!Te(De)||dt;if(!Be&&f.state.next({name:k,type:g.type,values:pe(a)}),Rt)return(u.isValid||h.isValid)&&(e.mode==="onBlur"?Be&&y():Be||y()),ut&&f.state.next({name:k,...dt?{}:De});if(!Be&&dt&&f.state.next({...t}),e.resolver){const{errors:Lt}=await E([k]);if(C(ct),M){const ar=fi(t.errors,s,k),Ir=fi(Lt,s,ar.name||k);se=Ir.error,k=Ir.name,Ee=Te(Lt)}}else _([k],!0),se=(await Xs(L,l.disabled,a,m,e.shouldUseNativeValidation))[k],_([k]),C(ct),M&&(se?Ee=!1:(u.isValid||h.isValid)&&(Ee=await J(s,!0)));M&&(L._f.deps&&ne(L._f.deps),w(k,Ee,se,De))}},de=(g,v)=>{if(B(t.errors,v)&&g.focus)return g.focus(),1},ne=async(g,v={})=>{let k,M;const L=Pe(g);if(e.resolver){const C=await U(fe(g)?g:L);k=Te(C),M=g?!L.some(V=>B(C,V)):k}else g?(M=(await Promise.all(L.map(async C=>{const V=B(s,C);return await J(V&&V._f?{[C]:V}:V)}))).every(Boolean),!(!M&&!t.isValid)&&y()):M=k=await J(s);return f.state.next({...!Ze(g)||(u.isValid||h.isValid)&&k!==t.isValid?{}:{name:g},...e.resolver||!g?{isValid:k}:{},errors:t.errors}),v.shouldFocus&&!M&&Xt(s,de,g?L:l.mount),M},S=g=>{const v={...o.mount?a:n};return fe(g)?v:Ze(g)?B(v,g):g.map(k=>B(v,k))},P=(g,v)=>({invalid:!!B((v||t).errors,g),isDirty:!!B((v||t).dirtyFields,g),error:B((v||t).errors,g),isValidating:!!B(t.validatingFields,g),isTouched:!!B((v||t).touchedFields,g)}),$=g=>{g&&Pe(g).forEach(v=>xe(t.errors,v)),f.state.next({errors:g?t.errors:{}})},X=(g,v,k)=>{const M=(B(s,g,{_f:{}})._f||{}).ref,L=B(t.errors,g)||{},{ref:C,message:V,type:re,...se}=L;ae(t.errors,g,{...se,...v,ref:M}),f.state.next({name:g,errors:t.errors,isValid:!1}),k&&k.shouldFocus&&M&&M.focus&&M.focus()},je=(g,v)=>We(g)?f.state.subscribe({next:k=>g(N(void 0,v),k)}):N(g,v,!0),ue=g=>f.state.subscribe({next:v=>{hd(g.name,v.name,g.exact)&&ud(v,g.formState||u,lt,g.reRenderRoot)&&g.callback({values:{...a},...t,...v})}}).unsubscribe,vt=g=>(o.mount=!0,h={...h,...g.formState},ue({...g,formState:h})),bt=(g,v={})=>{for(const k of g?Pe(g):l.mount)l.mount.delete(k),l.array.delete(k),v.keepValue||(xe(s,k),xe(a,k)),!v.keepError&&xe(t.errors,k),!v.keepDirty&&xe(t.dirtyFields,k),!v.keepTouched&&xe(t.touchedFields,k),!v.keepIsValidating&&xe(t.validatingFields,k),!e.shouldUnregister&&!v.keepDefaultValue&&xe(n,k);f.state.next({values:pe(a)}),f.state.next({...t,...v.keepDirty?{isDirty:Q()}:{}}),!v.keepIsValid&&y()},sr=({disabled:g,name:v})=>{(Qe(g)&&o.mount||g||l.disabled.has(v))&&(g?l.disabled.add(v):l.disabled.delete(v))},wt=(g,v={})=>{let k=B(s,g);const M=Qe(v.disabled)||Qe(e.disabled);return ae(s,g,{...k||{},_f:{...k&&k._f?k._f:{ref:{name:g}},name:g,mount:!0,...v}}),l.mount.add(g),k?sr({disabled:Qe(v.disabled)?v.disabled:e.disabled,name:g}):R(g,!0,v.value),{...M?{disabled:v.disabled||e.disabled}:{},...e.progressive?{required:!!v.required,min:fr(v.min),max:fr(v.max),minLength:fr(v.minLength),maxLength:fr(v.maxLength),pattern:fr(v.pattern)}:{},name:g,onChange:W,onBlur:W,ref:L=>{if(L){wt(g,v),k=B(s,g);const C=fe(L.value)&&L.querySelectorAll&&L.querySelectorAll("input,select,textarea")[0]||L,V=id(C),re=k._f.refs||[];if(V?re.find(se=>se===C):C===k._f.ref)return;ae(s,g,{_f:{...k._f,...V?{refs:[...re.filter(gs),C,...Array.isArray(B(n,g))?[{}]:[]],ref:{type:C.type,name:g}}:{ref:C}}}),R(g,!1,void 0,C)}else k=B(s,g,{}),k._f&&(k._f.mount=!1),(e.shouldUnregister||v.shouldUnregister)&&!(Xc(l.array,g)&&o.action)&&l.unMount.add(g)}}},Ct=()=>e.shouldFocusError&&Xt(s,de,l.mount),Or=g=>{Qe(g)&&(f.state.next({disabled:g}),Xt(s,(v,k)=>{const M=B(s,k);M&&(v.disabled=M._f.disabled||g,Array.isArray(M._f.refs)&&M._f.refs.forEach(L=>{L.disabled=M._f.disabled||g}))},0,!1))},et=(g,v)=>async k=>{let M;k&&(k.preventDefault&&k.preventDefault(),k.persist&&k.persist());let L=pe(a);if(f.state.next({isSubmitting:!0}),e.resolver){const{errors:C,values:V}=await E();t.errors=C,L=V}else await J(s);if(l.disabled.size)for(const C of l.disabled)ae(L,C,void 0);if(xe(t.errors,"root"),Te(t.errors)){f.state.next({errors:{}});try{await g(L,k)}catch(C){M=C}}else v&&await v({...t.errors},k),Ct(),setTimeout(Ct);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Te(t.errors)&&!M,submitCount:t.submitCount+1,errors:t.errors}),M)throw M},Ot=(g,v={})=>{B(s,g)&&(fe(v.defaultValue)?D(g,pe(B(n,g))):(D(g,v.defaultValue),ae(n,g,pe(v.defaultValue))),v.keepTouched||xe(t.touchedFields,g),v.keepDirty||(xe(t.dirtyFields,g),t.isDirty=v.defaultValue?Q(g,pe(B(n,g))):Q()),v.keepError||(xe(t.errors,g),u.isValid&&y()),f.state.next({...t}))},Je=(g,v={})=>{const k=g?pe(g):n,M=pe(k),L=Te(g),C=L?n:M;if(v.keepDefaultValues||(n=k),!v.keepValues){if(v.keepDirtyValues){const V=new Set([...l.mount,...Object.keys(hr(n,a))]);for(const re of Array.from(V))B(t.dirtyFields,re)?ae(C,re,B(a,re)):D(re,B(C,re))}else{if(dn&&fe(g))for(const V of l.mount){const re=B(s,V);if(re&&re._f){const se=Array.isArray(re._f.refs)?re._f.refs[0]:re._f.ref;if(Zr(se)){const Ee=se.closest("form");if(Ee){Ee.reset();break}}}}for(const V of l.mount)D(V,B(C,V))}a=pe(C),f.array.next({values:{...C}}),f.state.next({values:{...C}})}l={mount:v.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!v.keepIsValid||!!v.keepDirtyValues,o.watch=!!e.shouldUnregister,f.state.next({submitCount:v.keepSubmitCount?t.submitCount:0,isDirty:L?!1:v.keepDirty?t.isDirty:!!(v.keepDefaultValues&&!pt(g,n)),isSubmitted:v.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:L?{}:v.keepDirtyValues?v.keepDefaultValues&&a?hr(n,a):t.dirtyFields:v.keepDefaultValues&&g?hr(n,g):v.keepDirty?t.dirtyFields:{},touchedFields:v.keepTouched?t.touchedFields:{},errors:v.keepErrors?t.errors:{},isSubmitSuccessful:v.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1})},It=(g,v)=>Je(We(g)?g(a):g,v),nr=(g,v={})=>{const k=B(s,g),M=k&&k._f;if(M){const L=M.refs?M.refs[0]:M.ref;L.focus&&(L.focus(),v.shouldSelect&&We(L.select)&&L.select())}},lt=g=>{t={...t,...g}},_t={control:{register:wt,unregister:bt,getFieldState:P,handleSubmit:et,setError:X,_subscribe:ue,_runSchema:E,_focusError:Ct,_getWatch:N,_getDirty:Q,_setValid:y,_setFieldArray:F,_setDisabledField:sr,_setErrors:j,_getFieldArray:Y,_reset:Je,_resetDefaultValues:()=>We(e.defaultValues)&&e.defaultValues().then(g=>{It(g,e.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:ce,_disableForm:Or,_subjects:f,_proxyFormState:u,get _fields(){return s},get _formValues(){return a},get _state(){return o},set _state(g){o=g},get _defaultValues(){return n},get _names(){return l},set _names(g){l=g},get _formState(){return t},get _options(){return e},set _options(g){e={...e,...g}}},subscribe:vt,trigger:ne,register:wt,handleSubmit:et,watch:je,setValue:D,getValues:S,reset:It,resetField:Ot,clearErrors:$,unregister:bt,setError:X,setFocus:nr,getFieldState:P};return{..._t,formControl:_t}}var ht=()=>{const r=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+r)%16|0;return(e=="x"?t:t&3|8).toString(16)})},ps=(r,e,t={})=>t.shouldFocus||fe(t.shouldFocus)?t.focusName||`${r}.${fe(t.focusIndex)?e:t.focusIndex}.`:"",ys=(r,e)=>[...r,...Pe(e)],xs=r=>Array.isArray(r)?r.map(()=>{}):void 0;function vs(r,e,t){return[...r.slice(0,e),...Pe(t),...r.slice(e)]}var bs=(r,e,t)=>Array.isArray(r)?(fe(r[t])&&(r[t]=void 0),r.splice(t,0,r.splice(e,1)[0]),r):[],ws=(r,e)=>[...Pe(e),...Pe(r)];function yd(r,e){let t=0;const s=[...r];for(const n of e)s.splice(n-t,1),t++;return Cr(s).length?s:[]}var _s=(r,e)=>fe(e)?[]:yd(r,Pe(e).sort((t,s)=>t-s)),js=(r,e,t)=>{[r[e],r[t]]=[r[t],r[e]]},gi=(r,e,t)=>(r[e]=t,r);function va(r){const e=ed(),{control:t=e.control,name:s,keyName:n="id",shouldUnregister:a,rules:o}=r,[l,c]=K.useState(t._getFieldArray(s)),d=K.useRef(t._getFieldArray(s).map(ht)),u=K.useRef(l),h=K.useRef(s),f=K.useRef(!1);h.current=s,u.current=l,t._names.array.add(s),o&&t.register(s,o),K.useEffect(()=>t._subjects.array.subscribe({next:({values:w,name:E})=>{if(E===h.current||!E){const U=B(w,h.current);Array.isArray(U)&&(c(U),d.current=U.map(ht))}}}).unsubscribe,[t]);const m=K.useCallback(w=>{f.current=!0,t._setFieldArray(s,w)},[t,s]),x=(w,E)=>{const U=Pe(pe(w)),J=ys(t._getFieldArray(s),U);t._names.focus=ps(s,J.length-1,E),d.current=ys(d.current,U.map(ht)),m(J),c(J),t._setFieldArray(s,J,ys,{argA:xs(w)})},y=(w,E)=>{const U=Pe(pe(w)),J=ws(t._getFieldArray(s),U);t._names.focus=ps(s,0,E),d.current=ws(d.current,U.map(ht)),m(J),c(J),t._setFieldArray(s,J,ws,{argA:xs(w)})},_=w=>{const E=_s(t._getFieldArray(s),w);d.current=_s(d.current,w),m(E),c(E),!Array.isArray(B(t._fields,s))&&ae(t._fields,s,void 0),t._setFieldArray(s,E,_s,{argA:w})},F=(w,E,U)=>{const J=Pe(pe(E)),ce=vs(t._getFieldArray(s),w,J);t._names.focus=ps(s,w,U),d.current=vs(d.current,w,J.map(ht)),m(ce),c(ce),t._setFieldArray(s,ce,vs,{argA:w,argB:xs(E)})},T=(w,E)=>{const U=t._getFieldArray(s);js(U,w,E),js(d.current,w,E),m(U),c(U),t._setFieldArray(s,U,js,{argA:w,argB:E},!1)},j=(w,E)=>{const U=t._getFieldArray(s);bs(U,w,E),bs(d.current,w,E),m(U),c(U),t._setFieldArray(s,U,bs,{argA:w,argB:E},!1)},R=(w,E)=>{const U=pe(E),J=gi(t._getFieldArray(s),w,U);d.current=[...J].map((ce,Q)=>!ce||Q===w?ht():d.current[Q]),m(J),c([...J]),t._setFieldArray(s,J,gi,{argA:w,argB:U},!0,!1)},I=w=>{const E=Pe(pe(w));d.current=E.map(ht),m([...E]),c([...E]),t._setFieldArray(s,[...E],U=>U,{},!0,!1)};return K.useEffect(()=>{if(t._state.action=!1,Ys(s,t._names)&&t._subjects.state.next({...t._formState}),f.current&&(!Jt(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!Jt(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([s]).then(w=>{const E=B(w.errors,s),U=B(t._formState.errors,s);(U?!E&&U.type||E&&(U.type!==E.type||U.message!==E.message):E&&E.type)&&(E?ae(t._formState.errors,s,E):xe(t._formState.errors,s),t._subjects.state.next({errors:t._formState.errors}))});else{const w=B(t._fields,s);w&&w._f&&!(Jt(t._options.reValidateMode).isOnSubmit&&Jt(t._options.mode).isOnSubmit)&&Xs(w,t._names.disabled,t._formValues,t._options.criteriaMode===Fe.all,t._options.shouldUseNativeValidation,!0).then(E=>!Te(E)&&t._subjects.state.next({errors:xa(t._formState.errors,E,s)}))}t._subjects.state.next({name:s,values:pe(t._formValues)}),t._names.focus&&Xt(t._fields,(w,E)=>{if(t._names.focus&&E.startsWith(t._names.focus)&&w.focus)return w.focus(),1}),t._names.focus="",t._setValid(),f.current=!1},[l,s,t]),K.useEffect(()=>(!B(t._formValues,s)&&t._setFieldArray(s),()=>{const w=(E,U)=>{const J=B(t._fields,E);J&&J._f&&(J._f.mount=U)};t._options.shouldUnregister||a?t.unregister(s):w(s,!1)}),[s,t,n,a]),{swap:K.useCallback(T,[m,s,t]),move:K.useCallback(j,[m,s,t]),prepend:K.useCallback(y,[m,s,t]),append:K.useCallback(x,[m,s,t]),remove:K.useCallback(_,[m,s,t]),insert:K.useCallback(F,[m,s,t]),update:K.useCallback(R,[m,s,t]),replace:K.useCallback(I,[m,s,t]),fields:K.useMemo(()=>l.map((w,E)=>({...w,[n]:d.current[E]||ht()})),[l,n])}}function ba(r={}){const e=K.useRef(void 0),t=K.useRef(void 0),[s,n]=K.useState({isDirty:!1,isValidating:!1,isLoading:We(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:We(r.defaultValues)?void 0:r.defaultValues});e.current||(e.current={...r.formControl?r.formControl:pd(r),formState:s},r.formControl&&r.defaultValues&&!We(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions));const a=e.current.control;return a._options=r,rd(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>n({...a._formState}),reRenderRoot:!0});return n(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),K.useEffect(()=>a._disableForm(r.disabled),[a,r.disabled]),K.useEffect(()=>{r.mode&&(a._options.mode=r.mode),r.reValidateMode&&(a._options.reValidateMode=r.reValidateMode)},[a,r.mode,r.reValidateMode]),K.useEffect(()=>{r.errors&&(a._setErrors(r.errors),a._focusError())},[a,r.errors]),K.useEffect(()=>{r.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,r.shouldUnregister]),K.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==s.isDirty&&a._subjects.state.next({isDirty:o})}},[a,s.isDirty]),K.useEffect(()=>{r.values&&!pt(r.values,t.current)?(a._reset(r.values,a._options.resetOptions),t.current=r.values,n(o=>({...o}))):a._resetDefaultValues()},[a,r.values]),K.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=td(s,a),e.current}const xd=({isOpen:r,onClose:e,onSave:t})=>{const[s,n]=b.useState(!1),{register:a,handleSubmit:o,control:l,formState:{errors:c}}=ba({defaultValues:{status:"coming_soon",is_visible:!0,content_blocks:[]}}),{fields:d,append:u,remove:h,move:f}=va({control:l,name:"content_blocks"}),m=async x=>{try{n(!0),await t(x),e()}catch(y){console.error("Error saving game:",y)}finally{n(!1)}};return i.jsx(tr,{children:r&&i.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs(z.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-900 rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6 text-white",children:"  "}),i.jsxs("form",{onSubmit:o(m),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("input",{...a("slug",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("input",{...a("title",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("textarea",{...a("description",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2",rows:3})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:" "}),i.jsx("input",{...a("image_icon",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:" "}),i.jsx("input",{...a("download_url",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsxs("select",{...a("status",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2",children:[i.jsx("option",{value:"in_progress",children:"  "}),i.jsx("option",{value:"released",children:" "}),i.jsx("option",{value:"coming_soon",children:" "})]})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center text-gray-300",children:[i.jsx("input",{type:"checkbox",...a("is_visible"),className:"ml-2"})," "]})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-white",children:" "}),i.jsxs("div",{className:"space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>u({type:"image",src:"",alt:""}),className:"bg-blue-500 text-white px-3 py-1 rounded-lg text-sm",children:" "}),i.jsx("button",{type:"button",onClick:()=>u({type:"video",src:"",caption:""}),className:"bg-green-500 text-white px-3 py-1 rounded-lg text-sm",children:" "}),i.jsx("button",{type:"button",onClick:()=>u({type:"text",content:""}),className:"bg-purple-500 text-white px-3 py-1 rounded-lg text-sm",children:" "})]})]}),i.jsx("div",{className:"space-y-4",children:d.map((x,y)=>i.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("select",{...a(`content_blocks.${y}.type`),className:"bg-gray-700 text-white rounded-lg p-2",children:[i.jsx("option",{value:"image",children:""}),i.jsx("option",{value:"video",children:""}),i.jsx("option",{value:"text",children:""})]}),i.jsxs("div",{className:"space-x-2",children:[y>0&&i.jsx("button",{type:"button",onClick:()=>f(y,y-1),className:"text-gray-300 hover:text-white",children:""}),y<d.length-1&&i.jsx("button",{type:"button",onClick:()=>f(y,y+1),className:"text-gray-300 hover:text-white",children:""}),i.jsx("button",{type:"button",onClick:()=>h(y),className:"text-red-500 hover:text-red-400",children:""})]})]}),x.type==="image"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{...a(`content_blocks.${y}.src`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2 mb-2"}),i.jsx("input",{...a(`content_blocks.${y}.alt`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2"})]}),x.type==="video"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{...a(`content_blocks.${y}.src`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2 mb-2"}),i.jsx("input",{...a(`content_blocks.${y}.caption`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2"})]}),x.type==="text"&&i.jsx("textarea",{...a(`content_blocks.${y}.content`),placeholder:"",className:"w-full bg-gray-700 text-white rounded-lg p-2",rows:3})]},x.id))})]}),i.jsxs("div",{className:"flex justify-end space-x-4",children:[i.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-300 hover:text-white",children:""}),i.jsx("button",{type:"submit",disabled:s,className:"bg-[#F4B744] text-black font-bold px-6 py-2 rounded-lg hover:bg-[#E5A93D] disabled:opacity-50",children:s?"  ...":" "})]})]})]})})})};var ks,pi;function vd(){if(pi)return ks;pi=1;var r=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",s=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function n(a,o){if(a===o)return!0;if(a&&o&&typeof a=="object"&&typeof o=="object"){if(a.constructor!==o.constructor)return!1;var l,c,d;if(Array.isArray(a)){if(l=a.length,l!=o.length)return!1;for(c=l;c--!==0;)if(!n(a[c],o[c]))return!1;return!0}var u;if(e&&a instanceof Map&&o instanceof Map){if(a.size!==o.size)return!1;for(u=a.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;for(u=a.entries();!(c=u.next()).done;)if(!n(c.value[1],o.get(c.value[0])))return!1;return!0}if(t&&a instanceof Set&&o instanceof Set){if(a.size!==o.size)return!1;for(u=a.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(a)&&ArrayBuffer.isView(o)){if(l=a.length,l!=o.length)return!1;for(c=l;c--!==0;)if(a[c]!==o[c])return!1;return!0}if(a.constructor===RegExp)return a.source===o.source&&a.flags===o.flags;if(a.valueOf!==Object.prototype.valueOf&&typeof a.valueOf=="function"&&typeof o.valueOf=="function")return a.valueOf()===o.valueOf();if(a.toString!==Object.prototype.toString&&typeof a.toString=="function"&&typeof o.toString=="function")return a.toString()===o.toString();if(d=Object.keys(a),l=d.length,l!==Object.keys(o).length)return!1;for(c=l;c--!==0;)if(!Object.prototype.hasOwnProperty.call(o,d[c]))return!1;if(r&&a instanceof Element)return!1;for(c=l;c--!==0;)if(!((d[c]==="_owner"||d[c]==="__v"||d[c]==="__o")&&a.$$typeof)&&!n(a[d[c]],o[d[c]]))return!1;return!0}return a!==a&&o!==o}return ks=function(o,l){try{return n(o,l)}catch(c){if((c.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw c}},ks}var bd=vd();const wd=ss(bd);var As,yi;function _d(){if(yi)return As;yi=1;var r=function(e,t,s,n,a,o,l,c){if(!e){var d;if(t===void 0)d=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[s,n,a,o,l,c],h=0;d=new Error(t.replace(/%s/g,function(){return u[h++]})),d.name="Invariant Violation"}throw d.framesToPop=1,d}};return As=r,As}var jd=_d();const xi=ss(jd);var Es,vi;function kd(){return vi||(vi=1,Es=function(e,t,s,n){var a=s?s.call(n,e,t):void 0;if(a!==void 0)return!!a;if(e===t)return!0;if(typeof e!="object"||!e||typeof t!="object"||!t)return!1;var o=Object.keys(e),l=Object.keys(t);if(o.length!==l.length)return!1;for(var c=Object.prototype.hasOwnProperty.bind(t),d=0;d<o.length;d++){var u=o[d];if(!c(u))return!1;var h=e[u],f=t[u];if(a=s?s.call(n,h,f,u):void 0,a===!1||a===void 0&&h!==f)return!1}return!0}),Es}var Ad=kd();const Ed=ss(Ad);var wa=(r=>(r.BASE="base",r.BODY="body",r.HEAD="head",r.HTML="html",r.LINK="link",r.META="meta",r.NOSCRIPT="noscript",r.SCRIPT="script",r.STYLE="style",r.TITLE="title",r.FRAGMENT="Symbol(react.fragment)",r))(wa||{}),Ss={link:{rel:["amphtml","canonical","alternate"]},script:{type:["application/ld+json"]},meta:{charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]}},bi=Object.values(wa),mn={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Sd=Object.entries(mn).reduce((r,[e,t])=>(r[t]=e,r),{}),Ge="data-rh",Qt={DEFAULT_TITLE:"defaultTitle",DEFER:"defer",ENCODE_SPECIAL_CHARACTERS:"encodeSpecialCharacters",ON_CHANGE_CLIENT_STATE:"onChangeClientState",TITLE_TEMPLATE:"titleTemplate",PRIORITIZE_SEO_TAGS:"prioritizeSeoTags"},Zt=(r,e)=>{for(let t=r.length-1;t>=0;t-=1){const s=r[t];if(Object.prototype.hasOwnProperty.call(s,e))return s[e]}return null},Nd=r=>{let e=Zt(r,"title");const t=Zt(r,Qt.TITLE_TEMPLATE);if(Array.isArray(e)&&(e=e.join("")),t&&e)return t.replace(/%s/g,()=>e);const s=Zt(r,Qt.DEFAULT_TITLE);return e||s||void 0},Td=r=>Zt(r,Qt.ON_CHANGE_CLIENT_STATE)||(()=>{}),Ns=(r,e)=>e.filter(t=>typeof t[r]<"u").map(t=>t[r]).reduce((t,s)=>({...t,...s}),{}),Cd=(r,e)=>e.filter(t=>typeof t.base<"u").map(t=>t.base).reverse().reduce((t,s)=>{if(!t.length){const n=Object.keys(s);for(let a=0;a<n.length;a+=1){const l=n[a].toLowerCase();if(r.indexOf(l)!==-1&&s[l])return t.concat(s)}}return t},[]),Od=r=>console&&typeof console.warn=="function"&&console.warn(r),mr=(r,e,t)=>{const s={};return t.filter(n=>Array.isArray(n[r])?!0:(typeof n[r]<"u"&&Od(`Helmet: ${r} should be of type "Array". Instead found type "${typeof n[r]}"`),!1)).map(n=>n[r]).reverse().reduce((n,a)=>{const o={};a.filter(c=>{let d;const u=Object.keys(c);for(let f=0;f<u.length;f+=1){const m=u[f],x=m.toLowerCase();e.indexOf(x)!==-1&&!(d==="rel"&&c[d].toLowerCase()==="canonical")&&!(x==="rel"&&c[x].toLowerCase()==="stylesheet")&&(d=x),e.indexOf(m)!==-1&&(m==="innerHTML"||m==="cssText"||m==="itemprop")&&(d=m)}if(!d||!c[d])return!1;const h=c[d].toLowerCase();return s[d]||(s[d]={}),o[d]||(o[d]={}),s[d][h]?!1:(o[d][h]=!0,!0)}).reverse().forEach(c=>n.push(c));const l=Object.keys(o);for(let c=0;c<l.length;c+=1){const d=l[c],u={...s[d],...o[d]};s[d]=u}return n},[]).reverse()},Id=(r,e)=>{if(Array.isArray(r)&&r.length){for(let t=0;t<r.length;t+=1)if(r[t][e])return!0}return!1},Rd=r=>({baseTag:Cd(["href"],r),bodyAttributes:Ns("bodyAttributes",r),defer:Zt(r,Qt.DEFER),encode:Zt(r,Qt.ENCODE_SPECIAL_CHARACTERS),htmlAttributes:Ns("htmlAttributes",r),linkTags:mr("link",["rel","href"],r),metaTags:mr("meta",["name","charset","http-equiv","property","itemprop"],r),noscriptTags:mr("noscript",["innerHTML"],r),onChangeClientState:Td(r),scriptTags:mr("script",["src","innerHTML"],r),styleTags:mr("style",["cssText"],r),title:Nd(r),titleAttributes:Ns("titleAttributes",r),prioritizeSeoTags:Id(r,Qt.PRIORITIZE_SEO_TAGS)}),_a=r=>Array.isArray(r)?r.join(""):r,Ld=(r,e)=>{const t=Object.keys(r);for(let s=0;s<t.length;s+=1)if(e[t[s]]&&e[t[s]].includes(r[t[s]]))return!0;return!1},Ts=(r,e)=>Array.isArray(r)?r.reduce((t,s)=>(Ld(s,e)?t.priority.push(s):t.default.push(s),t),{priority:[],default:[]}):{default:r,priority:[]},wi=(r,e)=>({...r,[e]:void 0}),Pd=["noscript","script","style"],Qs=(r,e=!0)=>e===!1?String(r):String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),ja=r=>Object.keys(r).reduce((e,t)=>{const s=typeof r[t]<"u"?`${t}="${r[t]}"`:`${t}`;return e?`${e} ${s}`:s},""),Dd=(r,e,t,s)=>{const n=ja(t),a=_a(e);return n?`<${r} ${Ge}="true" ${n}>${Qs(a,s)}</${r}>`:`<${r} ${Ge}="true">${Qs(a,s)}</${r}>`},Md=(r,e,t=!0)=>e.reduce((s,n)=>{const a=n,o=Object.keys(a).filter(d=>!(d==="innerHTML"||d==="cssText")).reduce((d,u)=>{const h=typeof a[u]>"u"?u:`${u}="${Qs(a[u],t)}"`;return d?`${d} ${h}`:h},""),l=a.innerHTML||a.cssText||"",c=Pd.indexOf(r)===-1;return`${s}<${r} ${Ge}="true" ${o}${c?"/>":`>${l}</${r}>`}`},""),ka=(r,e={})=>Object.keys(r).reduce((t,s)=>{const n=mn[s];return t[n||s]=r[s],t},e),$d=(r,e,t)=>{const s={key:e,[Ge]:!0},n=ka(t,s);return[K.createElement("title",n,e)]},Gr=(r,e)=>e.map((t,s)=>{const n={key:s,[Ge]:!0};return Object.keys(t).forEach(a=>{const l=mn[a]||a;if(l==="innerHTML"||l==="cssText"){const c=t.innerHTML||t.cssText;n.dangerouslySetInnerHTML={__html:c}}else n[l]=t[a]}),K.createElement(r,n)}),$e=(r,e,t=!0)=>{switch(r){case"title":return{toComponent:()=>$d(r,e.title,e.titleAttributes),toString:()=>Dd(r,e.title,e.titleAttributes,t)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>ka(e),toString:()=>ja(e)};default:return{toComponent:()=>Gr(r,e),toString:()=>Md(r,e,t)}}},Fd=({metaTags:r,linkTags:e,scriptTags:t,encode:s})=>{const n=Ts(r,Ss.meta),a=Ts(e,Ss.link),o=Ts(t,Ss.script);return{priorityMethods:{toComponent:()=>[...Gr("meta",n.priority),...Gr("link",a.priority),...Gr("script",o.priority)],toString:()=>`${$e("meta",n.priority,s)} ${$e("link",a.priority,s)} ${$e("script",o.priority,s)}`},metaTags:n.default,linkTags:a.default,scriptTags:o.default}},Ud=r=>{const{baseTag:e,bodyAttributes:t,encode:s=!0,htmlAttributes:n,noscriptTags:a,styleTags:o,title:l="",titleAttributes:c,prioritizeSeoTags:d}=r;let{linkTags:u,metaTags:h,scriptTags:f}=r,m={toComponent:()=>{},toString:()=>""};return d&&({priorityMethods:m,linkTags:u,metaTags:h,scriptTags:f}=Fd(r)),{priority:m,base:$e("base",e,s),bodyAttributes:$e("bodyAttributes",t,s),htmlAttributes:$e("htmlAttributes",n,s),link:$e("link",u,s),meta:$e("meta",h,s),noscript:$e("noscript",a,s),script:$e("script",f,s),style:$e("style",o,s),title:$e("title",{title:l,titleAttributes:c},s)}},Zs=Ud,zr=[],Aa=!!(typeof window<"u"&&window.document&&window.document.createElement),en=class{constructor(r,e){st(this,"instances",[]);st(this,"canUseDOM",Aa);st(this,"context");st(this,"value",{setHelmet:r=>{this.context.helmet=r},helmetInstances:{get:()=>this.canUseDOM?zr:this.instances,add:r=>{(this.canUseDOM?zr:this.instances).push(r)},remove:r=>{const e=(this.canUseDOM?zr:this.instances).indexOf(r);(this.canUseDOM?zr:this.instances).splice(e,1)}}});this.context=r,this.canUseDOM=e||!1,e||(r.helmet=Zs({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},Bd={},Ea=K.createContext(Bd),St,Sa=(St=class extends b.Component{constructor(t){super(t);st(this,"helmetData");this.helmetData=new en(this.props.context||{},St.canUseDOM)}render(){return K.createElement(Ea.Provider,{value:this.helmetData.value},this.props.children)}},st(St,"canUseDOM",Aa),St),Gt=(r,e)=>{const t=document.head||document.querySelector("head"),s=t.querySelectorAll(`${r}[${Ge}]`),n=[].slice.call(s),a=[];let o;return e&&e.length&&e.forEach(l=>{const c=document.createElement(r);for(const d in l)if(Object.prototype.hasOwnProperty.call(l,d))if(d==="innerHTML")c.innerHTML=l.innerHTML;else if(d==="cssText")c.styleSheet?c.styleSheet.cssText=l.cssText:c.appendChild(document.createTextNode(l.cssText));else{const u=d,h=typeof l[u]>"u"?"":l[u];c.setAttribute(d,h)}c.setAttribute(Ge,"true"),n.some((d,u)=>(o=u,c.isEqualNode(d)))?n.splice(o,1):a.push(c)}),n.forEach(l=>{var c;return(c=l.parentNode)==null?void 0:c.removeChild(l)}),a.forEach(l=>t.appendChild(l)),{oldTags:n,newTags:a}},tn=(r,e)=>{const t=document.getElementsByTagName(r)[0];if(!t)return;const s=t.getAttribute(Ge),n=s?s.split(","):[],a=[...n],o=Object.keys(e);for(const l of o){const c=e[l]||"";t.getAttribute(l)!==c&&t.setAttribute(l,c),n.indexOf(l)===-1&&n.push(l);const d=a.indexOf(l);d!==-1&&a.splice(d,1)}for(let l=a.length-1;l>=0;l-=1)t.removeAttribute(a[l]);n.length===a.length?t.removeAttribute(Ge):t.getAttribute(Ge)!==o.join(",")&&t.setAttribute(Ge,o.join(","))},zd=(r,e)=>{typeof r<"u"&&document.title!==r&&(document.title=_a(r)),tn("title",e)},_i=(r,e)=>{const{baseTag:t,bodyAttributes:s,htmlAttributes:n,linkTags:a,metaTags:o,noscriptTags:l,onChangeClientState:c,scriptTags:d,styleTags:u,title:h,titleAttributes:f}=r;tn("body",s),tn("html",n),zd(h,f);const m={baseTag:Gt("base",t),linkTags:Gt("link",a),metaTags:Gt("meta",o),noscriptTags:Gt("noscript",l),scriptTags:Gt("script",d),styleTags:Gt("style",u)},x={},y={};Object.keys(m).forEach(_=>{const{newTags:F,oldTags:T}=m[_];F.length&&(x[_]=F),T.length&&(y[_]=m[_].oldTags)}),e&&e(),c(r,x,y)},gr=null,qd=r=>{gr&&cancelAnimationFrame(gr),r.defer?gr=requestAnimationFrame(()=>{_i(r,()=>{gr=null})}):(_i(r),gr=null)},Vd=qd,ji=class extends b.Component{constructor(){super(...arguments);st(this,"rendered",!1)}shouldComponentUpdate(e){return!Ed(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let s=null;const n=Rd(e.get().map(a=>{const o={...a.props};return delete o.context,o}));Sa.canUseDOM?Vd(n):Zs&&(s=Zs(n)),t(s)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},Fs,Na=(Fs=class extends b.Component{shouldComponentUpdate(r){return!wd(wi(this.props,"helmetData"),wi(r,"helmetData"))}mapNestedChildrenToProps(r,e){if(!e)return null;switch(r.type){case"script":case"noscript":return{innerHTML:e};case"style":return{cssText:e};default:throw new Error(`<${r.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(r,e,t,s){return{...e,[r.type]:[...e[r.type]||[],{...t,...this.mapNestedChildrenToProps(r,s)}]}}mapObjectTypeChildren(r,e,t,s){switch(r.type){case"title":return{...e,[r.type]:s,titleAttributes:{...t}};case"body":return{...e,bodyAttributes:{...t}};case"html":return{...e,htmlAttributes:{...t}};default:return{...e,[r.type]:{...t}}}}mapArrayTypeChildrenToProps(r,e){let t={...e};return Object.keys(r).forEach(s=>{t={...t,[s]:r[s]}}),t}warnOnInvalidChildren(r,e){return xi(bi.some(t=>r.type===t),typeof r.type=="function"?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${bi.join(", ")} are allowed. Helmet does not support rendering <${r.type}> elements. Refer to our API for more information.`),xi(!e||typeof e=="string"||Array.isArray(e)&&!e.some(t=>typeof t!="string"),`Helmet expects a string as a child of <${r.type}>. Did you forget to wrap your children in braces? ( <${r.type}>{\`\`}</${r.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(r,e){let t={};return K.Children.forEach(r,s=>{if(!s||!s.props)return;const{children:n,...a}=s.props,o=Object.keys(a).reduce((c,d)=>(c[Sd[d]||d]=a[d],c),{});let{type:l}=s;switch(typeof l=="symbol"?l=l.toString():this.warnOnInvalidChildren(s,n),l){case"Symbol(react.fragment)":e=this.mapChildrenToProps(n,e);break;case"link":case"meta":case"noscript":case"script":case"style":t=this.flattenArrayTypeChildren(s,t,o,n);break;default:e=this.mapObjectTypeChildren(s,e,o,n);break}}),this.mapArrayTypeChildrenToProps(t,e)}render(){const{children:r,...e}=this.props;let t={...e},{helmetData:s}=e;if(r&&(t=this.mapChildrenToProps(r,t)),s&&!(s instanceof en)){const n=s;s=new en(n.context,!0),delete t.helmetData}return s?K.createElement(ji,{...t,context:s.value}):K.createElement(Ea.Consumer,null,n=>K.createElement(ji,{...t,context:n}))}},st(Fs,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),Fs);const Hd=[{label:"",href:"mailto:studio@activelegend.ir",icon:i.jsx("svg",{className:"w-7 h-7 text-blue-500",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 12l-4-4-4 4m8 0v6a2 2 0 01-2 2H6a2 2 0 01-2-2v-6m16 0V6a2 2 0 00-2-2H6a2 2 0 00-2 2v6"})}),value:"studio@activelegend.ir"},{label:" ",href:"https://t.me/ActiveLegend_ir",icon:i.jsx("svg",{className:"w-7 h-7 text-sky-400",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M9.04 16.29l-.39 3.67c.56 0 .8-.24 1.09-.53l2.62-2.5 5.44 3.98c1 .55 1.72.26 1.97-.92l3.58-16.76c.33-1.53-.56-2.13-1.53-1.77L2.2 9.47c-1.5.6-1.48 1.46-.27 1.85l4.6 1.44 10.7-6.74c.5-.32.96-.14.58.2"})}),value:"@ActiveLegend_ir"},{label:" ",href:"https://t.me/ActiveLegendGroup",icon:i.jsx("svg",{className:"w-7 h-7 text-sky-400",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M9.04 16.29l-.39 3.67c.56 0 .8-.24 1.09-.53l2.62-2.5 5.44 3.98c1 .55 1.72.26 1.97-.92l3.58-16.76c.33-1.53-.56-2.13-1.53-1.77L2.2 9.47c-1.5.6-1.48 1.46-.27 1.85l4.6 1.44 10.7-6.74c.5-.32.96-.14.58.2"})}),value:"@ActiveLegendGroup"},{label:"",href:"https://www.instagram.com/activelegend.ir",icon:i.jsx("svg",{className:"w-7 h-7 text-pink-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M7.75 2h8.5A5.75 5.75 0 0122 7.75v8.5A5.75 5.75 0 0116.25 22h-8.5A5.75 5.75 0 012 16.25v-8.5A5.75 5.75 0 017.75 2zm0 1.5A4.25 4.25 0 003.5 7.75v8.5A4.25 4.25 0 007.75 20.5h8.5a4.25 4.25 0 004.25-4.25v-8.5A4.25 4.25 0 0016.25 3.5h-8.5zm4.25 3.25a5.25 5.25 0 110 10.5 5.25 5.25 0 010-10.5zm0 1.5a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5zm6.25 1.25a1 1 0 110 2 1 1 0 010-2z"})}),value:"@activelegend.ir"},{label:"",href:"https://discord.gg/w7pqAwJfta",icon:i.jsx("svg",{className:"w-7 h-7 text-indigo-500",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M20.317 4.369A19.791 19.791 0 0016.885 3.1a.074.074 0 00-.079.037c-.34.607-.719 1.396-.984 2.013a18.736 18.736 0 00-5.664 0 12.683 12.683 0 00-.988-2.013.077.077 0 00-.079-.037A19.736 19.736 0 003.684 4.369a.069.069 0 00-.032.027C.533 9.093-.32 13.579.099 18.021a.082.082 0 00.031.056c2.137 1.57 4.21 2.527 6.281 3.155a.077.077 0 00.084-.027c.484-.66.915-1.356 1.289-2.084a.076.076 0 00-.041-.104c-.693-.263-1.353-.588-1.98-.965a.077.077 0 01-.008-.127c.133-.1.266-.204.392-.308a.074.074 0 01.077-.01c4.178 1.91 8.695 1.91 12.832 0a.074.074 0 01.078.009c.126.104.259.208.392.308a.077.077 0 01-.007.127c-.628.377-1.288.702-1.98.965a.076.076 0 00-.04.105c.375.728.806 1.424 1.288 2.084a.076.076 0 00.084.028c2.071-.628 4.144-1.585 6.281-3.155a.077.077 0 00.031-.056c.5-5.177-.838-9.663-3.553-13.625a.061.061 0 00-.031-.027zM8.02 15.331c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.418 2.156-2.418 1.21 0 2.175 1.085 2.156 2.418 0 1.334-.946 2.419-2.156 2.419zm7.96 0c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.418 2.156-2.418 1.21 0 2.175 1.085 2.156 2.418 0 1.334-.946 2.419-2.156 2.419z"})}),value:"Discord"},{label:"",href:"https://www.youtube.com/@ActiveLegend",icon:i.jsx("svg",{className:"w-7 h-7 text-red-600",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M23.498 6.186a2.994 2.994 0 00-2.107-2.117C19.403 3.5 12 3.5 12 3.5s-7.403 0-9.391.569A2.994 2.994 0 00.502 6.186C0 8.174 0 12 0 12s0 3.826.502 5.814a2.994 2.994 0 002.107 2.117C4.597 20.5 12 20.5 12 20.5s7.403 0 9.391-.569a2.994 2.994 0 002.107-2.117C24 15.826 24 12 24 12s0-3.826-.502-5.814zM9.75 15.568V8.432L15.818 12 9.75 15.568z"})}),value:"YouTube"}],Wd={hidden:{opacity:0,y:40},visible:{opacity:1,y:0,transition:{staggerChildren:.1,delayChildren:.2}}},Cs={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:200,damping:20}}};function Gd(){const[r,e]=K.useState(null);return i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-gray-900/70 via-gray-800/60 to-gray-900/70 backdrop-blur-md px-4 py-12 pt-24",children:[i.jsxs(Na,{children:[i.jsx("title",{children:"    | Active Legend -    "}),i.jsx("meta",{name:"description",content:"    (Active Legend)        .       ."}),i.jsx("meta",{name:"keywords",content:"  ,  , Active Legend, , Game Studio, support, , , ,  ,  , ,  ,  active legend, contact active legend"}),i.jsx("meta",{property:"og:title",content:"    | Active Legend"}),i.jsx("meta",{property:"og:description",content:"       (Active Legend)   ."}),i.jsx("meta",{property:"og:type",content:"website"}),i.jsx("meta",{property:"og:url",content:"https://activelegend.ir/contact"}),i.jsx("meta",{property:"og:image",content:"https://activelegend.ir/AE%20logo.svg"}),i.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),i.jsx("meta",{name:"twitter:title",content:"    | Active Legend"}),i.jsx("meta",{name:"twitter:description",content:"      (Active Legend)   ."}),i.jsx("meta",{name:"twitter:image",content:"https://activelegend.ir/AE%20logo.svg"})]}),i.jsxs(z.div,{className:"w-full max-w-2xl bg-white/10 rounded-3xl shadow-2xl p-8 md:p-12 backdrop-blur-md border border-white/20 text-center",initial:"hidden",animate:"visible",variants:Wd,children:[i.jsx(z.h1,{className:"text-3xl md:text-4xl font-bold text-center text-white mb-6",variants:Cs,children:"  "}),i.jsx(z.p,{className:"text-center text-gray-200 mb-10 text-lg",variants:Cs,children:"          .     !"}),i.jsx("div",{className:"flex flex-col gap-6 mt-10",children:Hd.map((t,s)=>i.jsxs(z.a,{href:t.href,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-4 bg-white/20 hover:bg-white/30 transition rounded-xl px-6 py-4 shadow-lg backdrop-blur-md border border-white/10 justify-center relative min-h-[56px]",variants:Cs,whileHover:{scale:1.03},whileTap:{scale:.98},onMouseEnter:()=>e(s),onMouseLeave:()=>e(null),onFocus:()=>e(s),onBlur:()=>e(null),style:{textAlign:"center"},children:[i.jsx("span",{children:t.icon}),i.jsxs("span",{className:"flex flex-col flex-1 items-center justify-center w-full",children:[i.jsx(z.span,{initial:!1,animate:r===s?{x:20,opacity:1,textAlign:"right",color:"#FACC15",fontSize:"1.5rem",textShadow:"0 2px 12px #FACC1580"}:{x:0,opacity:1,textAlign:"center",color:"#fff",fontSize:"1.25rem",textShadow:"none"},transition:{type:"spring",stiffness:300,damping:24},className:"text-xl md:text-2xl font-extrabold w-full block transition-all duration-300",style:{minWidth:"120px",width:"100%",display:"inline-block",textAlign:r===s?"right":"center",transition:"text-align 0.2s, color 0.2s, font-size 0.2s, text-shadow 0.2s"},children:t.label}),i.jsx(z.span,{initial:!1,animate:r===s?{x:-20,opacity:1,textAlign:"left"}:{x:0,opacity:0,textAlign:"center"},transition:{type:"spring",stiffness:300,damping:24},className:"mt-1 text-base md:text-lg text-primary-300 bg-black/30 rounded-full px-3 py-1 font-mono select-all w-full max-w-full overflow-hidden text-ellipsis",style:{minWidth:"140px",width:"100%",minHeight:"1.8em",display:"inline-block",pointerEvents:r===s?"auto":"none",userSelect:r===s?"all":"none",textAlign:r===s?"left":"center",verticalAlign:"middle",transition:"text-align 0.2s",whiteSpace:"nowrap"},children:t.value})]})]},t.label))})]})]})}const Kd=()=>{const[r,e]=b.useState([]),[t,s]=b.useState(!1),[n,a]=b.useState(!1),[o,l]=b.useState(!0);b.useEffect(()=>{const d=async()=>{var f;const{data:{session:h}}=await oe.auth.getSession();s(((f=h==null?void 0:h.user)==null?void 0:f.email)==="active.legendss@gmail.com")},u=async()=>{try{const{data:h,error:f}=await oe.from("games").select("*").eq("is_visible",!0);if(f)throw f;e(h||[])}catch(h){console.error("Error fetching games:",h)}finally{l(!1)}};d(),u()},[]);const c=async d=>{try{const{data:u,error:h}=await oe.from("games").insert([d]).select().single();if(h)throw h;e([...r,u])}catch(u){throw console.error("Error adding game:",u),u}};return o?i.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:i.jsx("div",{className:"text-white text-xl",children:"  ..."})}):i.jsx("div",{className:"min-h-screen bg-black pt-24",children:i.jsxs("div",{className:"container mx-auto px-4 md:px-8",children:[i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8",children:r.map(d=>i.jsx(ca,{game:d},d.id))}),t&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-8 left-8 bg-green-600 text-white px-5 py-3 rounded-full shadow-lg hover:bg-green-700 transition-all",children:"  "}),i.jsx(xd,{isOpen:n,onClose:()=>a(!1),onSave:c})]})]})})},Jd=({block:r,index:e})=>{const[t,s]=b.useState(0),[n,a]=b.useState(!0),o=b.useRef(null),{scrollY:l}=Ga();b.useEffect(()=>{const f=()=>{const m=window.scrollY;a(m>t),s(m)};return window.addEventListener("scroll",f,{passive:!0}),()=>window.removeEventListener("scroll",f)},[t]);const d=e%2===0?"w-full flex justify-end mb-8":"w-full flex justify-start mb-8",u=()=>({initial:{opacity:0,y:n?50:-50},whileInView:{opacity:1,y:0},viewport:{once:!1,amount:.3,margin:"100px"},transition:{duration:.7,ease:"easeOut"}}),h=()=>r.type==="image"?i.jsx("img",{src:r.src,alt:r.alt,className:"w-full md:w-3/4 rounded-2xl shadow-xl object-cover"}):r.type==="video"?i.jsx("div",{className:"w-full md:w-3/4 rounded-2xl overflow-hidden shadow-xl",children:i.jsx("iframe",{src:r.src,title:r.caption||" ",className:"w-full h-64 md:h-96",frameBorder:"0",allow:"autoplay; encrypted-media",allowFullScreen:!0})}):r.type==="text"?i.jsx("div",{className:"w-full bg-gray-900 text-gray-100 p-6 rounded-2xl",children:i.jsx("p",{className:"text-lg leading-relaxed font-medium",children:r.content})}):null;return i.jsx(z.div,{ref:o,...u(),className:r.type==="text"?"w-full mb-8":d,children:h()})},Yd=({game:r,isOpen:e,onClose:t,onSave:s})=>{const[n,a]=b.useState(!1),{register:o,handleSubmit:l,control:c,formState:{errors:d}}=ba({defaultValues:r}),{fields:u,append:h,remove:f,move:m}=va({control:c,name:"content_blocks"}),x=async y=>{try{a(!0),await s(y),t()}catch(_){console.error("Error saving game:",_)}finally{a(!1)}};return i.jsx(tr,{children:e&&i.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:i.jsxs(z.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-gray-900 rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6 text-white",children:" "}),i.jsxs("form",{onSubmit:l(x),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("input",{...o("slug",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("input",{...o("title",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsx("textarea",{...o("description",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2",rows:3})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:" "}),i.jsx("input",{...o("image_icon",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:" "}),i.jsx("input",{...o("download_url",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:""}),i.jsxs("select",{...o("status",{required:!0}),className:"w-full bg-gray-800 text-white rounded-lg p-2",children:[i.jsx("option",{value:"in_progress",children:"  "}),i.jsx("option",{value:"released",children:" "}),i.jsx("option",{value:"coming_soon",children:" "})]})]}),i.jsx("div",{className:"flex items-center",children:i.jsxs("label",{className:"flex items-center text-gray-300",children:[i.jsx("input",{type:"checkbox",...o("is_visible"),className:"ml-2"})," "]})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-medium text-white",children:" "}),i.jsxs("div",{className:"space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>h({type:"image",src:"",alt:""}),className:"bg-blue-500 text-white px-3 py-1 rounded-lg text-sm",children:" "}),i.jsx("button",{type:"button",onClick:()=>h({type:"video",src:"",caption:""}),className:"bg-green-500 text-white px-3 py-1 rounded-lg text-sm",children:" "}),i.jsx("button",{type:"button",onClick:()=>h({type:"text",content:""}),className:"bg-purple-500 text-white px-3 py-1 rounded-lg text-sm",children:" "})]})]}),i.jsx("div",{className:"space-y-4",children:u.map((y,_)=>i.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsxs("select",{...o(`content_blocks.${_}.type`),className:"bg-gray-700 text-white rounded-lg p-2",children:[i.jsx("option",{value:"image",children:""}),i.jsx("option",{value:"video",children:""}),i.jsx("option",{value:"text",children:""})]}),i.jsxs("div",{className:"space-x-2",children:[_>0&&i.jsx("button",{type:"button",onClick:()=>m(_,_-1),className:"text-gray-300 hover:text-white",children:""}),_<u.length-1&&i.jsx("button",{type:"button",onClick:()=>m(_,_+1),className:"text-gray-300 hover:text-white",children:""}),i.jsx("button",{type:"button",onClick:()=>f(_),className:"text-red-500 hover:text-red-400",children:""})]})]}),y.type==="image"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{...o(`content_blocks.${_}.src`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2 mb-2"}),i.jsx("input",{...o(`content_blocks.${_}.alt`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2"})]}),y.type==="video"&&i.jsxs(i.Fragment,{children:[i.jsx("input",{...o(`content_blocks.${_}.src`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2 mb-2"}),i.jsx("input",{...o(`content_blocks.${_}.caption`),placeholder:" ",className:"w-full bg-gray-700 text-white rounded-lg p-2"})]}),y.type==="text"&&i.jsx("textarea",{...o(`content_blocks.${_}.content`),placeholder:"",className:"w-full bg-gray-700 text-white rounded-lg p-2",rows:3})]},y.id))})]}),i.jsxs("div",{className:"flex justify-end space-x-4",children:[i.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-300 hover:text-white",children:""}),i.jsx("button",{type:"submit",disabled:n,className:"bg-[#F4B744] text-black font-bold px-6 py-2 rounded-lg hover:bg-[#E5A93D] disabled:opacity-50",children:n?"  ...":" "})]})]})]})})})},Xd=({gameId:r,className:e=""})=>{const[t,s]=b.useState(!1),[n,a]=b.useState(!0);b.useEffect(()=>{o();const c=oe.channel("favorites_changes").on("postgres_changes",{event:"*",schema:"public",table:"favorites",filter:`game_id=eq.${r}`},()=>{o()}).subscribe();return()=>{c.unsubscribe()}},[r]);const o=async()=>{try{const{data:{session:c}}=await oe.auth.getSession();if(!(c!=null&&c.user)){a(!1);return}const{data:d,error:u}=await oe.from("favorites").select("id").eq("game_id",r).eq("user_id",c.user.id).single();if(u&&u.code!=="PGRST116")throw u;s(!!d)}catch(c){console.error("Error checking favorite status:",c)}finally{a(!1)}},l=async()=>{try{a(!0);const{data:{session:c}}=await oe.auth.getSession();if(!(c!=null&&c.user))return;if(t){const{error:d}=await oe.from("favorites").delete().eq("game_id",r).eq("user_id",c.user.id);if(d)throw d;s(!1)}else{const{error:d}=await oe.from("favorites").insert([{game_id:r,user_id:c.user.id}]);if(d)throw d;s(!0)}}catch(c){console.error("Error toggling favorite:",c)}finally{a(!1)}};return n?i.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full bg-gray-800 text-gray-300",children:[i.jsx("span",{className:"animate-pulse",children:""}),i.jsx("span",{className:"text-sm font-medium",children:"  ..."})]}):i.jsxs(z.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:l,disabled:n,className:`flex items-center gap-2 px-4 py-2 rounded-full transition-colors ${t?"bg-red-500 text-white hover:bg-red-600":"bg-gray-800 text-gray-300 hover:bg-gray-700"} ${e}`,children:[i.jsx(z.span,{animate:{scale:t?[1,1.2,1]:1},transition:{duration:.3},children:""}),i.jsx("span",{className:"text-sm font-medium",children:t?"  ":"  "})]})};class Qd{async getComments(e){try{const{data:t,error:s}=await ie.from("comments").select(`
          id,
          content,
          user_id,
          game_id,
          parent_id,
          created_at,
          updated_at,
          is_pinned,
          is_approved,
          user:user_id (
            id,
            email,
            profile_image_url
          )
        `).eq("game_id",e).is("parent_id",null).order("created_at",{ascending:!1});if(s)throw console.error("Error fetching comments:",s),s;if(!t)return[];const n=await Promise.all(t.map(async o=>{const{count:l,error:c}=await ie.from("likes").select("*",{count:"exact",head:!0}).eq("comment_id",o.id);return c?(console.error(`Error getting likes count for comment ${o.id}:`,c),{...o,likes_count:0}):{...o,likes_count:l||0}}));return await Promise.all(n.map(async o=>{const{data:l,error:c}=await ie.from("comments").select(`
              id,
              content,
              user_id,
              game_id,
              parent_id,
              created_at,
              updated_at,
              is_pinned,
              is_approved,
              user:user_id (
                id,
                email,
                profile_image_url
              )
            `).eq("parent_id",o.id).order("created_at",{ascending:!0});if(c)return console.error(`Error getting replies for comment ${o.id}:`,c),{...o,replies:[]};if(!l)return{...o,replies:[]};const d=await Promise.all(l.map(async u=>{const{count:h,error:f}=await ie.from("likes").select("*",{count:"exact",head:!0}).eq("comment_id",u.id);return f?(console.error(`Error getting likes count for reply ${u.id}:`,f),{...u,likes_count:0}):{...u,likes_count:h||0}}));return{...o,replies:d}}))}catch(t){throw console.error("Error fetching comments:",t),t}}async addComment(e){try{const{data:t,error:s}=await ie.from("comments").insert([{content:e.content,game_id:e.game_id,parent_id:e.parent_id||null,user_id:e.user_id,is_pinned:!1,is_approved:!0}]).select(`
          id,
          content,
          user_id,
          game_id,
          parent_id,
          created_at,
          updated_at,
          is_pinned,
          is_approved,
          user:user_id (
            id,
            email,
            profile_image_url
          )
        `).single();if(s)throw console.error("Error adding comment:",s),s;return{...t,likes_count:0,replies:[]}}catch(t){throw console.error("Error adding comment:",t),t}}async deleteComment(e){try{const{error:t}=await ie.from("comments").delete().eq("id",e);if(t)throw t}catch(t){throw console.error("Error deleting comment:",t),t}}async hasLiked(e,t){try{const{data:s,error:n}=await ie.from("likes").select("id").eq("comment_id",e).eq("user_id",t).single();if(n&&n.code!=="PGRST116")throw n;return!!s}catch(s){return console.error("Error checking like status:",s),!1}}async toggleLike(e,t){try{if(await this.hasLiked(e,t)){const{error:n}=await ie.from("likes").delete().eq("comment_id",e).eq("user_id",t);if(n)throw n}else{const{error:n}=await ie.from("likes").insert([{comment_id:e,user_id:t}]);if(n)throw n}}catch(s){throw console.error("Error toggling like:",s),s}}async togglePin(e){try{const{data:t,error:s}=await ie.from("comments").select("is_pinned").eq("id",e).single();if(s)throw s;const{error:n}=await ie.from("comments").update({is_pinned:!t.is_pinned}).eq("id",e);if(n)throw n}catch(t){throw console.error("Error toggling pin:",t),t}}async toggleApproval(e){try{const{data:t,error:s}=await ie.from("comments").select("is_approved").eq("id",e).single();if(s)throw s;const{error:n}=await ie.from("comments").update({is_approved:!t.is_approved}).eq("id",e);if(n)throw n}catch(t){throw console.error("Error toggling approval:",t),t}}subscribeToComments(e,t){return ie.channel("comments").on("postgres_changes",{event:"*",schema:"public",table:"comments",filter:`game_id=eq.${e}`},t).subscribe()}}const Xe=new Qd,Zd=({gameId:r})=>{var q;const{user:e,session:t}=Ke(),[s,n]=b.useState([]),[a,o]=b.useState(!0),[l,c]=b.useState(null),[d,u]=b.useState(""),[h,f]=b.useState(null),[m,x]=b.useState({}),[y,_]=b.useState(!1),[F,T]=b.useState({}),j=(e==null?void 0:e.email)==="active.legendss@gmail.com";b.useEffect(()=>{var A,D;if(e&&((A=e.app_metadata)==null?void 0:A.provider)==="google"){const W=(D=e.user_metadata)==null?void 0:D.full_name;W&&(!e.user_metadata.display_name||e.user_metadata.display_name==="")&&ie.from("users").update({display_name:W}).eq("id",e.id).then()}},[e]),b.useEffect(()=>{R();const A=Xe.subscribeToComments(r,I);return()=>{A.unsubscribe()}},[r]);const R=async()=>{var A;try{o(!0),c(null);const D=await Xe.getComments(r);if(console.log("Loaded comments:",D),n(D),(A=t==null?void 0:t.user)!=null&&A.id){const W={};for(const de of D)try{const ne=await Xe.hasLiked(de.id,t.user.id);W[de.id]={liked:ne,count:de.likes_count||0,loading:!1}}catch(ne){console.error(`Error checking like status for comment ${de.id}:`,ne),W[de.id]={liked:!1,count:de.likes_count||0,loading:!1}}T(W)}}catch(D){console.error("Error loading comments:",D),c("   .     .")}finally{o(!1)}},I=async A=>{console.log("Comment change payload:",A);try{if(A.eventType==="INSERT")await R();else if(A.eventType==="UPDATE"){const D=s.map(W=>W.id===A.new.id?{...W,...A.new}:W);n(D)}else A.eventType==="DELETE"&&n(s.filter(D=>D.id!==A.old.id))}catch(D){console.error("Error handling comment change:",D)}},w=async A=>{if(A.preventDefault(),!e){c("     .");return}if(!d.trim()){c("     .");return}_(!0),c(null);try{const D={content:d.trim(),game_id:r,parent_id:h,user_id:e.id};await Xe.addComment(D),u(""),f(null),await R()}catch(D){console.error("Error submitting comment:",D),c(D.message||"   .    .")}finally{_(!1)}},E=async A=>{if(!e){c("     .");return}try{await Xe.deleteComment(A),await R()}catch(D){console.error("Error deleting comment:",D),c(D.message||"   .    .")}},U=async A=>{if(!e){c("      .");return}try{T(W=>({...W,[A]:{...W[A],loading:!0}})),await Xe.toggleLike(A,e.id);const D=await Xe.hasLiked(A,e.id);T(W=>{var de,ne;return{...W,[A]:{liked:D,count:D?(((de=W[A])==null?void 0:de.count)||0)+1:(((ne=W[A])==null?void 0:ne.count)||0)-1,loading:!1}}})}catch(D){console.error("Error toggling like:",D),c(D.message||"    .    ."),T(W=>({...W,[A]:{...W[A],loading:!1}}))}},J=async(A,D)=>{if(j)try{switch(A){case"pin":await Xe.togglePin(D);break;case"approve":await Xe.toggleApproval(D);break;case"delete":window.confirm("      ")&&await Xe.deleteComment(D);break}await R()}catch(W){console.error("Error performing admin action:",W),c("   .    .")}},ce=A=>{var D;return A!=null&&A.profile_image_url?A.profile_image_url:(D=A==null?void 0:A.user_metadata)!=null&&D.avatar_url?A.user_metadata.avatar_url:"/AE logo.svg"},Q=A=>A.slice().sort((D,W)=>D.is_pinned&&!W.is_pinned?-1:!D.is_pinned&&W.is_pinned||!D.is_approved&&W.is_approved?1:D.is_approved&&!W.is_approved?-1:new Date(W.created_at).getTime()-new Date(D.created_at).getTime()),N=A=>A!=null&&A.display_name&&A.display_name.trim()!==""?A.display_name:A!=null&&A.email?A.email.split("@")[0]:" ",Y=(A,D=!1)=>{var S;const W=F[A.id]||{liked:!1,count:0,loading:!1},de=(e==null?void 0:e.email)==="active.legendss@gmail.com";let ne="";return A.is_pinned?ne="border-2 border-blue-500":A.is_approved||(ne="border-2 border-red-500"),i.jsxs(z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`bg-white rounded-lg shadow-md p-4 mb-4 ${D?"ml-8":""} ${ne}`,children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("img",{src:ce(A.user),alt:((S=A.user)==null?void 0:S.display_name)||"",className:"w-10 h-10 rounded-full"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-800",children:N(A.user)}),i.jsx("p",{className:"text-sm text-gray-500",children:new Date(A.created_at).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[de&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>J("pin",A.id),className:`p-2 rounded-full ${A.is_pinned?"text-blue-500":"text-gray-400"} hover:bg-gray-100`,title:A.is_pinned?" ":" ",children:i.jsx(Bc,{})}),i.jsx("button",{onClick:()=>J("approve",A.id),className:`p-2 rounded-full ${A.is_approved?"text-green-500":"text-gray-400"} hover:bg-gray-100`,title:A.is_approved?" ":" ",children:A.is_approved?i.jsx(Rc,{}):i.jsx(zc,{})})]}),e&&(e.id===A.user_id||de)&&i.jsx("button",{onClick:()=>E(A.id),className:"text-red-500 hover:text-red-700",children:""})]})]}),i.jsx("p",{className:"mt-2 text-gray-700",children:A.content}),i.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[i.jsxs("button",{onClick:()=>U(A.id),disabled:!e||W.loading,className:`flex items-center gap-1 ${W.liked?"text-blue-500":"text-gray-400"} hover:text-blue-500`,children:[i.jsx(Uc,{}),i.jsx("span",{className:"text-base font-medium",children:W.count})]}),!D&&i.jsx("button",{onClick:()=>f(h===A.id?null:A.id),className:"text-gray-400 hover:text-blue-500",children:i.jsx(Fc,{})})]}),h===A.id&&i.jsx(z.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4",children:i.jsxs("form",{onSubmit:w,className:"flex flex-col space-y-2",children:[i.jsx("textarea",{value:d,onChange:P=>u(P.target.value),placeholder:"   ...",className:"w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx("button",{type:"button",onClick:()=>f(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:""}),i.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:" "})]})]})}),A.replies&&A.replies.length>0&&i.jsx("div",{className:"mt-4 space-y-4",children:Q(A.replies).map(P=>Y(P,!0))})]},A.id)};return a?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto"}),i.jsx("p",{className:"mt-2 text-gray-400",children:"   ..."})]}):i.jsxs("div",{className:"mt-8",children:[i.jsx("h3",{className:"text-2xl font-bold mb-6",children:""}),l&&i.jsx("div",{className:"bg-red-500/10 border border-red-500 text-red-500 rounded-lg p-4 mb-6",children:l}),(q=t==null?void 0:t.user)!=null&&q.id?i.jsxs("form",{onSubmit:w,className:"mb-8",children:[i.jsx("textarea",{value:d,onChange:A=>u(A.target.value),placeholder:h?"   ...":"   ...",className:"w-full bg-gray-800 text-white rounded-lg p-4 mb-2 resize-none focus:ring-2 focus:ring-blue-500 focus:outline-none",rows:3,minLength:5,maxLength:500,disabled:y}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("span",{className:"text-gray-400 text-sm",children:[d.length,"/500 "]}),i.jsxs("div",{className:"flex gap-2",children:[h&&i.jsx("button",{type:"button",onClick:()=>f(null),className:"px-4 py-2 text-gray-400 hover:text-white transition-colors",disabled:y,children:""}),i.jsx("button",{type:"submit",disabled:!d.trim()||d.length<5||y,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y?"  ...":" "})]})]})]}):i.jsx("div",{className:"text-center py-4 text-gray-400 bg-gray-800/50 rounded-lg mb-8",children:"     ."}),i.jsx(tr,{children:s.length===0?i.jsx("div",{className:"text-center py-8 text-gray-400",children:"    .      !"}):Q(s).map(A=>i.jsx("div",{children:Y(A)},A.id))})]})},eu=()=>{const{slug:r}=$i(),e=Nt(),{user:t}=Ke(),[s,n]=b.useState(null),[a,o]=b.useState(!1),[l,c]=b.useState(!1),[d,u]=b.useState(!0);b.useEffect(()=>{const f=async()=>{var y;const{data:{session:x}}=await oe.auth.getSession();o(((y=x==null?void 0:x.user)==null?void 0:y.email)==="active.legendss@gmail.com")},m=async()=>{if(r)try{const{data:x,error:y}=await oe.from("games").select("*").eq("slug",r).single();if(y)throw y;if(!x||!x.is_visible){e("/404");return}n(x)}catch(x){console.error("Error fetching game:",x),e("/404")}finally{u(!1)}};f(),m()},[r,e]);const h=async f=>{try{const{data:m,error:x}=await oe.from("games").update(f).eq("id",s==null?void 0:s.id).select().single();if(x)throw x;n(m)}catch(m){throw console.error("Error updating game:",m),m}};return d?i.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:i.jsx("div",{className:"text-white text-xl",children:"  ..."})}):s?i.jsx("div",{className:"min-h-screen bg-black pt-24 md:pt-28",children:i.jsxs("div",{className:"max-w-4xl mx-auto p-4 md:p-8",children:[i.jsxs("div",{className:"mb-8",children:[i.jsx("h1",{className:"text-3xl font-extrabold text-white mb-4",children:s.title}),i.jsx("p",{className:"text-base font-medium text-gray-300 mb-6",children:s.description}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("a",{href:s.download_url,target:"_blank",rel:"noopener noreferrer",className:"inline-block bg-[#F4B744] text-black font-bold px-6 py-3 rounded-2xl hover:scale-105 transition-all duration-200",children:" "}),t&&s&&i.jsx(Xd,{gameId:s.id}),a&&i.jsx("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-2xl hover:scale-105 transition-all duration-200",children:" "})]})]}),i.jsx("div",{className:"space-y-8",children:s.content_blocks.map((f,m)=>i.jsx(Jd,{block:f,index:m},m))}),a&&i.jsx(Yd,{game:s,isOpen:l,onClose:()=>c(!1),onSave:h}),i.jsx("div",{className:"container mx-auto px-4 py-8",children:i.jsx("div",{className:"max-w-4xl mx-auto",children:i.jsx(Zd,{gameId:s.id})})})]})}):i.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:i.jsx("div",{className:"text-white text-xl",children:"  "})})};function tu(){const r=Nt();return i.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center px-4",children:i.jsxs("div",{className:"text-center",children:[i.jsx(z.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-6xl font-bold mb-4 font-vazirmatn",children:""}),i.jsx(z.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-gray-400 mb-8 font-vazirmatn",children:"    "}),i.jsx(z.button,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},onClick:()=>r("/"),className:"bg-[#F4B744] text-black px-6 py-2 rounded-lg font-medium hover:bg-[#F4B744]/90 transition-colors",children:"  "})]})})}const ru=()=>{const[r,e]=b.useState([]),[t,s]=b.useState(!0);return b.useEffect(()=>{(async()=>{try{const{data:{session:a}}=await oe.auth.getSession();if(!(a!=null&&a.user)){s(!1);return}const{data:o,error:l}=await oe.from("favorites").select("game_id").eq("user_id",a.user.id);if(l)throw l;if(o&&o.length>0){const c=o.map(h=>h.game_id),{data:d,error:u}=await oe.from("games").select("*").in("id",c).eq("is_visible",!0);if(u)throw u;e(d||[])}}catch(a){console.error("Error fetching favorite games:",a)}finally{s(!1)}})()},[]),t?i.jsx("div",{className:"min-h-screen bg-black flex items-center justify-center",children:i.jsx("div",{className:"text-white text-xl",children:"  ..."})}):i.jsxs("div",{className:"min-h-screen bg-black p-4 md:p-8 pt-24",children:[i.jsx(z.h1,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-3xl font-bold text-white mb-8 text-center",children:"  "}),r.length>0?i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8",children:r.map(n=>i.jsx(ca,{game:n},n.id))}):i.jsx(z.p,{initial:{opacity:0},animate:{opacity:1},className:"text-center text-gray-400 text-lg",children:"     ."})]})};class su{async getActiveTerms(){try{const{data:e,error:t}=await ie.from("terms_and_conditions").select("*").eq("is_active",!0).single();if(t)throw t;return e}catch(e){throw console.error("Error fetching active terms:",e),e}}async getUserTermsAcceptance(e){try{const{data:t,error:s}=await ie.from("users").select("terms_accepted_version, terms_accepted_at").eq("id",e).single();if(s)throw s;return t}catch(t){throw console.error("Error fetching user terms acceptance:",t),t}}async acceptTerms(e,t){try{const{error:s}=await ie.from("users").update({terms_accepted_version:t,terms_accepted_at:new Date().toISOString()}).eq("id",e);if(s)throw s}catch(s){throw console.error("Error accepting terms:",s),s}}async createNewTerms(e){try{const{error:t}=await ie.from("terms_and_conditions").update({is_active:!1}).eq("is_active",!0);if(t)throw t;const{error:s}=await ie.from("terms_and_conditions").insert([e]);if(s)throw s}catch(t){throw console.error("Error creating new terms:",t),t}}async updateTerms(e,t){try{const{error:s}=await ie.from("terms_and_conditions").update(t).eq("id",e);if(s)throw s}catch(s){throw console.error("Error updating terms:",s),s}}}const rs=new su;/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Ta,setPrototypeOf:ki,isFrozen:nu,getPrototypeOf:iu,getOwnPropertyDescriptor:au}=Object;let{freeze:Oe,seal:Ue,create:Ca}=Object,{apply:rn,construct:sn}=typeof Reflect<"u"&&Reflect;Oe||(Oe=function(e){return e});Ue||(Ue=function(e){return e});rn||(rn=function(e,t,s){return e.apply(t,s)});sn||(sn=function(e,t){return new e(...t)});const qr=Ie(Array.prototype.forEach),ou=Ie(Array.prototype.lastIndexOf),Ai=Ie(Array.prototype.pop),pr=Ie(Array.prototype.push),lu=Ie(Array.prototype.splice),Kr=Ie(String.prototype.toLowerCase),Os=Ie(String.prototype.toString),Ei=Ie(String.prototype.match),yr=Ie(String.prototype.replace),cu=Ie(String.prototype.indexOf),du=Ie(String.prototype.trim),Ve=Ie(Object.prototype.hasOwnProperty),Se=Ie(RegExp.prototype.test),xr=uu(TypeError);function Ie(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,s=new Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];return rn(r,e,s)}}function uu(r){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return sn(r,t)}}function ee(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Kr;ki&&ki(r,null);let s=e.length;for(;s--;){let n=e[s];if(typeof n=="string"){const a=t(n);a!==n&&(nu(e)||(e[s]=a),n=a)}r[n]=!0}return r}function hu(r){for(let e=0;e<r.length;e++)Ve(r,e)||(r[e]=null);return r}function at(r){const e=Ca(null);for(const[t,s]of Ta(r))Ve(r,t)&&(Array.isArray(s)?e[t]=hu(s):s&&typeof s=="object"&&s.constructor===Object?e[t]=at(s):e[t]=s);return e}function vr(r,e){for(;r!==null;){const s=au(r,e);if(s){if(s.get)return Ie(s.get);if(typeof s.value=="function")return Ie(s.value)}r=iu(r)}function t(){return null}return t}const Si=Oe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Is=Oe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Rs=Oe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fu=Oe(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ls=Oe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mu=Oe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Ni=Oe(["#text"]),Ti=Oe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ps=Oe(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ci=Oe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vr=Oe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),gu=Ue(/\{\{[\w\W]*|[\w\W]*\}\}/gm),pu=Ue(/<%[\w\W]*|[\w\W]*%>/gm),yu=Ue(/\$\{[\w\W]*/gm),xu=Ue(/^data-[\-\w.\u00B7-\uFFFF]+$/),vu=Ue(/^aria-[\-\w]+$/),Oa=Ue(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bu=Ue(/^(?:\w+script|data):/i),wu=Ue(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ia=Ue(/^html$/i),_u=Ue(/^[a-z][.\w]*(-[.\w]+)+$/i);var Oi=Object.freeze({__proto__:null,ARIA_ATTR:vu,ATTR_WHITESPACE:wu,CUSTOM_ELEMENT:_u,DATA_ATTR:xu,DOCTYPE_NAME:Ia,ERB_EXPR:pu,IS_ALLOWED_URI:Oa,IS_SCRIPT_OR_DATA:bu,MUSTACHE_EXPR:gu,TMPLIT_EXPR:yu});const br={element:1,text:3,progressingInstruction:7,comment:8,document:9},ju=function(){return typeof window>"u"?null:window},ku=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let s=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(s=t.getAttribute(n));const a="dompurify"+(s?"#"+s:"");try{return e.createPolicy(a,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+a+" could not be created."),null}},Ii=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ra(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ju();const e=G=>Ra(G);if(e.version="3.2.6",e.removed=[],!r||!r.document||r.document.nodeType!==br.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const s=t,n=s.currentScript,{DocumentFragment:a,HTMLTemplateElement:o,Node:l,Element:c,NodeFilter:d,NamedNodeMap:u=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:m}=r,x=c.prototype,y=vr(x,"cloneNode"),_=vr(x,"remove"),F=vr(x,"nextSibling"),T=vr(x,"childNodes"),j=vr(x,"parentNode");if(typeof o=="function"){const G=t.createElement("template");G.content&&G.content.ownerDocument&&(t=G.content.ownerDocument)}let R,I="";const{implementation:w,createNodeIterator:E,createDocumentFragment:U,getElementsByTagName:J}=t,{importNode:ce}=s;let Q=Ii();e.isSupported=typeof Ta=="function"&&typeof j=="function"&&w&&w.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:N,ERB_EXPR:Y,TMPLIT_EXPR:q,DATA_ATTR:A,ARIA_ATTR:D,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:de,CUSTOM_ELEMENT:ne}=Oi;let{IS_ALLOWED_URI:S}=Oi,P=null;const $=ee({},[...Si,...Is,...Rs,...Ls,...Ni]);let X=null;const je=ee({},[...Ti,...Ps,...Ci,...Vr]);let ue=Object.seal(Ca(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),vt=null,bt=null,sr=!0,wt=!0,Ct=!1,Or=!0,et=!1,Ot=!0,Je=!1,It=!1,nr=!1,lt=!1,ir=!1,_t=!1,g=!0,v=!1;const k="user-content-";let M=!0,L=!1,C={},V=null;const re=ee({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let se=null;const Ee=ee({},["audio","video","img","source","image","track"]);let ct=null;const Be=ee({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Rt="http://www.w3.org/1998/Math/MathML",dt="http://www.w3.org/2000/svg",De="http://www.w3.org/1999/xhtml";let ut=De,Lt=!1,ar=null;const Ir=ee({},[Rt,dt,De],Os);let Rr=ee({},["mi","mo","mn","ms","mtext"]),Lr=ee({},["annotation-xml"]);const Da=ee({},["title","style","font","a","script"]);let or=null;const Ma=["application/xhtml+xml","text/html"],$a="text/html";let be=null,Pt=null;const Fa=t.createElement("form"),gn=function(p){return p instanceof RegExp||p instanceof Function},is=function(){let p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Pt&&Pt===p)){if((!p||typeof p!="object")&&(p={}),p=at(p),or=Ma.indexOf(p.PARSER_MEDIA_TYPE)===-1?$a:p.PARSER_MEDIA_TYPE,be=or==="application/xhtml+xml"?Os:Kr,P=Ve(p,"ALLOWED_TAGS")?ee({},p.ALLOWED_TAGS,be):$,X=Ve(p,"ALLOWED_ATTR")?ee({},p.ALLOWED_ATTR,be):je,ar=Ve(p,"ALLOWED_NAMESPACES")?ee({},p.ALLOWED_NAMESPACES,Os):Ir,ct=Ve(p,"ADD_URI_SAFE_ATTR")?ee(at(Be),p.ADD_URI_SAFE_ATTR,be):Be,se=Ve(p,"ADD_DATA_URI_TAGS")?ee(at(Ee),p.ADD_DATA_URI_TAGS,be):Ee,V=Ve(p,"FORBID_CONTENTS")?ee({},p.FORBID_CONTENTS,be):re,vt=Ve(p,"FORBID_TAGS")?ee({},p.FORBID_TAGS,be):at({}),bt=Ve(p,"FORBID_ATTR")?ee({},p.FORBID_ATTR,be):at({}),C=Ve(p,"USE_PROFILES")?p.USE_PROFILES:!1,sr=p.ALLOW_ARIA_ATTR!==!1,wt=p.ALLOW_DATA_ATTR!==!1,Ct=p.ALLOW_UNKNOWN_PROTOCOLS||!1,Or=p.ALLOW_SELF_CLOSE_IN_ATTR!==!1,et=p.SAFE_FOR_TEMPLATES||!1,Ot=p.SAFE_FOR_XML!==!1,Je=p.WHOLE_DOCUMENT||!1,lt=p.RETURN_DOM||!1,ir=p.RETURN_DOM_FRAGMENT||!1,_t=p.RETURN_TRUSTED_TYPE||!1,nr=p.FORCE_BODY||!1,g=p.SANITIZE_DOM!==!1,v=p.SANITIZE_NAMED_PROPS||!1,M=p.KEEP_CONTENT!==!1,L=p.IN_PLACE||!1,S=p.ALLOWED_URI_REGEXP||Oa,ut=p.NAMESPACE||De,Rr=p.MATHML_TEXT_INTEGRATION_POINTS||Rr,Lr=p.HTML_INTEGRATION_POINTS||Lr,ue=p.CUSTOM_ELEMENT_HANDLING||{},p.CUSTOM_ELEMENT_HANDLING&&gn(p.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ue.tagNameCheck=p.CUSTOM_ELEMENT_HANDLING.tagNameCheck),p.CUSTOM_ELEMENT_HANDLING&&gn(p.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ue.attributeNameCheck=p.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),p.CUSTOM_ELEMENT_HANDLING&&typeof p.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ue.allowCustomizedBuiltInElements=p.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),et&&(wt=!1),ir&&(lt=!0),C&&(P=ee({},Ni),X=[],C.html===!0&&(ee(P,Si),ee(X,Ti)),C.svg===!0&&(ee(P,Is),ee(X,Ps),ee(X,Vr)),C.svgFilters===!0&&(ee(P,Rs),ee(X,Ps),ee(X,Vr)),C.mathMl===!0&&(ee(P,Ls),ee(X,Ci),ee(X,Vr))),p.ADD_TAGS&&(P===$&&(P=at(P)),ee(P,p.ADD_TAGS,be)),p.ADD_ATTR&&(X===je&&(X=at(X)),ee(X,p.ADD_ATTR,be)),p.ADD_URI_SAFE_ATTR&&ee(ct,p.ADD_URI_SAFE_ATTR,be),p.FORBID_CONTENTS&&(V===re&&(V=at(V)),ee(V,p.FORBID_CONTENTS,be)),M&&(P["#text"]=!0),Je&&ee(P,["html","head","body"]),P.table&&(ee(P,["tbody"]),delete vt.tbody),p.TRUSTED_TYPES_POLICY){if(typeof p.TRUSTED_TYPES_POLICY.createHTML!="function")throw xr('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof p.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw xr('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=p.TRUSTED_TYPES_POLICY,I=R.createHTML("")}else R===void 0&&(R=ku(m,n)),R!==null&&typeof I=="string"&&(I=R.createHTML(""));Oe&&Oe(p),Pt=p}},pn=ee({},[...Is,...Rs,...fu]),yn=ee({},[...Ls,...mu]),Ua=function(p){let O=j(p);(!O||!O.tagName)&&(O={namespaceURI:ut,tagName:"template"});const H=Kr(p.tagName),he=Kr(O.tagName);return ar[p.namespaceURI]?p.namespaceURI===dt?O.namespaceURI===De?H==="svg":O.namespaceURI===Rt?H==="svg"&&(he==="annotation-xml"||Rr[he]):!!pn[H]:p.namespaceURI===Rt?O.namespaceURI===De?H==="math":O.namespaceURI===dt?H==="math"&&Lr[he]:!!yn[H]:p.namespaceURI===De?O.namespaceURI===dt&&!Lr[he]||O.namespaceURI===Rt&&!Rr[he]?!1:!yn[H]&&(Da[H]||!pn[H]):!!(or==="application/xhtml+xml"&&ar[p.namespaceURI]):!1},Ye=function(p){pr(e.removed,{element:p});try{j(p).removeChild(p)}catch{_(p)}},Dt=function(p,O){try{pr(e.removed,{attribute:O.getAttributeNode(p),from:O})}catch{pr(e.removed,{attribute:null,from:O})}if(O.removeAttribute(p),p==="is")if(lt||ir)try{Ye(O)}catch{}else try{O.setAttribute(p,"")}catch{}},xn=function(p){let O=null,H=null;if(nr)p="<remove></remove>"+p;else{const ve=Ei(p,/^[\r\n\t ]+/);H=ve&&ve[0]}or==="application/xhtml+xml"&&ut===De&&(p='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+p+"</body></html>");const he=R?R.createHTML(p):p;if(ut===De)try{O=new f().parseFromString(he,or)}catch{}if(!O||!O.documentElement){O=w.createDocument(ut,"template",null);try{O.documentElement.innerHTML=Lt?I:he}catch{}}const ke=O.body||O.documentElement;return p&&H&&ke.insertBefore(t.createTextNode(H),ke.childNodes[0]||null),ut===De?J.call(O,Je?"html":"body")[0]:Je?O.documentElement:ke},vn=function(p){return E.call(p.ownerDocument||p,p,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},as=function(p){return p instanceof h&&(typeof p.nodeName!="string"||typeof p.textContent!="string"||typeof p.removeChild!="function"||!(p.attributes instanceof u)||typeof p.removeAttribute!="function"||typeof p.setAttribute!="function"||typeof p.namespaceURI!="string"||typeof p.insertBefore!="function"||typeof p.hasChildNodes!="function")},bn=function(p){return typeof l=="function"&&p instanceof l};function tt(G,p,O){qr(G,H=>{H.call(e,p,O,Pt)})}const wn=function(p){let O=null;if(tt(Q.beforeSanitizeElements,p,null),as(p))return Ye(p),!0;const H=be(p.nodeName);if(tt(Q.uponSanitizeElement,p,{tagName:H,allowedTags:P}),Ot&&p.hasChildNodes()&&!bn(p.firstElementChild)&&Se(/<[/\w!]/g,p.innerHTML)&&Se(/<[/\w!]/g,p.textContent)||p.nodeType===br.progressingInstruction||Ot&&p.nodeType===br.comment&&Se(/<[/\w]/g,p.data))return Ye(p),!0;if(!P[H]||vt[H]){if(!vt[H]&&jn(H)&&(ue.tagNameCheck instanceof RegExp&&Se(ue.tagNameCheck,H)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(H)))return!1;if(M&&!V[H]){const he=j(p)||p.parentNode,ke=T(p)||p.childNodes;if(ke&&he){const ve=ke.length;for(let Re=ve-1;Re>=0;--Re){const rt=y(ke[Re],!0);rt.__removalCount=(p.__removalCount||0)+1,he.insertBefore(rt,F(p))}}}return Ye(p),!0}return p instanceof c&&!Ua(p)||(H==="noscript"||H==="noembed"||H==="noframes")&&Se(/<\/no(script|embed|frames)/i,p.innerHTML)?(Ye(p),!0):(et&&p.nodeType===br.text&&(O=p.textContent,qr([N,Y,q],he=>{O=yr(O,he," ")}),p.textContent!==O&&(pr(e.removed,{element:p.cloneNode()}),p.textContent=O)),tt(Q.afterSanitizeElements,p,null),!1)},_n=function(p,O,H){if(g&&(O==="id"||O==="name")&&(H in t||H in Fa))return!1;if(!(wt&&!bt[O]&&Se(A,O))){if(!(sr&&Se(D,O))){if(!X[O]||bt[O]){if(!(jn(p)&&(ue.tagNameCheck instanceof RegExp&&Se(ue.tagNameCheck,p)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(p))&&(ue.attributeNameCheck instanceof RegExp&&Se(ue.attributeNameCheck,O)||ue.attributeNameCheck instanceof Function&&ue.attributeNameCheck(O))||O==="is"&&ue.allowCustomizedBuiltInElements&&(ue.tagNameCheck instanceof RegExp&&Se(ue.tagNameCheck,H)||ue.tagNameCheck instanceof Function&&ue.tagNameCheck(H))))return!1}else if(!ct[O]){if(!Se(S,yr(H,de,""))){if(!((O==="src"||O==="xlink:href"||O==="href")&&p!=="script"&&cu(H,"data:")===0&&se[p])){if(!(Ct&&!Se(W,yr(H,de,"")))){if(H)return!1}}}}}}return!0},jn=function(p){return p!=="annotation-xml"&&Ei(p,ne)},kn=function(p){tt(Q.beforeSanitizeAttributes,p,null);const{attributes:O}=p;if(!O||as(p))return;const H={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X,forceKeepAttr:void 0};let he=O.length;for(;he--;){const ke=O[he],{name:ve,namespaceURI:Re,value:rt}=ke,lr=be(ve),os=rt;let Ae=ve==="value"?os:du(os);if(H.attrName=lr,H.attrValue=Ae,H.keepAttr=!0,H.forceKeepAttr=void 0,tt(Q.uponSanitizeAttribute,p,H),Ae=H.attrValue,v&&(lr==="id"||lr==="name")&&(Dt(ve,p),Ae=k+Ae),Ot&&Se(/((--!?|])>)|<\/(style|title)/i,Ae)){Dt(ve,p);continue}if(H.forceKeepAttr)continue;if(!H.keepAttr){Dt(ve,p);continue}if(!Or&&Se(/\/>/i,Ae)){Dt(ve,p);continue}et&&qr([N,Y,q],En=>{Ae=yr(Ae,En," ")});const An=be(p.nodeName);if(!_n(An,lr,Ae)){Dt(ve,p);continue}if(R&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Re)switch(m.getAttributeType(An,lr)){case"TrustedHTML":{Ae=R.createHTML(Ae);break}case"TrustedScriptURL":{Ae=R.createScriptURL(Ae);break}}if(Ae!==os)try{Re?p.setAttributeNS(Re,ve,Ae):p.setAttribute(ve,Ae),as(p)?Ye(p):Ai(e.removed)}catch{Dt(ve,p)}}tt(Q.afterSanitizeAttributes,p,null)},Ba=function G(p){let O=null;const H=vn(p);for(tt(Q.beforeSanitizeShadowDOM,p,null);O=H.nextNode();)tt(Q.uponSanitizeShadowNode,O,null),wn(O),kn(O),O.content instanceof a&&G(O.content);tt(Q.afterSanitizeShadowDOM,p,null)};return e.sanitize=function(G){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},O=null,H=null,he=null,ke=null;if(Lt=!G,Lt&&(G="<!-->"),typeof G!="string"&&!bn(G))if(typeof G.toString=="function"){if(G=G.toString(),typeof G!="string")throw xr("dirty is not a string, aborting")}else throw xr("toString is not a function");if(!e.isSupported)return G;if(It||is(p),e.removed=[],typeof G=="string"&&(L=!1),L){if(G.nodeName){const rt=be(G.nodeName);if(!P[rt]||vt[rt])throw xr("root node is forbidden and cannot be sanitized in-place")}}else if(G instanceof l)O=xn("<!---->"),H=O.ownerDocument.importNode(G,!0),H.nodeType===br.element&&H.nodeName==="BODY"||H.nodeName==="HTML"?O=H:O.appendChild(H);else{if(!lt&&!et&&!Je&&G.indexOf("<")===-1)return R&&_t?R.createHTML(G):G;if(O=xn(G),!O)return lt?null:_t?I:""}O&&nr&&Ye(O.firstChild);const ve=vn(L?G:O);for(;he=ve.nextNode();)wn(he),kn(he),he.content instanceof a&&Ba(he.content);if(L)return G;if(lt){if(ir)for(ke=U.call(O.ownerDocument);O.firstChild;)ke.appendChild(O.firstChild);else ke=O;return(X.shadowroot||X.shadowrootmode)&&(ke=ce.call(s,ke,!0)),ke}let Re=Je?O.outerHTML:O.innerHTML;return Je&&P["!doctype"]&&O.ownerDocument&&O.ownerDocument.doctype&&O.ownerDocument.doctype.name&&Se(Ia,O.ownerDocument.doctype.name)&&(Re="<!DOCTYPE "+O.ownerDocument.doctype.name+`>
`+Re),et&&qr([N,Y,q],rt=>{Re=yr(Re,rt," ")}),R&&_t?R.createHTML(Re):Re},e.setConfig=function(){let G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};is(G),It=!0},e.clearConfig=function(){Pt=null,It=!1},e.isValidAttribute=function(G,p,O){Pt||is({});const H=be(G),he=be(p);return _n(H,he,O)},e.addHook=function(G,p){typeof p=="function"&&pr(Q[G],p)},e.removeHook=function(G,p){if(p!==void 0){const O=ou(Q[G],p);return O===-1?void 0:lu(Q[G],O,1)[0]}return Ai(Q[G])},e.removeHooks=function(G){Q[G]=[]},e.removeAllHooks=function(){Q=Ii()},e}var La=Ra();function Au(){const{user:r}=Ke(),e=Nt(),[t,s]=b.useState(null),[n,a]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(!1),[u,h]=b.useState(!1),[f,m]=b.useState(!1),x=b.useRef(null);b.useEffect(()=>{y()},[]);const y=async()=>{try{a(!0);const T=await rs.getActiveTerms();s(T)}catch(T){console.error("Error loading terms:",T),l("     ")}finally{a(!1)}},_=()=>{if(!x.current)return;const{scrollTop:T,scrollHeight:j,clientHeight:R}=x.current,I=j-T-R<50;d(I)},F=async()=>{if(!(!r||!t))try{m(!0),await rs.acceptTerms(r.id,t.version),e("/")}catch(T){console.error("Error accepting terms:",T),l("      ")}finally{m(!1)}};return n?i.jsx("div",{className:"flex justify-center items-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):o?i.jsx("div",{className:"flex justify-center items-center min-h-screen",children:i.jsxs("div",{className:"bg-red-50 border-r-4 border-red-500 text-red-700 px-6 py-4 rounded-lg flex items-center",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o]})}):t?i.jsx("div",{className:"max-w-4xl mx-auto p-4 pt-24",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-8 border border-gray-100",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:t.title}),i.jsx("p",{className:"text-gray-600",children:"        "})]}),i.jsx("div",{ref:x,onScroll:_,className:"prose max-w-none prose-headings:text-gray-900 prose-p:text-gray-900 prose-strong:text-gray-900 prose-ul:text-gray-900 prose-li:text-gray-900 prose-a:text-[#F4B744] prose-a:no-underline hover:prose-a:underline bg-gray-50 p-6 rounded-lg border border-gray-200 mb-8 max-h-[60vh] overflow-y-auto",style:{color:"#111827"},dangerouslySetInnerHTML:{__html:La.sanitize(t.content_html)}}),i.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-100",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("input",{type:"checkbox",id:"agree",checked:u,onChange:T=>h(T.target.checked),className:"w-5 h-5 text-[#F4B744] border-gray-300 rounded focus:ring-[#F4B744]"}),i.jsx("label",{htmlFor:"agree",className:"mr-3 text-gray-900 text-lg font-medium",children:"           "})]}),i.jsx("button",{onClick:F,disabled:!c||!u||f,className:`w-full py-4 px-6 rounded-lg text-white font-medium text-lg transition-all duration-200 transform hover:scale-105 ${!c||!u||f?"bg-gray-400 cursor-not-allowed":"bg-[#F4B744] hover:bg-[#E5A93D] shadow-lg hover:shadow-xl"}`,children:f?i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"  ..."]}):"  "}),!c&&i.jsxs("p",{className:"text-yellow-700 text-center mt-4 flex items-center justify-center font-medium",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"       "]})]})]})}):i.jsx("div",{className:"flex justify-center items-center min-h-screen",children:i.jsx("div",{className:"text-gray-500 text-center p-4",children:"     "})})}function Eu(){const{user:r}=Ke(),e=Nt(),[t,s]=b.useState([]),[n,a]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState(!1),[u,h]=b.useState({title:"",content_html:"",version:1});b.useEffect(()=>{if((r==null?void 0:r.email)!=="active.legendss@gmail.com"){e("/");return}f()},[r,e]);const f=async()=>{try{a(!0);const{data:y,error:_}=await ie.from("terms_and_conditions").select("*").order("version",{ascending:!1});if(_)throw _;s(y||[])}catch(y){console.error("Error loading terms:",y),l("     ")}finally{a(!1)}},m=async y=>{y.preventDefault();try{a(!0),await rs.createNewTerms({...u,is_active:!0}),d(!1),h({title:"",content_html:"",version:t.length>0?Math.max(...t.map(_=>_.version))+1:1}),await f()}catch(_){console.error("Error creating terms:",_),l("      ")}finally{a(!1)}},x=async y=>{try{a(!0),await rs.updateTerms(y,{is_active:!0}),await f()}catch(_){console.error("Error activating terms:",_),l("     ")}finally{a(!1)}};return n?i.jsx("div",{className:"flex justify-center items-center min-h-screen",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):i.jsxs("div",{className:"admin-page-container max-w-4xl mx-auto p-4 pt-24",children:[i.jsxs("div",{className:"flex justify-between items-center mb-8",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"   "}),i.jsx("p",{className:"text-gray-600",children:"      "})]}),i.jsx("button",{onClick:()=>d(!0),className:"bg-[#F4B744] hover:bg-[#E5A93D] text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-lg hover:shadow-xl",children:i.jsxs("span",{className:"flex items-center",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-2",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"  "]})})]}),o&&i.jsxs("div",{className:"bg-red-50 border-r-4 border-red-500 text-red-700 px-6 py-4 rounded-lg mb-6 flex items-center",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 ml-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o]}),c&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 mb-8 border border-gray-100",children:[i.jsx("h2",{className:"text-2xl font-semibold mb-6 text-gray-800",children:"  "}),i.jsxs("form",{onSubmit:m,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("input",{type:"text",id:"title",value:u.title,onChange:y=>h({...u,title:y.target.value}),required:!0,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#F4B744] focus:border-transparent transition-all duration-200",placeholder:"   "})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700 mb-2",children:""}),i.jsx("textarea",{id:"content",value:u.content_html,onChange:y=>h({...u,content_html:y.target.value}),required:!0,rows:12,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-[#F4B744] focus:border-transparent transition-all duration-200 bg-gray-50 text-gray-700 placeholder-gray-400",placeholder:"      ..."})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-6 py-3 text-gray-600 hover:text-gray-800 font-medium transition-colors duration-200",children:""}),i.jsx("button",{type:"submit",disabled:n,className:`px-6 py-3 rounded-lg text-white font-medium transition-all duration-200 transform hover:scale-105 ${n?"bg-gray-400 cursor-not-allowed":"bg-[#F4B744] hover:bg-[#E5A93D] shadow-lg hover:shadow-xl"}`,children:n?i.jsxs("span",{className:"flex items-center",children:[i.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"  ..."]}):"  "})]})]})]}),i.jsx("div",{className:"space-y-6",children:t.map(y=>i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100 transition-all duration-200 hover:shadow-xl",children:[i.jsxs("div",{className:"flex justify-between items-start mb-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:y.title}),i.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i.jsxs("span",{children:[" ",y.version]}),i.jsx("span",{className:"mx-2",children:""}),i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),i.jsx("span",{children:new Date(y.created_at).toLocaleDateString("fa-IR")})]})]}),!y.is_active&&i.jsxs("button",{onClick:()=>x(y.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 transform hover:scale-105 shadow-md hover:shadow-lg flex items-center",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),""]})]}),i.jsx("div",{className:"prose max-w-none prose-headings:text-gray-900 prose-p:text-gray-900 prose-strong:text-gray-900 prose-ul:text-gray-900 prose-li:text-gray-900 prose-a:text-[#F4B744] prose-a:no-underline hover:prose-a:underline bg-gray-50 p-6 rounded-lg border border-gray-200",style:{color:"#111827"},dangerouslySetInnerHTML:{__html:La.sanitize(y.content_html)}}),y.is_active&&i.jsx("div",{className:"mt-6 flex items-center",children:i.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),""]})})]},y.id))})]})}const Su=()=>i.jsx("footer",{className:"footer bg-black/60 backdrop-blur-sm border-t border-white/10 pointer-events-none",style:{minHeight:"0",height:"32px"},children:i.jsx("div",{className:"w-full flex justify-center items-center h-full",children:i.jsxs("p",{className:"text-[10px] text-center text-gray-300 leading-tight m-0 p-0 select-none",children:[" ",new Date().getFullYear(),"       ",i.jsx("span",{className:"font-bold text-white",children:"  "})," ."]})})}),_r={async getAll(){const{data:r,error:e}=await oe.from("download_links").select("*").order("created_at",{ascending:!1});if(e)throw e;return r||[]},async getById(r){const{data:e,error:t}=await oe.from("download_links").select("*").eq("id",r).single();return t?null:e},async add(r){const{data:e,error:t}=await oe.from("download_links").insert([r]).select().single();if(t)throw t;return e},async update(r,e){const{data:t,error:s}=await oe.from("download_links").update(e).eq("id",r).select().single();if(s)throw s;return t},async remove(r){const{error:e}=await oe.from("download_links").delete().eq("id",r);if(e)throw e}},Nu=i.jsxs("div",{className:"ad-container",children:[i.jsx("span",{className:"ad-label",children:""}),i.jsx("div",{id:"pos-article-display-108441",className:"w-full flex justify-center items-center"})]});function Tu(){const{id:r}=$i(),e=Nt(),[t,s]=b.useState(10),[n,a]=b.useState(!1),[o,l]=b.useState(!1),[c,d]=b.useState(!0),[u,h]=b.useState(null),[f,m]=b.useState(!1);b.useEffect(()=>{if(!r){a(!0),d(!1);return}d(!0),a(!1),h(null),_r.getById(r).then(y=>{y?h(y):a(!0),d(!1),setTimeout(()=>{m(!0)},500)})},[r]),b.useEffect(()=>{if(!u)return;s(10),l(!1);const y=setInterval(()=>{s(_=>(_<=1&&(clearInterval(y),l(!0)),_-1))},1e3);return()=>clearInterval(y)},[u]),b.useEffect(()=>{const y="yektanet-script";if(!document.getElementById(y)){const _=new Date,F=`https://cdn.yektanet.com/superscript/OYzquHID/native-activelegend.ir-43485/yn_pub.js?v=${_.getFullYear()}0${_.getMonth()}0${_.getDate()}0${_.getHours()}`,T=document.createElement("link");T.rel="preload",T.as="script",T.href=F,document.head.appendChild(T);const j=document.createElement("script");j.id=y,j.async=!0,j.src=F,document.head.appendChild(j)}},[]);const x=()=>{u!=null&&u.url&&(window.location.href=u.url)};return c?i.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-black px-4 transition-all duration-1000",children:i.jsx("div",{className:"bg-white/10 border border-primary/40 rounded-2xl p-8 max-w-md w-full text-center",children:i.jsx("div",{className:"text-lg text-primary font-bold mb-4",children:" ..."})})}):n?i.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white px-4",children:i.jsxs("div",{className:"bg-white border border-red-500/40 rounded-2xl p-8 max-w-md w-full text-center shadow-lg",children:[i.jsx("div",{className:"text-3xl text-red-400 font-bold mb-4",children:"  "}),i.jsx("div",{className:"text-gray-500 mb-6",children:"          ."}),i.jsx("button",{onClick:()=>e("/"),className:"btn-primary mt-2",children:"  "})]})}):i.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center px-4 py-12 transition-all duration-1000 ${f?"bg-white":"bg-black"}`,children:[i.jsxs("div",{className:`w-full transition-all duration-1000 ${f?"max-w-4xl bg-white border border-gray-200 rounded-2xl shadow-xl p-12":"max-w-md bg-white/10 border border-white/10 rounded-2xl p-8"} flex flex-col items-center`,children:[i.jsx("h1",{className:`text-2xl font-bold mb-2 text-center transition-all duration-1000 ${f?"text-gray-900":"text-white"} md:text-4xl`,children:" "}),(u==null?void 0:u.title)&&i.jsx("div",{className:"text-primary text-lg font-bold mb-4 text-center transition-all duration-1000 md:text-2xl text-primary",children:u.title}),f&&Nu,o?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"btn-primary w-full py-3 text-lg mt-2 md:py-4 md:text-xl",onClick:x,children:" "}),i.jsx("div",{className:`text-xs mt-4 transition-all duration-1000 md:text-sm ${f?"text-gray-500":"text-gray-400"}`,children:"           ."}),f&&i.jsxs("div",{className:"ad-container ad-container-bottom",children:[i.jsx("span",{className:"ad-label",children:""}),i.jsx("div",{id:"pos-article-display-108440",className:"w-full flex justify-center items-center"})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"text-lg font-bold mb-2 transition-all duration-1000 md:text-xl text-primary",children:["  ",i.jsx("span",{className:"text-2xl md:text-3xl",children:t}),"    ..."]}),i.jsx("div",{className:`w-full rounded-full h-3 mb-4 overflow-hidden transition-all duration-1000 ${f?"bg-gray-200":"bg-gray-800"}`,children:i.jsx("div",{className:"bg-primary h-3 rounded-full transition-all duration-500",style:{width:`${(10-t)/10*100}%`}})}),i.jsx("div",{className:`text-sm transition-all duration-1000 md:text-base ${f?"text-gray-500":"text-gray-400"}`,children:"     "})]})]}),f&&i.jsxs("div",{className:"ad-container ad-container-text",children:[i.jsx("span",{className:"ad-label",children:""}),i.jsx("div",{id:"pos-article-text-108405",className:"w-full flex justify-center items-center"})]})]})}function Cu(){const{user:r}=Ke(),e=Nt(),[t,s]=b.useState([]),[n,a]=b.useState(!0),[o,l]=b.useState(null),[c,d]=b.useState({}),[u,h]=b.useState(null),[f,m]=b.useState(!1);b.useEffect(()=>{if(!r||r.email!=="active.legendss@gmail.com"){e("/");return}x()},[r]);const x=async()=>{a(!0);try{const j=await _r.getAll();s(j)}catch(j){l(j.message||"   ")}finally{a(!1)}},y=j=>{d({...c,[j.target.name]:j.target.value})},_=async j=>{j.preventDefault(),m(!0);try{if(u)await _r.update(u,c);else{if(!c.id||!c.url)throw new Error("    ");await _r.add(c)}d({}),h(null),await x()}catch(R){l(R.message||"  ")}finally{m(!1)}},F=j=>{d(j),h(j.id)},T=async j=>{if(window.confirm("  ")){m(!0);try{await _r.remove(j),await x()}catch(R){l(R.message||"  ")}finally{m(!1)}}};return i.jsx("div",{className:"max-w-2xl mx-auto p-4 pt-24",children:i.jsxs("div",{className:"bg-white/10 rounded-2xl shadow-lg p-8 border border-white/10",children:[i.jsx("h1",{className:"text-2xl font-bold text-white mb-8 text-center",children:"  "}),i.jsxs("form",{onSubmit:_,className:"mb-8 grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx("input",{name:"id",type:"text",className:"bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white",placeholder:" ( game1)",value:c.id||"",onChange:y,required:!0,disabled:!!u}),i.jsx("input",{name:"url",type:"text",className:"bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white",placeholder:" ",value:c.url||"",onChange:y,required:!0}),i.jsx("input",{name:"title",type:"text",className:"bg-black/40 border border-white/10 rounded-lg px-3 py-2 text-white",placeholder:" ()",value:c.title||"",onChange:y}),i.jsx("button",{type:"submit",className:"btn-primary col-span-1 md:col-span-3 mt-2",disabled:f,children:u?" ":" "}),u&&i.jsx("button",{type:"button",className:"btn-secondary col-span-1 md:col-span-3 mt-2",onClick:()=>{d({}),h(null)},children:"  "})]}),o&&i.jsx("div",{className:"text-red-400 text-center mb-4",children:o}),n?i.jsx("div",{className:"text-center text-gray-400",children:"  ..."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full text-sm text-white",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-black/30",children:[i.jsx("th",{className:"p-2",children:""}),i.jsx("th",{className:"p-2",children:"  "}),i.jsx("th",{className:"p-2",children:"  /"}),i.jsx("th",{className:"p-2",children:""}),i.jsx("th",{className:"p-2",children:""})]})}),i.jsxs("tbody",{children:[t.map(j=>i.jsxs("tr",{className:"border-b border-white/10 hover:bg-white/5",children:[i.jsx("td",{className:"p-2 font-mono",children:j.id}),i.jsxs("td",{className:"p-2 truncate max-w-[120px]",children:[i.jsx("a",{href:j.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline break-all",children:j.url}),i.jsx("button",{className:"ml-2 text-xs text-gray-400 hover:text-primary",onClick:()=>navigator.clipboard.writeText(j.url),title:"  ",children:""})]}),i.jsxs("td",{className:"p-2 truncate max-w-[120px]",children:[i.jsx("a",{href:`${window.location.origin}/#/download/${j.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary underline break-all",children:`${window.location.origin}/#/download/${j.id}`}),i.jsx("button",{className:"ml-2 text-xs text-gray-400 hover:text-primary",onClick:()=>navigator.clipboard.writeText(`${window.location.origin}/#/download/${j.id}`),title:"   ",children:""})]}),i.jsx("td",{className:"p-2",children:j.title||"-"}),i.jsxs("td",{className:"p-2 flex gap-2",children:[i.jsx("button",{className:"btn-secondary px-2 py-1 text-xs",onClick:()=>F(j),disabled:f,children:""}),i.jsx("button",{className:"btn-secondary px-2 py-1 text-xs text-red-400 border-red-400",onClick:()=>T(j.id),disabled:f,children:""})]})]},j.id)),t.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center text-gray-400 py-4",children:"   ."})})]})]})})]})})}/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Iu=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),Ri=r=>{const e=Iu(r);return e.charAt(0).toUpperCase()+e.slice(1)},Pa=(...r)=>r.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim(),Ru=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lu={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=b.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:n="",children:a,iconNode:o,...l},c)=>b.createElement("svg",{ref:c,...Lu,width:e,height:e,stroke:r,strokeWidth:s?Number(t)*24/Number(e):t,className:Pa("lucide",n),...!a&&!Ru(l)&&{"aria-hidden":"true"},...l},[...o.map(([d,u])=>b.createElement(d,u)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=(r,e)=>{const t=b.forwardRef(({className:s,...n},a)=>b.createElement(Pu,{ref:a,iconNode:e,className:Pa(`lucide-${Ou(Ri(r))}`,`lucide-${r}`,s),...n}));return t.displayName=Ri(r),t};/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],Mu=xt("gamepad",Du);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $u=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Li=xt("plus",$u);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Uu=xt("rocket",Fu);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],zu=xt("square-pen",Bu);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Pi=xt("trash-2",qu);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Hu=xt("user-plus",Vu);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Gu=xt("users",Wu);/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ju=xt("x",Ku),Yu=[{icon:i.jsx(Mu,{className:"w-10 h-10 text-blue-500 mb-4"}),title:" ",desc:"              .               ."},{icon:i.jsx(Gu,{className:"w-10 h-10 text-green-500 mb-4"}),title:" ",desc:"                     .          ."},{icon:i.jsx(Uu,{className:"w-10 h-10 text-pink-500 mb-4"}),title:"",desc:"              .               ."}],Xu={hidden:{opacity:0,y:40},visible:r=>({opacity:1,y:0,transition:{delay:.2+r*.15,duration:.7,type:"spring",stiffness:80}})};function Qu(){const[r,e]=b.useState([]);return b.useEffect(()=>{oe.from("team_members").select("*").order("created_at",{ascending:!0}).then(({data:t})=>e(t||[]))},[]),i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex flex-col items-center justify-center px-4 py-16 pt-24 pb-32",children:[i.jsxs(Na,{children:[i.jsx("title",{children:"   | Active Legend -     "}),i.jsx("meta",{name:"description",content:"   (Active Legend)         .           ."}),i.jsx("meta",{name:"keywords",content:" , Active Legend, , ,  ,  , Game Studio, Game Development, ,  ,  ,  ,  ,  ,   , about active legend"}),i.jsx("meta",{property:"og:title",content:"   | Active Legend"}),i.jsx("meta",{property:"og:description",content:"     (Active Legend)     ."}),i.jsx("meta",{property:"og:type",content:"website"}),i.jsx("meta",{property:"og:url",content:"https://activelegend.ir/about"}),i.jsx("meta",{property:"og:image",content:"https://activelegend.ir/AE%20logo.svg"}),i.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),i.jsx("meta",{name:"twitter:title",content:"   | Active Legend"}),i.jsx("meta",{name:"twitter:description",content:"    (Active Legend)      ."}),i.jsx("meta",{name:"twitter:image",content:"https://activelegend.ir/AE%20logo.svg"})]}),i.jsx(z.h1,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.8,type:"spring"},className:"text-4xl md:text-5xl font-extrabold text-white text-center mb-8 md:mb-12 drop-shadow-lg",children:"  "}),i.jsx(z.p,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"text-lg md:text-xl text-gray-300 text-center max-w-2xl mb-12",children:"              .                   .                         ."}),i.jsx("div",{className:"w-full max-w-5xl grid grid-cols-1 md:grid-cols-3 gap-8 mb-16",children:Yu.map((t,s)=>i.jsxs(z.div,{custom:s,initial:"hidden",whileInView:"visible",viewport:{once:!0,amount:.3},variants:Xu,className:"bg-white/10 backdrop-blur-md rounded-3xl shadow-xl p-8 flex flex-col items-center text-center border border-white/10 hover:scale-105 hover:shadow-2xl transition-transform duration-300",children:[t.icon,i.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:t.title}),i.jsx("p",{className:"text-gray-200 text-base leading-relaxed",children:t.desc})]},t.title))}),r.length>0?i.jsxs(z.div,{initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.8,delay:.3},className:"w-full max-w-5xl mx-auto mt-8 mb-20",children:[i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white text-center mb-8",children:" "}),i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-8",children:r.map((t,s)=>i.jsxs(z.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.7,delay:.1*s},className:"bg-white/10 rounded-2xl shadow-lg p-6 flex flex-col items-center text-center border border-white/10 hover:scale-105 hover:shadow-2xl transition-transform duration-300",children:[i.jsx("img",{src:t.img_url,alt:t.name,className:"w-24 h-24 rounded-full object-cover mb-4 border-4 border-white/20 shadow-md"}),i.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:t.name}),i.jsx("span",{className:"text-sm text-gray-300 mb-2",children:t.role}),i.jsx("div",{className:"flex gap-3 justify-center mt-2",children:(t.socials||[]).map((n,a)=>i.jsx("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-gray-300 hover:text-blue-400 transition-colors",children:n.img?i.jsx("img",{src:n.img,alt:n.icon,className:"w-6 h-6 rounded-full object-cover"}):n.icon==="github"?i.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.987 1.029-2.686-.103-.254-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.396.1 2.65.64.699 1.028 1.593 1.028 2.686 0 3.847-2.337 4.695-4.566 4.944.359.309.678.919.678 1.852 0 1.336-.012 2.417-.012 2.747 0 .267.18.577.688.48C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"})}):n.icon==="linkedin"?i.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-10h3v10zm-1.5-11.268c-.966 0-1.75-.784-1.75-1.75s.784-1.75 1.75-1.75 1.75.784 1.75 1.75-.784 1.75-1.75 1.75zm13.5 11.268h-3v-5.604c0-1.337-.025-3.063-1.868-3.063-1.868 0-2.154 1.459-2.154 2.968v5.699h-3v-10h2.881v1.367h.041c.401-.761 1.381-1.563 2.841-1.563 3.039 0 3.6 2.001 3.6 4.599v5.597zm0 0"})}):n.icon==="instagram"?i.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M7.75 2h8.5A5.75 5.75 0 0122 7.75v8.5A5.75 5.75 0 0116.25 22h-8.5A5.75 5.75 0 012 16.25v-8.5A5.75 5.75 0 017.75 2zm0 1.5A4.25 4.25 0 003.5 7.75v8.5A4.25 4.25 0 007.75 20.5h8.5a4.25 4.25 0 004.25-4.25v-8.5A4.25 4.25 0 0016.25 3.5h-8.5zm4.25 3.25a5.25 5.25 0 110 10.5 5.25 5.25 0 010-10.5zm0 1.5a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5zm6.25 1.25a1 1 0 110 2 1 1 0 010-2z"})}):n.icon==="youtube"?i.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M23.498 6.186a2.994 2.994 0 00-2.107-2.117C19.403 3.5 12 3.5 12 3.5s-7.403 0-9.391.569A2.994 2.994 0 00.502 6.186C0 8.174 0 12 0 12s0 3.826.502 5.814a2.994 2.994 0 002.107 2.117C4.597 20.5 12 20.5 12 20.5s7.403 0 9.391-.569a2.994 2.994 0 002.107-2.117C24 15.826 24 12 24 12s0-3.826-.502-5.814zM9.75 15.568V8.432L15.818 12 9.75 15.568z"})}):null},n.icon+a))})]},t.id))})]}):i.jsx("div",{className:"text-center text-gray-400 mt-8 mb-20",children:"    ."}),i.jsxs(z.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.7,delay:.2},className:"flex flex-col items-center gap-4",children:[i.jsx("span",{className:"text-lg md:text-xl text-white font-medium",children:"       "}),i.jsx("a",{href:"https://activelegend.ir/contact",className:"inline-block px-8 py-3 rounded-xl bg-gradient-to-r from-blue-600 to-pink-500 text-white font-bold text-lg shadow-lg hover:scale-105 hover:shadow-2xl transition-all duration-300",children:"   "})]})]})}const Di="active.legendss@gmail.com",Ds={name:"",role:"",img_url:"",socials:[]};function Zu(){const{user:r}=Ke(),[e,t]=b.useState([]),[s,n]=b.useState(!0),[a,o]=b.useState(!1),[l,c]=b.useState(null),[d,u]=b.useState(Ds),[h,f]=b.useState(null);b.useEffect(()=>{(r==null?void 0:r.email)===Di&&m()},[r]);async function m(){n(!0);const{data:w,error:E}=await oe.from("team_members").select("*").order("created_at",{ascending:!0});E&&f("   "),t(w||[]),n(!1)}function x(){u(Ds),c(null),o(!0)}function y(w){u({...w,socials:w.socials||[]}),c(w.id),o(!0)}function _(){o(!1),c(null),u(Ds),f(null)}function F(w,E,U){u(J=>({...J,socials:J.socials.map((ce,Q)=>Q===w?{...ce,[E]:U}:ce)}))}function T(){u(w=>({...w,socials:[...w.socials,{icon:"",url:"",img:""}]}))}function j(w){u(E=>({...E,socials:E.socials.filter((U,J)=>J!==w)}))}async function R(w){w.preventDefault(),f(null);const E=d.socials.map(U=>({icon:U.icon,url:U.url,...U.img&&U.img.length>0?{img:U.img}:{}}));if(!d.name.trim()||!d.role.trim()){f("    ");return}if(l){const{error:U}=await oe.from("team_members").update({...d,socials:E}).eq("id",l);U&&f("   ")}else{const{error:U}=await oe.from("team_members").insert([{...d,socials:E}]);U&&f("   ")}_(),m()}async function I(w){window.confirm("      ")&&(await oe.from("team_members").delete().eq("id",w),m())}return!r||r.email!==Di?i.jsx("div",{className:"min-h-screen flex items-center justify-center text-xl text-gray-400",children:"     ."}):i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 px-4 py-12 pt-24",children:[i.jsxs("div",{className:"max-w-3xl mx-auto",children:[i.jsxs("div",{className:"flex items-center justify-between mb-8",children:[i.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-white flex items-center gap-2",children:[i.jsx(Hu,{className:"w-7 h-7 text-blue-400"}),"   "]}),i.jsxs("button",{onClick:x,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-500 text-white px-5 py-2 rounded-xl font-bold shadow transition-all",children:[i.jsx(Li,{className:"w-5 h-5"}),"  "]})]}),s?i.jsx("div",{className:"text-center text-gray-400",children:"  ..."}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.map(w=>i.jsxs(z.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white/10 rounded-2xl shadow-lg p-6 flex flex-col items-center text-center border border-white/10 relative",children:[i.jsx("img",{src:w.img_url,alt:w.name,className:"w-20 h-20 rounded-full object-cover mb-3 border-4 border-white/20 shadow"}),i.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:w.name}),i.jsx("span",{className:"text-sm text-gray-300 mb-2",children:w.role}),i.jsx("div",{className:"flex gap-3 justify-center mt-2 mb-4",children:(w.socials||[]).map((E,U)=>i.jsxs("a",{href:E.url,target:"_blank",rel:"noopener noreferrer",className:"text-gray-300 hover:text-blue-400 transition-colors",children:[E.icon==="github"&&i.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.987 1.029-2.686-.103-.254-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.396.1 2.65.64.699 1.028 1.593 1.028 2.686 0 3.847-2.337 4.695-4.566 4.944.359.309.678.919.678 1.852 0 1.336-.012 2.417-.012 2.747 0 .267.18.577.688.48C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"})}),E.icon==="linkedin"&&i.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-10h3v10zm-1.5-11.268c-.966 0-1.75-.784-1.75-1.75s.784-1.75 1.75-1.75 1.75.784 1.75 1.75-.784 1.75-1.75 1.75zm13.5 11.268h-3v-5.604c0-1.337-.025-3.063-1.868-3.063-1.868 0-2.154 1.459-2.154 2.968v5.699h-3v-10h2.881v1.367h.041c.401-.761 1.381-1.563 2.841-1.563 3.039 0 3.6 2.001 3.6 4.599v5.597zm0 0"})}),E.icon==="instagram"&&i.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{d:"M7.75 2h8.5A5.75 5.75 0 0122 7.75v8.5A5.75 5.75 0 0116.25 22h-8.5A5.75 5.75 0 012 16.25v-8.5A5.75 5.75 0 017.75 2zm0 1.5A4.25 4.25 0 003.5 7.75v8.5A4.25 4.25 0 007.75 20.5h8.5a4.25 4.25 0 004.25-4.25v-8.5A4.25 4.25 0 0016.25 3.5h-8.5zm4.25 3.25a5.25 5.25 0 110 10.5 5.25 5.25 0 010-10.5zm0 1.5a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5zm6.25 1.25a1 1 0 110 2 1 1 0 010-2z"})})]},E.icon+U))}),i.jsxs("div",{className:"absolute top-3 left-3 flex gap-2",children:[i.jsx("button",{onClick:()=>y(w),className:"p-2 rounded-full bg-blue-500/20 hover:bg-blue-500/40 text-blue-400",children:i.jsx(zu,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>I(w.id),className:"p-2 rounded-full bg-red-500/20 hover:bg-red-500/40 text-red-400",children:i.jsx(Pi,{className:"w-4 h-4"})})]})]},w.id))})]}),i.jsx(tr,{children:a&&i.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",onClick:_,children:i.jsxs(z.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-gray-900 rounded-2xl shadow-2xl w-full max-w-md p-8 relative",onClick:w=>w.stopPropagation(),children:[i.jsx("button",{onClick:_,className:"absolute top-3 left-3 text-gray-400 hover:text-red-400",children:i.jsx(Ju,{className:"w-6 h-6"})}),i.jsx("h2",{className:"text-xl font-bold text-white mb-6 flex items-center gap-2",children:l?" ":"  "}),i.jsxs("form",{onSubmit:R,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-1 text-right",children:""}),i.jsx("input",{type:"text",value:d.name,onChange:w=>u(E=>({...E,name:w.target.value})),className:"w-full px-4 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-1 text-right",children:""}),i.jsx("input",{type:"text",value:d.role,onChange:w=>u(E=>({...E,role:w.target.value})),className:"w-full px-4 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-1 text-right",children:"  (URL)"}),i.jsx("input",{type:"text",value:d.img_url,onChange:w=>u(E=>({...E,img_url:w.target.value})),className:"w-full px-4 py-2 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-gray-300 mb-1 text-right",children:" "}),d.socials.map((w,E)=>i.jsxs("div",{className:"flex gap-2 mb-2 items-center",children:[i.jsx("input",{type:"text",value:w.icon,onChange:U=>F(E,"icon",U.target.value),placeholder:" (github/linkedin/instagram  custom)",className:"flex-1 px-3 py-2 rounded bg-gray-800 border border-gray-700 text-white text-xs"}),i.jsx("input",{type:"text",value:w.url,onChange:U=>F(E,"url",U.target.value),placeholder:"",className:"flex-1 px-3 py-2 rounded bg-gray-800 border border-gray-700 text-white text-xs"}),i.jsx("input",{type:"text",value:w.img||"",onChange:U=>F(E,"img",U.target.value),placeholder:"   ()",className:"flex-1 px-3 py-2 rounded bg-gray-800 border border-gray-700 text-white text-xs"}),w.img&&i.jsx("img",{src:w.img,alt:"icon",className:"w-6 h-6 rounded-full object-cover"}),i.jsx("button",{type:"button",onClick:()=>j(E),className:"text-red-400 hover:text-red-600",children:i.jsx(Pi,{className:"w-4 h-4"})})]},E)),i.jsxs("button",{type:"button",onClick:T,className:"mt-2 text-blue-400 hover:text-blue-600 flex items-center gap-1",children:[i.jsx(Li,{className:"w-4 h-4"}),"  "]})]}),h&&i.jsx("div",{className:"text-red-400 text-sm text-right",children:h}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-colors",children:l?" ":" "})]})]})})})]})}const eh=({x:r,y:e,color:t,name:s,isMe:n})=>i.jsxs("div",{className:"absolute flex flex-col items-center",style:{left:r,top:e},children:[i.jsx("div",{className:`w-10 h-10 rounded-full shadow-lg border-2 flex items-center justify-center transition-all duration-200 ${n?"border-yellow-400 scale-110":"border-white/30"}`,style:{background:t}}),i.jsx("span",{className:"mt-1 text-xs font-bold text-white drop-shadow-sm bg-black/40 px-2 py-0.5 rounded-lg",children:s})]}),th=[{key:"offline",label:""}];function rh(){const r=["#3b82f6","#f59e42","#10b981","#e11d48","#a21caf","#fbbf24"];return r[Math.floor(Math.random()*r.length)]}function sh(){const r=["","","","","","","",""];return r[Math.floor(Math.random()*r.length)]}const Ms=900,$s=500,Mi=48,Hr=14;function nh(){const[r,e]=b.useState({name:sh(),color:rh(),x:Ms/2,y:$s/2}),[t,s]=b.useState(0),[n,a]=b.useState(()=>Number(localStorage.getItem("best_distance")||0)),o=b.useRef({x:r.x,y:r.y}),l=b.useRef({}),c=b.useRef(),d=b.useRef(null);return b.useEffect(()=>{var u;(u=d.current)==null||u.focus()},[]),b.useEffect(()=>{const u=f=>{const m=f.key.toLowerCase();["arrowup","w"].includes(m)&&(l.current.up=!0,["w"].includes(m)&&f.preventDefault()),["arrowdown","s"].includes(m)&&(l.current.down=!0,["s"].includes(m)&&f.preventDefault()),["arrowleft","a"].includes(m)&&(l.current.left=!0,["a"].includes(m)&&f.preventDefault()),["arrowright","d"].includes(m)&&(l.current.right=!0,["d"].includes(m)&&f.preventDefault())},h=f=>{const m=f.key.toLowerCase();["arrowup","w"].includes(m)&&(l.current.up=!1),["arrowdown","s"].includes(m)&&(l.current.down=!1),["arrowleft","a"].includes(m)&&(l.current.left=!1),["arrowright","d"].includes(m)&&(l.current.right=!1)};return window.addEventListener("keydown",u,{passive:!1}),window.addEventListener("keyup",h),()=>{window.removeEventListener("keydown",u),window.removeEventListener("keyup",h)}},[]),b.useEffect(()=>{function u(){let h=0,f=0;l.current.up&&(f-=Hr),l.current.down&&(f+=Hr),l.current.left&&(h-=Hr),l.current.right&&(h+=Hr),(h!==0||f!==0)&&e(m=>{let x=Math.max(0,Math.min(Ms-Mi,m.x+h)),y=Math.max(0,Math.min($s-Mi,m.y+f));return{...m,x,y}}),c.current=requestAnimationFrame(u)}return c.current=requestAnimationFrame(u),()=>{c.current&&cancelAnimationFrame(c.current)}},[]),b.useEffect(()=>{const u=r.x-o.current.x,h=r.y-o.current.y,f=Math.sqrt(u*u+h*h);f>0&&(s(m=>{const x=m+f;return x>n&&(a(x),localStorage.setItem("best_distance",String(Math.floor(x)))),x}),o.current={x:r.x,y:r.y})},[r.x,r.y,n]),i.jsx("div",{className:"w-full flex justify-center mt-8",children:i.jsxs("div",{ref:d,tabIndex:0,className:"relative bg-gradient-to-br from-blue-900/40 to-gray-800/60 rounded-2xl border border-white/10 overflow-hidden shadow-lg outline-none",style:{width:"90vw",maxWidth:Ms,height:"50vh",maxHeight:$s,minWidth:320,minHeight:200},children:[i.jsxs("div",{className:"absolute left-0 top-0 w-full flex items-center justify-between px-4 py-2 z-10 bg-black/30 text-blue-100 text-sm shadow border-b border-blue-400/30",children:[i.jsx("span",{className:"font-bold text-green-400",children:" "}),i.jsxs("span",{children:[" : ",Math.floor(t)," px"]}),i.jsxs("span",{children:[": ",Math.floor(n)," px"]})]}),i.jsx(eh,{x:r.x,y:r.y,color:r.color,name:r.name,isMe:!0})]})})}function ih(){const[r,e]=b.useState(null);return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex flex-col items-center justify-center px-4 py-8",children:[i.jsx(z.header,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:.7,type:"spring"},className:"w-full max-w-2xl flex flex-col items-center mb-12",children:i.jsx("div",{className:"flex flex-col items-center gap-2 w-full",children:i.jsxs("div",{className:"backdrop-blur-xl bg-white/10 border border-white/20 rounded-2xl shadow-2xl px-8 py-6 flex flex-col items-center w-full",children:[i.jsx("span",{className:"text-3xl md:text-4xl font-extrabold text-white tracking-tight drop-shadow mb-2 animate-pulse",children:"ActiveLegend Game"}),i.jsx("span",{className:"text-base text-blue-200/80 font-medium mb-4",children:"    "}),i.jsx("div",{className:"flex gap-4 mt-2",children:th.map(t=>i.jsx(z.button,{onClick:()=>e(t.key),whileHover:{scale:1.08,boxShadow:"0 4px 24px #3b82f6aa"},whileTap:{scale:.97},className:`px-6 py-2 rounded-xl font-bold text-base transition-all duration-200 focus:outline-none shadow-md border-2 ${r===t.key?"bg-blue-600/90 text-white border-blue-400 shadow-blue-400/40":"bg-white/10 text-blue-100 border-white/20 hover:bg-blue-500/80 hover:text-white"}`,children:t.label},t.key))})]})})}),i.jsxs(z.main,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},className:"w-full max-w-2xl flex flex-col items-center",children:[!r&&i.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-center text-gray-300 text-lg mt-12",children:"     ."}),r==="offline"&&i.jsx(nh,{})]})]})}function ah(){const[r,e]=b.useState(!1);return b.useEffect(()=>{const t=()=>{const s=window.scrollY||window.pageYOffset,n=window.innerHeight,a=document.body.scrollHeight;e(s+n>=a-10)};return window.addEventListener("scroll",t,{passive:!0}),t(),()=>{window.removeEventListener("scroll",t)}},[]),i.jsx(Sa,{children:i.jsx(Xa,{children:i.jsx(ac,{children:i.jsxs("div",{className:"min-h-screen relative scroll-container",children:[i.jsx(Ic,{}),i.jsxs("div",{className:"relative z-20",children:[i.jsx(Sc,{}),i.jsxs(Qa,{children:[i.jsx(Me,{path:"/",element:i.jsxs(i.Fragment,{children:[i.jsx(Tc,{}),i.jsx(Gc,{})]})}),i.jsx(Me,{path:"/games",element:i.jsx(Kd,{})}),i.jsx(Me,{path:"/games/:slug",element:i.jsx(eu,{})}),i.jsx(Me,{path:"/my-games",element:i.jsx(ru,{})}),i.jsx(Me,{path:"/terms",element:i.jsx(Au,{})}),i.jsx(Me,{path:"/admin/terms",element:i.jsx(Eu,{})}),i.jsx(Me,{path:"/admin/download-links",element:i.jsx(Cu,{})}),i.jsx(Me,{path:"/download/:id",element:i.jsx(Tu,{})}),i.jsx(Me,{path:"/contact",element:i.jsx(Gd,{})}),i.jsx(Me,{path:"/about",element:i.jsx(Qu,{})}),i.jsx(Me,{path:"/game",element:i.jsx(ih,{})}),i.jsx(Me,{path:"/team-admin",element:i.jsx(Zu,{})}),i.jsx(Me,{path:"*",element:i.jsx(tu,{})})]})]}),r&&i.jsx("div",{className:"fixed bottom-0 left-0 w-full z-50",children:i.jsx(Su,{})})]})})})})}eo.createRoot(document.getElementById("root")).render(i.jsx(b.StrictMode,{children:i.jsx(ah,{})}));
//# sourceMappingURL=main-Bj258cI_.js.map
